!function(){function t(o,a){return(a||"")+" (SystemJS Error#"+o+" https://github.com/systemjs/systemjs/blob/main/docs/errors.md#"+o+")"}function r(o,a){if(-1!==o.indexOf("\\")&&(o=o.replace(D,"/")),"/"===o[0]&&"/"===o[1])return a.slice(0,a.indexOf(":")+1)+o;if("."===o[0]&&("/"===o[1]||"."===o[1]&&("/"===o[2]||2===o.length&&(o+="/"))||1===o.length&&(o+="/"))||"/"===o[0]){var p,m=a.slice(0,a.indexOf(":")+1);if(p="/"===a[m.length+1]?"file:"!==m?(p=a.slice(m.length+2)).slice(p.indexOf("/")+1):a.slice(8):a.slice(m.length+("/"===a[m.length])),"/"===o[0])return a.slice(0,a.length-p.length-1)+o;for(var S=p.slice(0,p.lastIndexOf("/")+1)+o,T=[],$=-1,F=0;F<S.length;F++)-1!==$?"/"===S[F]&&(T.push(S.slice($,F+1)),$=-1):"."===S[F]?"."!==S[F+1]||"/"!==S[F+2]&&F+2!==S.length?"/"===S[F+1]||F+1===S.length?F+=1:$=F:(T.pop(),F+=2):$=F;return-1!==$&&T.push(S.slice($)),a.slice(0,a.length-p.length)+T.join("")}}function n(o,a){return r(o,a)||(-1!==o.indexOf(":")?o:r("./"+o,a))}function i(o,a,p,m,S){for(var T in o){var $=r(T,p)||T,F=o[T];if("string"==typeof F){var Z=g(m,r(F,p)||F,S);Z?a[$]=Z:f("W1",T,F,"bare specifier did not resolve")}}}function c(o,a,p){var m;for(m in o.imports&&i(o.imports,p.imports,a,p,null),o.scopes||{}){var S=n(m,a);i(o.scopes[m],p.scopes[S]||(p.scopes[S]={}),a,p,S)}for(m in o.depcache||{})p.depcache[n(m,a)]=o.depcache[m];for(m in o.integrity||{})p.integrity[n(m,a)]=o.integrity[m]}function s(o,a){if(a[o])return o;var p=o.length;do{var m=o.slice(0,p+1);if(m in a)return m}while(-1!==(p=o.lastIndexOf("/",p-1)))}function l(o,a){var p=s(o,a);if(p){var m=a[p];if(null===m)return;if(!(o.length>p.length&&"/"!==m[m.length-1]))return m+o.slice(p.length);f("W2",p,m,"should have a trailing '/'")}}function f(o,a,p,m){console.warn(t(o,"Package target "+m+", resolving target '"+p+"' for "+a))}function g(o,a,p){for(var m=o.scopes,S=p&&s(p,m);S;){var T=l(a,m[S]);if(T)return T;S=s(S.slice(0,S.lastIndexOf("/")),m)}return l(a,o.imports)||-1!==a.indexOf(":")&&a}function v(){this[O]={}}function N(o){return o.id}function E(o,a,p,m){if(o.onload(p,a.id,a.d&&a.d.map(N),!!m),p)throw p}function A(o,a,p){var m=o[O][a];if(m)return m;var S=[],T=Object.create(null);I&&Object.defineProperty(T,I,{value:"Module"});var $=Promise.resolve().then(function(){return o.instantiate(a,p)}).then(function(Z){if(!Z)throw Error(t(2,"Module "+a+" did not instantiate"));var he=Z[1](function(k,ie){m.h=!0;var L=!1;if("string"==typeof k)k in T&&T[k]===ie||(T[k]=ie,L=!0);else{for(var _ in k)ie=k[_],_ in T&&T[_]===ie||(T[_]=ie,L=!0);k&&k.__esModule&&(T.__esModule=k.__esModule)}if(L)for(var G=0;G<S.length;G++){var P=S[G];P&&P(T)}return ie},2===Z[1].length?{import:function(k){return o.import(k,a)},meta:o.createContext(a)}:void 0);return m.e=he.execute||function(){},[Z[0],he.setters||[]]},function(Z){throw m.e=null,m.er=Z,E(o,m,Z,!0),Z}),F=$.then(function(Z){return Promise.all(Z[0].map(function(he,k){var ie=Z[1][k];return Promise.resolve(o.resolve(he,a)).then(function(L){var _=A(o,L,a);return Promise.resolve(_.I).then(function(){return ie&&(_.i.push(ie),!_.h&&_.I||ie(_.n)),_})})})).then(function(he){m.d=he})});return m=o[O][a]={id:a,i:S,n:T,I:$,L:F,h:!1,d:void 0,e:void 0,er:void 0,E:void 0,C:void 0,p:void 0}}function B(o,a,p,m){if(!m[a.id])return m[a.id]=!0,Promise.resolve(a.L).then(function(){return a.p&&null!==a.p.e||(a.p=p),Promise.all(a.d.map(function(S){return B(o,S,p,m)}))}).catch(function(S){throw a.er||(a.e=null,E(o,a,S,!1)),S})}function x(o,a){return a.C=B(o,a,a,{}).then(function(){return W(o,a,{})}).then(function(){return a.n})}function W(o,a,p){function m(){try{var $=T.call(R);if($)return $=$.then(function(){a.C=a.n,a.E=null,E(o,a,null,!0)},function(F){throw a.er=F,a.E=null,E(o,a,F,!0),F}),a.E=$;a.C=a.n,a.L=a.I=void 0}catch(F){throw a.er=F,F}finally{E(o,a,a.er,!0)}}if(!p[a.id]){if(p[a.id]=!0,!a.e){if(a.er)throw a.er;return a.E?a.E:void 0}var S,T=a.e;return a.e=null,a.d.forEach(function($){try{var F=W(o,$,p);F&&(S=S||[]).push(F)}catch(Z){throw a.er=Z,E(o,a,Z,!1),Z}}),S?Promise.all(S).then(m):m()}}function J(){[].forEach.call(document.querySelectorAll("script"),function(o){if(!o.sp)if("systemjs-module"===o.type){if(o.sp=!0,!o.src)return;System.import("import:"===o.src.slice(0,7)?o.src.slice(7):n(o.src,X)).catch(function(p){if(p.message.indexOf("https://github.com/systemjs/systemjs/blob/main/docs/errors.md#3")>-1){var m=document.createEvent("Event");m.initEvent("error",!1,!1),o.dispatchEvent(m)}return Promise.reject(p)})}else if("systemjs-importmap"===o.type){o.sp=!0;var a=o.src?(System.fetch||fetch)(o.src,{integrity:o.integrity,passThrough:!0}).then(function(p){if(!p.ok)throw Error("Invalid status code: "+p.status);return p.text()}).catch(function(p){return p.message=t("W4","Error fetching systemjs-import map "+o.src)+"\n"+p.message,console.warn(p),"function"==typeof o.onerror&&o.onerror(),"{}"}):o.innerHTML;K=K.then(function(){return a}).then(function(p){!function(m,S,T){var $={};try{$=JSON.parse(S)}catch{console.warn(Error(t("W5","systemjs-importmap contains invalid JSON")+"\n\n"+S+"\n"))}c($,T,m)}(re,p,o.src||X)})}})}var X,z=typeof Symbol<"u",te=typeof self<"u",j=typeof document<"u",Y=te?self:global;if(j){var h=document.querySelector("base[href]");h&&(X=h.href)}if(!X&&typeof location<"u"){var u=(X=location.href.split("#")[0].split("?")[0]).lastIndexOf("/");-1!==u&&(X=X.slice(0,u+1))}var C,D=/\\/g,I=z&&Symbol.toStringTag,O=z?Symbol():"@",d=v.prototype;d.import=function(o,a){var p=this;return Promise.resolve(p.prepareImport()).then(function(){return p.resolve(o,a)}).then(function(m){var S=A(p,m);return S.C||x(p,S)})},d.createContext=function(o){var a=this;return{url:o,resolve:function(p,m){return Promise.resolve(a.resolve(p,m||o))}}},d.onload=function(){},d.register=function(o,a){C=[o,a]},d.getRegister=function(){var o=C;return C=void 0,o};var R=Object.freeze(Object.create(null));Y.System=new v;var y,M,K=Promise.resolve(),re={imports:{},scopes:{},depcache:{},integrity:{}},q=j;if(d.prepareImport=function(o){return(q||o)&&(J(),q=!1),K},j&&(J(),window.addEventListener("DOMContentLoaded",J)),d.addImportMap=function(o,a){c(o,a||X,re)},j){window.addEventListener("error",function(o){U=o.filename,se=o.error});var Q=location.origin}d.createScript=function(o){var a=document.createElement("script");a.async=!0,o.indexOf(Q+"/")&&(a.crossOrigin="anonymous");var p=re.integrity[o];return p&&(a.integrity=p),a.src=o,a};var U,se,ae={},V=d.register;d.register=function(o,a){if(j&&"loading"===document.readyState&&"string"!=typeof o){var p=document.querySelectorAll("script[src]"),m=p[p.length-1];if(m){y=o;var S=this;M=setTimeout(function(){ae[m.src]=[o,a],S.import(m.src)})}}else y=void 0;return V.call(this,o,a)},d.instantiate=function(o,a){var p=ae[o];if(p)return delete ae[o],p;var m=this;return Promise.resolve(d.createScript(o)).then(function(S){return new Promise(function(T,$){S.addEventListener("error",function(){$(Error(t(3,"Error loading "+o+(a?" from "+a:""))))}),S.addEventListener("load",function(){if(document.head.removeChild(S),U===o)$(se);else{var F=m.getRegister(o);F&&F[0]===y&&clearTimeout(M),T(F)}}),document.head.appendChild(S)})})},d.shouldFetch=function(){return!1},typeof fetch<"u"&&(d.fetch=fetch);var w=d.instantiate,b=/^(text|application)\/(x-)?javascript(;|$)/;d.instantiate=function(o,a){var p=this;return this.shouldFetch(o)?this.fetch(o,{credentials:"same-origin",integrity:re.integrity[o]}).then(function(m){if(!m.ok)throw Error(t(7,m.status+" "+m.statusText+", loading "+o+(a?" from "+a:"")));var S=m.headers.get("content-type");if(!S||!b.test(S))throw Error(t(4,'Unknown Content-Type "'+S+'", loading '+o+(a?" from "+a:"")));return m.text().then(function(T){return T.indexOf("//# sourceURL=")<0&&(T+="\n//# sourceURL="+o),(0,eval)(T),p.getRegister(o)})}):w.apply(this,arguments)},d.resolve=function(o,a){return g(re,r(o,a=a||X)||o,a)||function(p,m){throw Error(t(8,"Unable to resolve bare specifier '"+p+(m?"' from "+m:"'")))}(o,a)};var ne=d.instantiate;d.instantiate=function(o,a){var p=re.depcache[o];if(p)for(var m=0;m<p.length;m++)A(this,this.resolve(p[m],o),o);return ne.call(this,o,a)},te&&"function"==typeof importScripts&&(d.instantiate=function(o){var a=this;return Promise.resolve().then(function(){return importScripts(o),a.getRegister(o)})}),function(o){function a(k){return!o.hasOwnProperty(k)||!isNaN(k)&&k<o.length||he&&o[k]&&typeof window<"u"&&o[k].parent===window}var p,m,S,T=o.System.constructor.prototype,$=T.import;T.import=function(k,ie){return function(){for(var L in p=m=void 0,o)a(L)||(p?m||(m=L):p=L,S=L)}(),$.call(this,k,ie)};var F=[[],function(){return{}}],Z=T.getRegister;T.getRegister=function(){var k=Z.call(this);if(k)return k;var ie,L=function(_){var G,P,oe=0;for(var le in o)if(!a(le)){if(0===oe&&le!==p||1===oe&&le!==m)return le;G?(S=le,P=_&&P||le):G=le===S,oe++}return P}(this.firstGlobalProp);if(!L)return F;try{ie=o[L]}catch{return F}return[[],function(_){return{execute:function(){_(ie),_({default:ie,__useDefault:!0})}}}]};var he=typeof navigator<"u"&&-1!==navigator.userAgent.indexOf("Trident")}(typeof self<"u"?self:global),function(o){var a=o.System.constructor.prototype,p=/^[^#?]+\.(css|html|json|wasm)([?#].*)?$/,m=a.shouldFetch.bind(a);a.shouldFetch=function(Z){return m(Z)||p.test(Z)};var S=/^application\/json(;|$)/,T=/^text\/css(;|$)/,$=/^application\/wasm(;|$)/,F=a.fetch;a.fetch=function(Z,he){return F(Z,he).then(function(k){if(he.passThrough||!k.ok)return k;var ie=k.headers.get("content-type");return S.test(ie)?k.json().then(function(L){return new Response(new Blob(['System.register([],function(e){return{execute:function(){e("default",'+JSON.stringify(L)+")}}})"],{type:"application/javascript"}))}):T.test(ie)?k.text().then(function(L){return L=L.replace(/url\(\s*(?:(["'])((?:\\.|[^\n\\"'])+)\1|((?:\\.|[^\s,"'()\\])+))\s*\)/g,function(_,G,P,oe){return"url("+G+n(P||oe,Z)+G+")"}),new Response(new Blob(["System.register([],function(e){return{execute:function(){var s=new CSSStyleSheet();s.replaceSync("+JSON.stringify(L)+');e("default",s)}}})'],{type:"application/javascript"}))}):$.test(ie)?(WebAssembly.compileStreaming?WebAssembly.compileStreaming(k):k.arrayBuffer().then(WebAssembly.compile)).then(function(L){o.System.wasmModules||(o.System.wasmModules=Object.create(null)),o.System.wasmModules[Z]=L;var _=[],G=[];return WebAssembly.Module.imports&&WebAssembly.Module.imports(L).forEach(function(P){var oe=JSON.stringify(P.module);-1===_.indexOf(oe)&&(_.push(oe),G.push("function(m){i["+oe+"]=m}"))}),new Response(new Blob(["System.register(["+_.join(",")+"],function(e){var i={};return{setters:["+G.join(",")+"],execute:function(){return WebAssembly.instantiate(System.wasmModules["+JSON.stringify(Z)+"],i).then(function(m){e(m.exports)})}}})"],{type:"application/javascript"}))}):k})}}(typeof self<"u"?self:global);var de=typeof Symbol<"u"&&Symbol.toStringTag;d.get=function(o){var a=this[O][o];if(a&&null===a.e&&!a.E)return a.er?null:a.n},d.set=function(o,a){try{new URL(o)}catch{console.warn(Error(t("W3",'"'+o+'" is not a valid URL to set in the module registry')))}var p;de&&"Module"===a[de]?p=a:(p=Object.assign(Object.create(null),a),de&&Object.defineProperty(p,de,{value:"Module"}));var m=Promise.resolve(p),S=this[O][o]||(this[O][o]={id:o,i:[],h:!1,d:[],e:null,er:void 0,E:void 0});return!S.e&&!S.E&&(Object.assign(S,{n:p,I:void 0,L:void 0,C:m}),p)},d.has=function(o){return!!this[O][o]},d.delete=function(o){var a=this[O],p=a[o];if(!p||p.p&&null!==p.p.e||p.E)return!1;var m=p.i;return p.d&&p.d.forEach(function(S){var T=S.i.indexOf(p);-1!==T&&S.i.splice(T,1)}),delete a[o],function(){var S=a[o];if(!S||!m||null!==S.e||S.E)return!1;m.forEach(function(T){S.i.push(T),T(S.n)}),m=null}};var H=typeof Symbol<"u"&&Symbol.iterator;d.entries=function(){var o,a,p=this,m=Object.keys(p[O]),S=0,T={next:function(){for(;void 0!==(a=m[S++])&&void 0===(o=p.get(a)););return{done:void 0===a,value:void 0!==a&&[a,o]}}};return T[H]=function(){return this},T}}(),LightPivotTable=function(){var DataController=function(t,r){if(r&&"function"!=typeof r)throw new Error("dataChangeTrigger parameter must be a function");this._dataStack=[],this.controller=t,this.pushData(),this.dataChangeTrigger=r,this.SUMMARY_SHOWN=!1};DataController.prototype.isValidData=function(t){return t.dimensions instanceof Array&&t.dimensions[0]instanceof Array&&!t.dimensions[0].length&&(t.dimensions[0]=[{}]),t.dimensions instanceof Array&&t.dimensions[0]instanceof Array&&t.dataArray instanceof Array&&"object"==typeof t.info&&t.info.cubeName},DataController.prototype.pushData=function(){var t;this._dataStack.push(t={data:null,SUMMARY_SHOWN:this.SUMMARY_SHOWN,SORT_STATE:{column:null,order:-1}}),this.SORT_STATE=t.SORT_STATE},DataController.prototype.popData=function(){if(!(this._dataStack.length<2)){var t=this._dataStack[this._dataStack.length-2];this._dataStack.pop(),this.SUMMARY_SHOWN=t.SUMMARY_SHOWN,this.SORT_STATE=t.SORT_STATE}},DataController.prototype.getData=function(){return this._dataStack[this._dataStack.length-1].data||{}},DataController.prototype.setData=function(t){if(this.isValidData(t))return this._dataStack[this._dataStack.length-1].data=t,this.setLeftHeaderColumnsNumber(t),this.pivotDataProcess(t),this.resetDimensionProps(),this.resetConditionalFormatting(),this.resetRawData(),this.modifyRawData(t),this.postDataProcessing(t),"drillthrough"===t.info.mdxType&&this.setDrillThroughHandler(this.controller.pivotView.listingClickHandler.bind(this.controller.pivotView)),this._trigger(),t;console.error("Invalid data to set.",t)},DataController.prototype.pivotDataProcess=function(t){var r=this.controller.getPivotProperty(["rowTotals"]);"boolean"==typeof r&&(this.controller.CONFIG.showSummary=r)},DataController.prototype.setDrillThroughHandler=function(t){this._dataStack[this._dataStack.length-1].data.info.drillThroughHandler=t},DataController.prototype.resetDimensionProps=function(){var t,r,n;if(t=this._dataStack[this._dataStack.length-1].data){n=[];var i=function(s){var l,f={};for(l in s)f[l]=s[l];return f},c=function(s,l,f){var g,v,N;if(l.children&&l.children.length>0)for(N in l.children)v=i(f),(g=l.children[N]).format&&(v.format=g.format),g.style&&(v.style=(v.style||"")+g.style),g.summary&&(v.summary=g.summary),g.total&&(v.summary=(g.total||"").toLowerCase().replace(/:.*/,"")),g.type&&(v.type=g.type),c(s,g,v);else s.push(i(f))};c(r=[],{children:t.dimensions[0]},{}),c(n,{children:t.dimensions[1]},{}),t.columnProps=r,t.rowProps=n}else console.error("Unable to get dimension props for given data set.")},DataController.prototype.getTypeByValue=function(t){return isNaN(t)?(t+"").match(/[0-9]{2}\.[0-9]{2}\.[0-9]{2,4}/)?{type:"date",comparator:function(r){var n=r.split(".");return new Date(n[2],n[1],n[0])}}:Date.parse(t)?{type:"date",comparator:function(r){return new Date(r)}}:{type:"string"}:{type:"number"}},DataController.prototype.postDataProcessing=function(t){var r,n;if(t&&t.rawData&&t.rawData[t.info.topHeaderRowsNumber])for(t.columnProps||(t.columnProps=[]),n=t.info.leftHeaderColumnsNumber;r=t.rawData[t.info.topHeaderRowsNumber][n];n++)t.columnProps[n]||(t.columnProps[n]={}),t.columnProps[n].$FORMAT=this.getTypeByValue(r.value)},DataController.prototype.resetConditionalFormatting=function(){var t,r,n,i,c,s,l,g,f={};if(t=this._dataStack[this._dataStack.length-1].data)if(this.controller.CONFIG.pivotProperties){for(var v in(r=this.controller.CONFIG.pivotProperties.colorScale)&&(r.indexOf("custom:")>-1?(c=r.split(":")[1].split(","),i={r:parseInt(c[0]),g:parseInt(c[1]),b:parseInt(c[2])},c=r.split(":")[2].split(","),n={r:parseInt(c[0]),g:parseInt(c[1]),b:parseInt(c[2])}):(c=r.split("-to-"),n=this.controller.pivotView.colorNameToRGB(c[0]),i=this.controller.pivotView.colorNameToRGB(c[1])),f.colorScale={from:i,to:n,min:s=Math.min.apply(Math,t.dataArray||[]),max:l=Math.max.apply(Math,t.dataArray||[]),diff:l-s,invert:(i.r+i.b+i.g)/3<128}),(g=this.controller.CONFIG.pivotProperties.formatRules||[]).length&&typeof this.controller.CONFIG.conditionalFormattingOn>"u"&&(this.controller.CONFIG.conditionalFormattingOn=!0),g)f[g[v].range]||(f[g[v].range]=[]),f[g[v].range].push(g[v]);t.conditionalFormatting=f}else t.conditionalFormatting=f;else console.error("Unable to get conditional formatting for given data set.")},DataController.prototype.TOTAL_FUNCTIONS={isNumber:function(t){return""!=t&&isFinite(t)},totalSUM:function(t,r,n,i,c,s){for(var l=0,f=r;f<n;f++){var g=typeof s>"u"?f:s,v=typeof i>"u"?f:i;this.isNumber(t[g][v].value)&&(l+=parseFloat(t[g][v].value)||0)}return l},totalAVG:function(t,r,n,i,c,s){for(var l=0,f=r;f<n;f++){var g=typeof s>"u"?f:s,v=typeof i>"u"?f:i;if(!this.isNumber(t[g][v].value)){l=0;break}l+=parseFloat(t[g][v].value)||0}return l/(n-r)||""},totalCOUNT:function(t,r,n,i,c,s){for(var l=0,f=r;f<n;f++){var v=typeof i>"u"?f:i;t[typeof s>"u"?f:s][v].value&&l++}return l},totalMIN:function(t,r,n,i,c,s){for(var l=1/0,f=r;f<n;f++){var g=typeof s>"u"?f:s,v=typeof i>"u"?f:i;this.isNumber(t[g][v].value)&&t[g][v].value<l&&(l=t[g][v].value)}return l},totalMAX:function(t,r,n,i,c,s){for(var l=-1/0,f=r;f<n;f++){var g=typeof s>"u"?f:s,v=typeof i>"u"?f:i;this.isNumber(t[g][v].value)&&t[g][v].value>l&&(l=t[g][v].value)}return l},totalPERCENTAGE:function(t,r,n,i,c,s){var f,g,l=[];for(f=c;f<typeof i==="undefined"?t.length:t[0].length;f++)l.push(this.totalSUM(t,r,n,typeof i>"u"?i:f,c,typeof s>"u"?s:f));return g=l.reduce(function(v,N){return v+N}),(l[(typeof s>"u"?i:s)-c]/g*100||0).toFixed(2)+"%"},totalNONE:function(){return""}},DataController.prototype.setLeftHeaderColumnsNumber=function(t){t.info.leftHeaderColumnsNumber=function r(n,i){if(!(n.children instanceof Array))return i;for(var c=i+1,s=0;s<n.children.length;s++)i=Math.max(r(n.children[s],c),i);return i}({children:t.dimensions[1]||[]},0)},DataController.prototype.resetRawData=function(){var r,n,i,c,s,t="font-weight: bold;text-align: right;",l=this;if(!(r=this._dataStack[this._dataStack.length-1].data))return console.error("Unable to create raw data for given data set."),null;var f=[],g=[],v=2,N=[],E=l.controller.CONFIG.pivotProperties&&2===l.controller.CONFIG.pivotProperties.hideMeasures,x=function(O,d){l.controller.CONFIG.pivotProperties&&(l.controller.CONFIG.pivotProperties.columnHeaderStyle&&d?O.style=l.controller.CONFIG.pivotProperties.columnHeaderStyle:l.controller.CONFIG.pivotProperties.rowHeaderStyle&&!d&&(O.style=l.controller.CONFIG.pivotProperties.rowHeaderStyle))},J=function(O,d,R,y,M,K){var re,q,Q;for(var U in R||(R=[]),d)re=v,M<K&&!(d[U].children&&d[U].children.length)&&(d[U].children=[{}],Q=!0),d[U].children&&d[U].children.length?(Q?Q=!1:v++,q={group:re,source:d[U],isCaption:!0,value:d[U].caption||""},x(q,y),J(O,d[U].children,R.concat(q),y,M&&M+1,K)):(q={group:v,source:d[U],isCaption:!0,value:d[U].caption||""},x(q,y),O.push("msr"===d[U].type&&E?R:R.concat(q)),v++)};r.dimensions[0].length&&function(O,d,R){J(f,d,R,!0);var y,M=0;for(y in f)f[y].length>M&&(M=f[y].length);for(y in f)for(var K=f[y].length;K<M;K++)f[y].push(f[y][f[y].length-1]);f=function(O){return Object.keys(O[0]).map(function(d){return O.map(function(R){return R[d]})})}(f)}(0,r.dimensions[0]),r.dimensions[1].length&&J(g,r.dimensions[1],void 0,void 0,1,function(O,d){function R(y,M){if(y.children){var K=0;for(var re in y.children)K=Math.max(K,R(y.children[re],M+1));return K}return"msr"===y.type&&E?M-1:M}return typeof d>"u"&&(d=0),O.reduce(function(y,M){return Math.max(y,R(M,1))},d)}(r.dimensions[1])),g[0]&&(s=(g[0][g[0].length-1]||{source:{}}).source.dimension);var z=(f[0]||[]).length,te=g.length||r.info.rowCount||0,j=f.length||r.info.colCount||0,Y=(g[0]||[]).length,h=!!this.controller.CONFIG.attachTotals;for(i=0;i<j+te;i++)for(N[i]||(N[i]=[]),c=0;c<Y+z;c++)c<Y?i<j?(N[i][c]={group:1,isCaption:!0,value:!1===this.controller.getPivotProperty(["showRowCaption"])?"":this.controller.CONFIG.caption||s||(r.info||{}).cubeName||""},x(N[i][c],!1)):N[i][c]=g[i-j][c]:N[i][c]=i<j?f[i][c-Y]:{value:r.dataArray[z*(i-j)+c-Y]};for(r.info.topHeaderRowsNumber=j,r.info.SUMMARY_SHOWN=!1,r.info.leftHeaderColumnsNumber=Y,this.SUMMARY_SHOWN=!1,this._dataStack[this._dataStack.length-1].SUMMARY_SHOWN=!1,C=0;C<r.info.leftHeaderColumnsNumber;C++)r.columnProps.unshift({});for(C=0;C<r.info.topHeaderRowsNumber;C++)r.rowProps.unshift({});var u=function(O,d){var R=l.controller.getPivotProperty(["rowTotalAgg"])||"sum",y=l.controller.getPivotProperty(["columnTotalAgg"])||"sum",M=d?"rowProps":"columnProps";if(!r[M][O]&&!(d?y:R))return l.TOTAL_FUNCTIONS.totalSUM;switch((r[M][O]||{}).summary||R){case"count":default:return l.TOTAL_FUNCTIONS.totalSUM;case"avg":return l.TOTAL_FUNCTIONS.totalAVG;case"min":return l.TOTAL_FUNCTIONS.totalMIN;case"max":return l.TOTAL_FUNCTIONS.totalMAX;case"pct":return l.TOTAL_FUNCTIONS.totalPERCENTAGE;case"none":return l.TOTAL_FUNCTIONS.totalNONE}};if(this.controller.CONFIG.showSummary&&N.length-r.info.topHeaderRowsNumber>1&&(N[N.length-1][0]||{}).isCaption){for(var C in r.info.SUMMARY_SHOWN=!0,this.SUMMARY_SHOWN=!0,this._dataStack[this._dataStack.length-1].SUMMARY_SHOWN=!0,n=[],N[c=N.length-2])N[c][C].isCaption?(n[C]={group:v,isCaption:!0,source:{},noDrillDown:!0,value:pivotLocale.get(0)},x(n[C],!1)):n[C]={value:u(parseInt(C)).call(this.TOTAL_FUNCTIONS,N,j,N.length,C,r.info.leftHeaderColumnsNumber),style:t};v++,h?(N.splice(r.info.topHeaderRowsNumber,0,n),r.info.topHeaderRowsNumber++):N.push(n)}if(this.controller.getPivotProperty(["columnTotals"])&&N.length-r.info.topHeaderRowsNumber>1&&r.info.leftHeaderColumnsNumber>0){var I,D=++v;for(I=0;I<r.info.topHeaderRowsNumber;I++)N[I].push({group:D,isCaption:!0,value:pivotLocale.get(0)});for(I=r.info.topHeaderRowsNumber;I<N.length;I++)N[I].push({isCaption:!0,value:u(I,!0).call(this.TOTAL_FUNCTIONS,N,r.info.leftHeaderColumnsNumber,N[I].length,void 0,r.info.leftHeaderColumnsNumber,I),style:t})}return N=function(O){if(!l.controller.CONFIG.pivotProperties)return O;var d,R,y,M=O[0].length,K=l.controller.getPivotProperty(["columnLevels"]),re=l.controller.getPivotProperty(["rowLevels"]),q={},Q={},U=function(ae,V){if(!(typeof V>"u"))for(var w in V.childLevels)V.childLevels[w]&&V.childLevels[w].spec&&(ae[(V.childLevels[w].spec||"").replace(/[^.]*$/,"")]={style:V.childLevels[w].levelStyle||"",headStyle:V.childLevels[w].levelHeaderStyle||""}),U(V.childLevels[w])};for(y in K)U(q,{childLevels:[K[y]]}),U(Q,{childLevels:[re[y]]});for(R=0;R<O.length;R++)for(d=0;d<M;d++){if(!O[R][d].isCaption){M=d;break}if(O[R][d].source&&O[R][d].source.path){var se=r.info.topHeaderRowsNumber>R?q:Q;for(y in se)if(O[R][d].source.path.indexOf(y)>=0){O[R][d].isCaption?se[y].headStyle&&(O[R][d].style=(O[R][d].style||"")+se[y].headStyle||""):se[y].style&&(O[R][d].style=(O[R][d].style||"")+se[y].style||"");break}}}return O}(N),r.rawData=r._rawDataOrigin=N,r.rawData},DataController.prototype._trigger=function(){this.dataChangeTrigger&&this.dataChangeTrigger()},DataController.prototype.sortByColumn=function(t){var i,r=this._dataStack[this._dataStack.length-1].data,n=this.SUMMARY_SHOWN&&this.controller.CONFIG.attachTotals?1:0;this.SORT_STATE.column!==t&&(l=this.SORT_STATE.order=0);var c=r._rawDataOrigin.slice(r.info.topHeaderRowsNumber,r._rawDataOrigin.length-(this.SUMMARY_SHOWN&&!n?1:0)),s=r.info.leftHeaderColumnsNumber+t,l=-1===this.SORT_STATE.order?1:1===this.SORT_STATE.order?0:-1;for(var f in this.SORT_STATE.order=l,this.SORT_STATE.column=t,r.rawData[r.info.topHeaderRowsNumber-n-1])r.rawData[r.info.topHeaderRowsNumber-n-1][f].className&&delete r.rawData[r.info.topHeaderRowsNumber-n-1][f].className;if(0===l)return r.rawData=r._rawDataOrigin,this.modifyRawData(r),void this._trigger();l=-l,"function"==typeof(i=((r.columnProps[t]||{}).$FORMAT||{}).comparator)?c.sort(function(g,v){return i(v[s].value)>i(g[s].value)?l:i(v[s].value)<i(g[s].value)?-l:0}):c.sort(function(g,v){return v[s].value>g[s].value?l:v[s].value<g[s].value?-l:0}),r.rawData=r._rawDataOrigin.slice(0,r.info.topHeaderRowsNumber).concat(c).concat(this.SUMMARY_SHOWN&&!n?[r._rawDataOrigin[r._rawDataOrigin.length-1]]:[]),r.rawData[r.info.topHeaderRowsNumber-n-1][r.info.leftHeaderColumnsNumber+t].className=0===l?"":1===l?"lpt-sortDesc":"lpt-sortAsc",this.modifyRawData(r),this._trigger()},DataController.prototype.filterByValue=function(t,r){var n=this._dataStack[this._dataStack.length-1].data,i=this.SUMMARY_SHOWN&&this.controller.CONFIG.attachTotals?1:0,c=n._rawDataOrigin.slice(n.info.topHeaderRowsNumber,n._rawDataOrigin.length-(this.SUMMARY_SHOWN&&!i?1:0)),s=null;try{s=new RegExp(t,"i")}catch{try{s=new RegExp(t.replace(/([()[{*+.$^\\|?])/g,"\\$1"),"i")}catch{return}}c=c.filter(function(l){return(l[r].value||"").toString().match(s)}),n.rawData=n._rawDataOrigin.slice(0,n.info.topHeaderRowsNumber).concat(c).concat(this.SUMMARY_SHOWN&&!i?[n._rawDataOrigin[n._rawDataOrigin.length-1]]:[]),this.modifyRawData(n),this._trigger()},DataController.prototype.modifyRawData=function(t){var r=-1;this.controller.CONFIG.showRowNumbers&&!t.info.leftHeaderColumnsNumber&&(t.rawData[0]&&t.rawData[0][0].special?t.rawData.forEach(function(i){i[0].value=0==++r?"#":r,i[0].isCaption=0===r}):(t.rawData.forEach(function(i){i.unshift({value:0==++r?"#":r,isCaption:0===r,special:!0,noClick:!0})}),t.columnProps instanceof Array&&t.columnProps.unshift({}),t.info.colCount++));var n=t.info.topHeaderRowsNumber-1;for(r=t.info.leftHeaderColumnsNumber;r<t.rawData[n].length;r++)t.rawData[n][r].style="min-width:"+(this.controller.getPivotProperty(["cellWidth"])||100)+"px;"+(t.rawData[n][r].style?t.rawData[n][r].style:"")};var DataSource=function(t,r,n,i){this.SOURCE_URL=t.MDX2JSONSource||location.host+":"+location.port+"/"+(location.pathname.split("/")||[])[1],this.NAMESPACE=t.namespace,this.USERNAME=t.username,this.PASSWORD=t.password,this.LPT=n,this.GLOBAL_CONFIG=r,this.SEND_COOKIES=t.sendCookies||!1,this.DRILL_LEVEL="number"!=typeof i?1:i,this.BASIC_MDX=t.basicMDX,this.DATA_SOURCE_PIVOT=t.pivot||"",this.FILTERS=[]};DataSource.prototype._post=function(url,data,callback){var xhr=new XMLHttpRequest,self=this;xhr.open("POST",url),this.SEND_COOKIES&&(xhr.withCredentials=!0),xhr.onreadystatechange=function(){var handler;4===xhr.readyState&&(handler=self.LPT.CONFIG.triggers.responseHandler,"function"==typeof handler&&handler.call(self.LPT,{url,status:xhr.status,xhr})),4===xhr.readyState&&200===xhr.status?callback(function(){try{return JSON.parse(xhr.responseText)||{}}catch(e){try{var temp=null;return eval("temp="+xhr.responseText),temp}catch(t){return{error:"<h1>Unable to parse server response</h1><p>"+xhr.responseText+"</p>"}}}}()):4===xhr.readyState&&200!==xhr.status&&callback({error:xhr.responseText||pivotLocale.get(3)+"<br/>"+xhr.status+": "+xhr.statusText})},this.USERNAME&&this.PASSWORD&&xhr.setRequestHeader("Authorization","Basic "+btoa(this.USERNAME+":"+this.PASSWORD)),xhr.send(JSON.stringify(data))},DataSource.prototype._convert=function(t){if("object"!=typeof t||t.error)return{error:t.error||!0};try{return{dimensions:[t.Cols[0].tuples,t.Cols[1]?t.Cols[1].tuples:[{caption:""}]],dataArray:t.Data,info:t.Info}}catch(n){return console.error("Error while parsing data:",n),{error:t.error||!0}}},DataSource.prototype.setFilter=function(t){this.FILTERS.push(t)},DataSource.prototype.clearFilters=function(){this.FILTERS=[]},DataSource.prototype.getCurrentData=function(t){for(var r=this,n=this._convert,i=this.BASIC_MDX,c=new MDXParser,s=c.mdxType(i),l={state:0,data:{},pivotData:{}},f=0;f<this.FILTERS.length;f++)i=c.applyFilter(i,this.FILTERS[f]);"number"==typeof this.GLOBAL_CONFIG.rowCount&&(i=c.applyRowCount(i,this.GLOBAL_CONFIG.rowCount));var N=function(){r.LPT.CONFIG.logs&&console.log("LPT MDX request:",i);var E=function(A){r.LPT.pivotView.removeMessage(),l.data=A,l.state++,function(){var E=l.data;if("drillthrough"===s)t(function(A){var W,J,X,B=A.children||[],x=[];if(!B.length)return{error:pivotLocale.get(4)};for(J in B[0])x.push({caption:J});for(J in W={Cols:[{tuples:x},{tuples:[]}],Data:[],Info:{colCount:8,cubeClass:"No cube class",cubeName:"No cube name",leftHeaderColumnsNumber:0,rowCount:B.length,topHeaderRowsNumber:x.length,mdxType:s}},B)for(X in B[J])W.Data.push(B[J][X]);return n(W)}(E));else if("mdx"===s){if(!(E&&E.Data&&E.Data.length&&E.Cols&&(E.Data.length||((E.Cols[0]||{}).tuples||[]).length||((E.Cols[1]||{}).tuples||[]).length)))return t({error:pivotLocale.get(4)});t(r._convert(E))}else t({error:"Unrecognised MDX type: "+i||!0})}()};0===r.DRILL_LEVEL&&r.LPT.CONFIG.initialData?E(r.LPT.CONFIG.initialData):r._post(r.SOURCE_URL+"/"+("drillthrough"===s?"MDXDrillthrough":"MDX")+(r.NAMESPACE?"?Namespace="+r.NAMESPACE:""),{MDX:i},E)};r.LPT.pivotView.displayLoading(),this.DATA_SOURCE_PIVOT?this._post(this.SOURCE_URL+"/DataSource"+(r.NAMESPACE?"?Namespace="+r.NAMESPACE:""),{DataSource:this.DATA_SOURCE_PIVOT},function(E){l.pivotData=E,l.state++,function(){var E=l.pivotData;r.GLOBAL_CONFIG.pivotProperties=l.pivotData,E.rowAxisOptions&&(E.rowAxisOptions.drilldownSpec&&(r.GLOBAL_CONFIG.DrillDownExpression=r.GLOBAL_CONFIG.DrillDownExpression||E.rowAxisOptions.drilldownSpec.split("^")),(E.rowAxisOptions.levelFormat||E.columnAxisOptions&&E.columnAxisOptions.levelFormat)&&(r.GLOBAL_CONFIG.formatNumbers=r.GLOBAL_CONFIG.formatNumbers||E.columnAxisOptions.levelFormat||E.rowAxisOptions.levelFormat))}(),N()}):(r.GLOBAL_CONFIG.pivotProperties={},N())};var ExcelExport=function(){},t,r,n,i;ExcelExport.prototype.exportTableHTML=(t="data:application/vnd.ms-excel;base64,",r='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',n=function(c){return window.btoa(unescape(encodeURIComponent(c)))},i=function(c,s){return c.replace(/{(\w+)}/g,function(l,f){return s[f]})},function(c,s){var l={worksheet:s||"Worksheet",table:c};console.log(t+n(i(r,l))),window.location.href=t+n(i(r,l))}),ExcelExport.prototype.exportXLS=function(){var t=document.getElementsByClassName("lpt")[0],r=t.getElementsByClassName("lpt-tableBlock")[0].getElementsByTagName("table")[0].innerHTML,n=t.getElementsByClassName("lpt-topHeader")[0].getElementsByTagName("table")[0].innerHTML.replace(/<tr>/,"<tr><th colspan='2'></th>"),c=t.getElementsByClassName("lpt-leftHeader")[0].getElementsByTagName("thead")[0].innerHTML.match("<tr>(.*)</tr>")[1].split("</tr><tr>"),s=0;r=r.replace(/<tr>/g,function(){return"<tr>"+c[s++]}),console.log(n+r),this.exportTableHTML(n+r,"test")};var LightPivotTable=function(t){var r=this;"object"!=typeof t&&(t={}),this.normalizeConfiguration(t),this._dataSourcesStack=[],this.DRILL_LEVEL=-1,this.CONFIG=t,this.VERSION="".concat("1.8.14")||"[NotBuilt]",this.CONTROLS={},this.mdxParser=new MDXParser,this.pivotView=new PivotView(this,t.container),this.dataSource=this.pushDataSource(t.dataSource),this.dataController=new DataController(this,function(){r.dataIsChanged.call(r)}),this.init()};LightPivotTable.prototype.refresh=function(){var r,t=this;if(this.dataSource.BASIC_MDX){if(this.clearFilters(),this.CONFIG.defaultFilterSpecs instanceof Array)for(r in this.CONFIG.defaultFilterSpecs)this.setFilter(this.CONFIG.defaultFilterSpecs[r]);this.dataSource.getCurrentData(function(n){t.dataController.isValidData(n)?t.dataController.setData(n):t.pivotView.displayMessage(n.error||pivotLocale.get(2))})}else console.log("Unable to refresh: no basic MDX set.")},LightPivotTable.prototype.changeBasicMDX=function(t){for(var r=this._dataSourcesStack.length-1;r>0;r--)this.popDataSource(),this.pivotView.popTable(),this.dataController.popData();this.CONFIG.dataSource.basicMDX=t,this.dataSource.BASIC_MDX=t,this.refresh()},LightPivotTable.prototype.setRowCount=function(t){this.CONFIG.rowCount=t},LightPivotTable.prototype.getActualMDX=function(){var t=this.dataSource.BASIC_MDX,r=new MDXParser,n=this.dataSource.FILTERS;for(var i in n)t=r.applyFilter(t,n[i]);return"number"==typeof this.CONFIG.rowCount&&(t=r.applyRowCount(t,this.CONFIG.rowCount)),t},LightPivotTable.prototype.isListing=function(){return 0===(this.dataController.getData().info||{}).leftHeaderColumnsNumber},LightPivotTable.prototype.getSelectedRows=function(){var n,t=[],r=this.pivotView.selectedRows;for(n in r)r[n]&&t.push(+n);return t},LightPivotTable.prototype.getRowsValues=function(t){if(typeof t>"u")return[];if(t instanceof Array||(t=[t]),0===t.length)return[];for(var r=this.dataController.getData(),n=[],i=0;i<t.length;i++)n.push(r.rawData[t[i]-1+(r.info.topHeaderRowsNumber||1)]);return n},LightPivotTable.prototype.getModel=function(){return this.dataController.getData()},LightPivotTable.prototype.updateSizes=function(){this.pivotView.updateSizes()},LightPivotTable.prototype.setFilter=function(t){this.dataSource.setFilter(t)},LightPivotTable.prototype.clearFilters=function(){this.dataSource.clearFilters()},LightPivotTable.prototype.pushDataSource=function(t){var r;return this.DRILL_LEVEL++,this._dataSourcesStack.push(r=new DataSource(t||{},this.CONFIG,this,this.DRILL_LEVEL)),this.dataSource=r,r},LightPivotTable.prototype.popDataSource=function(t){this._dataSourcesStack.length<2||(this.DRILL_LEVEL--,this._dataSourcesStack.pop(),t||this.dataController.popData(),this.dataSource=this._dataSourcesStack[this._dataSourcesStack.length-1])},LightPivotTable.prototype.dataIsChanged=function(){this.pivotView.dataChanged(this.dataController.getData())},LightPivotTable.prototype.tryDrillDown=function(t){var n,r=this,i={};for(var c in r.CONFIG.dataSource)i[c]=r.CONFIG.dataSource[c];this.CONFIG.DrillDownExpression&&!(this.CONFIG.DrillDownExpression instanceof Array)&&(this.CONFIG.DrillDownExpression=[this.CONFIG.DrillDownExpression]),(this.CONFIG.DrillDownExpression||[])[this.DRILL_LEVEL]?i.basicMDX=this.mdxParser.drillDown(this.dataSource.BASIC_MDX,t,this.CONFIG.DrillDownExpression[this.DRILL_LEVEL])||this.dataSource.BASIC_MDX:i.basicMDX=this.mdxParser.drillDown(this.dataSource.BASIC_MDX,t)||this.dataSource.BASIC_MDX,n=this.dataSource,this.pushDataSource(i),this.dataSource.FILTERS=n.FILTERS,this.dataSource.getCurrentData(function(s){r.dataController.isValidData(s)&&s.dataArray.length>0&&s.dimensions[1]&&s.dimensions[1][0]&&(s.dimensions[1][0].caption||s.dimensions[1][0].dimension||s.dimensions[1][0].path)?(r.pivotView.pushTable(),r.dataController.pushData(),r.dataController.setData(s),"function"==typeof r.CONFIG.triggers.drillDown&&r.CONFIG.triggers.drillDown.call(r,{level:r.DRILL_LEVEL,mdx:i.basicMDX,path:s.dimensions[1][0].path||""})):r.popDataSource(!0)})},LightPivotTable.prototype.tryDrillThrough=function(t){var n,r=this,i={};for(var c in r.CONFIG.dataSource)i[c]=r.CONFIG.dataSource[c];const s=this.CONFIG.controls?.find(l=>"showListing"===l.action)?.targetProperty;i.basicMDX=this.mdxParser.drillThrough(this.dataSource.BASIC_MDX,t,s)||this.dataSource.basicMDX,n=this.dataSource,this.pushDataSource(i),this.dataSource.FILTERS=n.FILTERS,this.dataSource.getCurrentData(function(l){r.dataController.isValidData(l)&&l.dataArray.length>0?(r.pivotView.pushTable({disableConditionalFormatting:!0}),r.dataController.pushData(),r.dataController.setData(l),"function"==typeof r.CONFIG.triggers.drillThrough&&r.CONFIG.triggers.drillThrough.call(r,{level:r.DRILL_LEVEL,mdx:i.basicMDX})):r.popDataSource(!0)})},LightPivotTable.prototype.getPivotProperty=function(t){if(this.CONFIG.pivotProperties){t instanceof Array||(t=[]);var r=this.CONFIG.pivotProperties;for(t=t.reverse();t.length&&typeof r<"u";)r=r[t.pop()];return r}},LightPivotTable.prototype.attachTrigger=function(t,r){"function"==typeof r?this.CONFIG.triggers[t]=r:console.warn("LPT.addTrigger: pass the trigger as a second argument.")},LightPivotTable.prototype.normalizeConfiguration=function(t){typeof t.columnResizing>"u"&&(t.columnResizing=!0),typeof t.pagination>"u"&&(t.pagination=200),typeof t.enableSearch>"u"&&(t.enableSearch=!0),typeof t.stretchColumns>"u"&&(t.stretchColumns=!0),typeof t.enableListingSelect>"u"&&(t.enableListingSelect=!0),typeof t.showListingRowsNumber>"u"&&(t.showListingRowsNumber=!0),t.triggers||(t.triggers={}),t.dataSource||(t.dataSource={})},LightPivotTable.prototype.init=function(){var t=this;this.CONTROLS.drillThrough=function(){t.pivotView._drillThroughClickHandler.call(t.pivotView)},this.CONTROLS.customDrillThrough=function(r){r instanceof Array?t.tryDrillThrough.call(t,r):console.error('Parameter "filters" must be array of strings.')},this.CONTROLS.back=function(){t.pivotView._backClickHandler.call(t.pivotView)},this.CONFIG.locale&&pivotLocale.setLocale(this.CONFIG.locale),this.refresh()};var MDXParser=function(){};MDXParser.prototype._warnMDX=function(t,r){console.warn("MDX is not parsed:\n\n%s\n\n"+(r?"("+r+")":""),t)},MDXParser.prototype.makeSetExpressionFromFilter=function(t){return t.match(/^\([^\),]*,[^\)]*\)$/)?"NONEMPTYCROSSJOIN"+t.slice(0,t.length-1)+".children)":t+".children"},MDXParser.prototype.prependNonEmpty=function(t){return t.match(/^\s*non\s+empty/i)?t:"NON EMPTY "+t},MDXParser.prototype.applyRowCount=function(t,r){return t.replace(/\s*on\s*0\s*,\s*(?:non\s*empty\s*)?(.*)\s*on\s*1/i,function(n,i){return typeof r<"u"?" ON 0, NON EMPTY HEAD("+i+", "+r+") ON 1":n})},MDXParser.prototype.drillDown=function(t,r,n){if(!r)return/]\s+ON\s+1/i.test(t)?t=t.replace(/]\s+ON\s+1/i,"].children ON 1"):(this._warnMDX(t,"no filter specified"),"");var i=t.split(/(select\s*)(.*?)(\s*from)/gi);if(i.length<4)return this._warnMDX(t),"";var s=i[i.length-3].split(/(\s*ON\s*[01]\s*,?\s*)/i);if(s.length<2)return this._warnMDX(t,"DrillDown is impossible"),"";var l=-1;if(s.map(function(N,E){return N.match(/\s*ON\s*[01]\s*,?\s*/i)&&(l=E-1),N}),-1===l)return this._warnMDX(t,"DrillDown is impossible"),"";let f="";const g=s[l].match(/ORDER\((.*?)\,/);for(var v in g&&g[0]&&(f=g[0]),s[l]=f?(n||s[l]).replace(f,"ORDER("+this.makeSetExpressionFromFilter(r)+","):this.prependNonEmpty(n||this.makeSetExpressionFromFilter(r)),s)1===s[v].length&&s[v](parseInt(v),1);return i[i.length-3]=s.join(""),this.applyFilter(i.join(""),r)},MDXParser.prototype.drillThrough=function(t,r,n){var c="DRILLTHROUGH SELECT "+t.slice(t.lastIndexOf("FROM "));for(var s in r)c=this.applyFilter(c,r[s]);return n&&(c+=` %LISTING [${n}]`),c},MDXParser.prototype.mdxType=function(t){var r=t.toLowerCase(),n=r.indexOf("drillthrough"),i=r.indexOf("select");return n>-1?"drillthrough":i>-1?"mdx":"unknown"},MDXParser.prototype.applyFilter=function(t,r){return t+(r?" %FILTER "+r:"")};var numeral=function(){var t,n={},i="en",c=null,s="0,0",l=3,f=",",g=".",v=new RegExp("(\\d)(?=(\\d{"+l+"})+(?!\\d))","g");function N(h){this._value=h}function E(h,u,C,D){var O,d,I=Math.pow(10,u);return d=(C(h*I)/I).toFixed(u),D&&(O=new RegExp("0{1,"+D+"}$"),d=d.replace(O,"")),d}function A(h,u,C){return u.indexOf("$")>-1?function x(h,u,C){var R,y,D=u.indexOf("$"),I=u.indexOf("("),O=u.indexOf("-"),d="";return u.indexOf(" $")>-1?(d=" ",u=u.replace(" $","")):u.indexOf("$ ")>-1?(d=" ",u=u.replace("$ ","")):u=u.replace("$",""),y=z(h._value,u,C),D<=1?y.indexOf("(")>-1||y.indexOf("-")>-1?(y=y.split(""),R=1,(D<I||D<O)&&(R=0),y.splice(R,0,n[i].currency.symbol+d),y=y.join("")):y=n[i].currency.symbol+d+y:y.indexOf(")")>-1?((y=y.split("")).splice(-1,0,d+n[i].currency.symbol),y=y.join("")):y=y+d+n[i].currency.symbol,y}(h,u,C):u.indexOf("%")>-1?function W(h,u,C){var I,D="",O=100*h._value;return u.indexOf(" %")>-1?(D=" ",u=u.replace(" %","")):u=u.replace("%",""),I=z(O,u,C),I.indexOf(")")>-1?((I=I.split("")).splice(-1,0,D+"%"),I=I.join("")):I=I+D+"%",I}(h,u,C):u.indexOf(":")>-1?function J(h){var u=Math.floor(h._value/60/60),C=Math.floor((h._value-60*u*60)/60),D=Math.round(h._value-60*u*60-60*C);return u+":"+(C<10?"0"+C:C)+":"+(D<10?"0"+D:D)}(h):z(h._value,u,C)}function B(h,u){var D,I,O,d,M,C=u,R=["KB","MB","GB","TB","PB","EB","ZB","YB"],y=!1;if(u.indexOf(":")>-1)h._value=function X(h){var u=h.split(":"),C=0;return 3===u.length?(C+=60*Number(u[0])*60,C+=60*Number(u[1]),C+=Number(u[2])):2===u.length&&(C+=60*Number(u[0]),C+=Number(u[1])),Number(C)}(u);else if(u===c)h._value=0;else{for("."!==n[i].delimiters.decimal&&(u=u.replace(/\./g,"").replace(n[i].delimiters.decimal,".")),D=new RegExp("[^a-zA-Z]"+n[i].abbreviations.thousand+"(?:\\)|(\\"+n[i].currency.symbol+")?(?:\\))?)?$"),I=new RegExp("[^a-zA-Z]"+n[i].abbreviations.million+"(?:\\)|(\\"+n[i].currency.symbol+")?(?:\\))?)?$"),O=new RegExp("[^a-zA-Z]"+n[i].abbreviations.billion+"(?:\\)|(\\"+n[i].currency.symbol+")?(?:\\))?)?$"),d=new RegExp("[^a-zA-Z]"+n[i].abbreviations.trillion+"(?:\\)|(\\"+n[i].currency.symbol+")?(?:\\))?)?$"),M=0;M<=R.length&&!(y=u.indexOf(R[M])>-1&&Math.pow(1024,M+1));M++);h._value=(y||1)*(C.match(D)?Math.pow(10,3):1)*(C.match(I)?Math.pow(10,6):1)*(C.match(O)?Math.pow(10,9):1)*(C.match(d)?Math.pow(10,12):1)*(u.indexOf("%")>-1?.01:1)*((u.split("-").length+Math.min(u.split("(").length-1,u.split(")").length-1))%2?1:-1)*Number(u.replace(/[^0-9\.]+/g,"")),h._value=y?Math.ceil(h._value):h._value}return h._value}function z(h,u,C){var ae,V,w,b,ne,de,D=!1,I=!1,O=!1,d="",R=!1,y=!1,M=!1,K=!1,re=!1,q="",Q="",U=Math.abs(h),se=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],H="",o=!1;if(0===h&&null!==c)return c;if(u.indexOf("(")>-1?(D=!0,u=u.slice(1,-1)):u.indexOf("+")>-1&&(I=!0,u=u.replace(/\+/g,"")),u.indexOf("a")>-1&&(R=u.indexOf("aK")>=0,y=u.indexOf("aM")>=0,M=u.indexOf("aB")>=0,K=u.indexOf("aT")>=0,re=R||y||M||K,u.indexOf(" a")>-1?(d=" ",u=u.replace(" a","")):u=u.replace("a",""),U>=Math.pow(10,12)&&!re||K?(d+=n[i].abbreviations.trillion,h/=Math.pow(10,12)):U<Math.pow(10,12)&&U>=Math.pow(10,9)&&!re||M?(d+=n[i].abbreviations.billion,h/=Math.pow(10,9)):U<Math.pow(10,9)&&U>=Math.pow(10,6)&&!re||y?(d+=n[i].abbreviations.million,h/=Math.pow(10,6)):(U<Math.pow(10,6)&&U>=Math.pow(10,3)&&!re||R)&&(d+=n[i].abbreviations.thousand,h/=Math.pow(10,3))),u.indexOf("b")>-1)for(u.indexOf(" b")>-1?(q=" ",u=u.replace(" b","")):u=u.replace("b",""),w=0;w<=se.length;w++)if(ae=Math.pow(1024,w),V=Math.pow(1024,w+1),h>=ae&&h<V){q+=se[w],ae>0&&(h/=ae);break}return u.indexOf("o")>-1&&(u.indexOf(" o")>-1?(Q=" ",u=u.replace(" o","")):u=u.replace("o",""),Q+=n[i].ordinal(h)),u.indexOf("[.]")>-1&&(O=!0,u=u.replace("[.]",".")),b=h.toString().split(".")[0],ne=u.split(".")[1],de=u.indexOf(","),ne?(ne.indexOf("[")>-1?H=E(h,(ne=(ne=ne.replace("]","")).split("["))[0].length+ne[1].length,C,ne[1].length):H=E(h,ne.length,C),b=H.split(".")[0],H=H.split(".")[1].length?(g||n[i].delimiters.decimal)+H.split(".")[1]:"",O&&0===Number(H.slice(1))&&(H="")):b=E(h,null,C),b.indexOf("-")>-1&&(b=b.slice(1),o=!0),de>-1&&(b=b.toString().replace(v,"$1"+(f||n[i].delimiters.thousands))),0===u.indexOf(".")&&(b=""),(D&&o?"(":"")+(!D&&o?"-":"")+(!o&&I?"+":"")+b+H+(Q||"")+(d||"")+(q||"")+(D&&o?")":"")}function j(h){var u=h.toString().split(".");return u.length<2?1:Math.pow(10,u[1].length)}function Y(){return Array.prototype.slice.call(arguments).reduce(function(u,C){var D=j(u),I=j(C);return D>I?D:I},-1/0)}(t=function(h){return t.isNumeral(h)?h=h.value():0===h||typeof h>"u"?h=0:Number(h)||(h=t.fn.unformat(h)),new N(Number(h))}).version="1.5.3",t.isNumeral=function(h){return h instanceof N},t.language=function(h,u){if(!h)return i;if(h&&!u){if(!n[h])throw new Error("Unknown language : "+h);i=h}return(u||!n[h])&&function te(h,u){n[h]=u}(h,u),t},t.languageData=function(h){if(!h)return n[i];if(!n[h])throw new Error("Unknown language : "+h);return n[h]},t.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(h){var u=h%10;return 1==~~(h%100/10)?"th":1===u?"st":2===u?"nd":3===u?"rd":"th"},currency:{symbol:"$"}}),t.zeroFormat=function(h){c="string"==typeof h?h:null},t.defaultFormat=function(h){s="string"==typeof h?h:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(h,u){"use strict";if(null===this||typeof this>"u")throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof h)throw new TypeError(h+" is not a function");var C,D,I=this.length>>>0,O=!1;for(1<arguments.length&&(D=u,O=!0),C=0;I>C;++C)this.hasOwnProperty(C)&&(O?D=h(D,this[C],C,this):(D=this[C],O=!0));if(!O)throw new TypeError("Reduce of empty array with no initial value");return D}),t.setup=function(h,u,C){h!==g&&(g=h),u!==f&&(f=u),C!==l&&(l=C,v=new RegExp("(\\d)(?=(\\d{"+l+"})+(?!\\d))","g"))},t.fn=N.prototype={clone:function(){return t(this)},format:function(h,u){return A(this,h||s,void 0!==u?u:Math.round)},unformat:function(h){return"[object Number]"===Object.prototype.toString.call(h)?h:B(this,h||s)},value:function(){return this._value},valueOf:function(){return this._value},set:function(h){return this._value=Number(h),this},add:function(h){var u=Y.call(null,this._value,h);return this._value=[this._value,h].reduce(function C(D,I,O,d){return D+u*I},0)/u,this},subtract:function(h){var u=Y.call(null,this._value,h);return this._value=[h].reduce(function C(D,I,O,d){return D-u*I},this._value*u)/u,this},multiply:function(h){return this._value=[this._value,h].reduce(function u(C,D,I,O){var d=Y(C,D);return C*d*(D*d)/(d*d)},1),this},divide:function(h){return this._value=[this._value,h].reduce(function u(C,D,I,O){var d=Y(C,D);return C*d/(D*d)}),this},difference:function(h){return Math.abs(t(this._value).subtract(h).value())}},this.numeral=t},PivotLocale=function(t){this.LOCALE="",this.DEFAULT_LOCALE="en",this.setLocale(t||(navigator.language||"").substr(0,2)||(navigator.browserLanguage||this.DEFAULT_LOCALE).substring(0,2))};PivotLocale.prototype.LOCALES=[{ru:"\u0412\u0441\u0435\u0433\u043e",en:"Total",de:"Summe",cs:"Celkem"},{ru:"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435",en:"Unable to render data",de:"Daten k\xf6nnen nicht rendern",cs:"Nebylo mo\u017en\xe9 zobrazit data"},{ru:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f.",en:"Invalid data to display.",de:"Nicht korrekt Informationen angezeigt werden soll.",cs:"Nevhodn\xe1 data k zobrazen\xed"},{ru:"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430.",en:"Error while trying to retrieve data from server.",de:"Beim Abrufen der Daten vom Server ist ein Fehler aufgetreten.",cs:"Chyba p\u0159i pokusu o z\xedsk\xe1n\xed dat ze serveru"},{ru:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f.",en:"No data to display.",de:"Keine Daten zum anzeigen.",cs:"\u017d\xe1dn\xe1 data k zobrazen\xed"}],PivotLocale.prototype.setLocale=function(t){var r,n=[];if(t=t.toLowerCase(),this.LOCALES[0].hasOwnProperty(t))this.LOCALE=t;else{for(r in this.LOCALES[0])n.push(r);console.warn("LightPivot: locale "+t+" is not supported. Currently localized: "+n.join(", ")+"."),this.LOCALE="en"}},PivotLocale.prototype.get=function(t){return(this.LOCALES[t]||{})[this.LOCALE]||"{not localized: "+t+"}"};var pivotLocale=new PivotLocale,PivotView=function(t,r){if(!(r instanceof HTMLElement))throw new Error('Please, provide HTMLElement instance "container" into pivot table configuration.');this.tablesStack=[],this.selectedRows={},numeral.call(this),this.elements={container:r,base:document.createElement("div"),tableContainer:void 0,messageElement:void 0,searchSelect:void 0,searchInput:void 0},this.pagination=null,this.savedScroll={x:0,y:0},this.FIXED_COLUMN_SIZES=[],this.PAGINATION_BLOCK_HEIGHT=20,this.ANIMATION_TIMEOUT=500,this.SEARCH_ENABLED=!1,this.SEARCHBOX_LEFT_MARGIN=191,this.savedSearch={restore:!1,value:"",columnIndex:0},this.controller=t,this.SCROLLBAR_WIDTH=function(){var n=document.createElement("div");n.style.visibility="hidden",n.style.width="100px",n.style.msOverflowStyle="scrollbar",document.body.appendChild(n);var i=n.offsetWidth;n.style.overflow="scroll";var c=document.createElement("div");c.style.width="100%",n.appendChild(c);var s=c.offsetWidth;return n.parentNode.removeChild(n),i-s}(),this.init()};return PivotView.prototype.init=function(){var t=this,r=this.elements;r.base.className="lpt",r.base.setAttribute("LPTVersion",this.controller.VERSION),r.container.appendChild(r.base),this.pushTable(),this.displayLoading(),window.addEventListener("resize",function(){t.updateSizes.call(t)}),this._=function(){t.displayMessage('<a href="https://github.com/ZitRos/LightPivotTable">LIGHT PIVOT TABLE v'+t.controller.VERSION+'</a><br/>by <a href="https://plus.google.com/+NikitaSavchenko">Nikita Savchenko</a><br/>for dear users of products of <a href="http://www.intersystems.com/">InterSystems Corporation</a><br/>Hope you enjoy it!',!0)}},PivotView.prototype.getCellElement=function(t,r,n){var c,s,l,f,i=this.tablesStack[this.tablesStack.length-1].element,g=function(v,N,E){var B,x,W,J,X,z,te,A=[];for(te=0;te<v.rows.length;te++)for(B=v.rows[te],z=0;z<B.cells.length;z++){for(x=B.cells[z],W=z;A[te]&&A[te][W];++W);for(J=W;J<W+x.colSpan;++J)for(X=te;X<te+x.rowSpan;++X)A[X]||(A[X]=[]),A[X][J]=!0;if(W<=N&&N<W+x.colSpan&&te<=E&&E<te+x.rowSpan)return x}return null};if(n){if(!((c=i.getElementsByClassName("lpt-topHeader")[0])&&(c=c.getElementsByTagName("table")[0],c)&&(s=0,[].slice.call(c.rows).forEach(function(v){s+=v.rowSpan||1}),f=i.getElementsByClassName("lpt-leftHeader")[0],c)&&(f=f.getElementsByTagName("table")[0],c)))return null;if(l=0,(this.getCurrentTableData().element||{})._listing||[].slice.call((f.rows[0]||{cells:[]}).cells).forEach(function(v){l+=v.colSpan||1}),t<l&&r<s)return i.getElementsByClassName("lpt-headerValue")[0]||null;if(t>=l&&r<s)return(g(c,t-l,r)||{childNodes:[null]}).childNodes[0];if(t<l&&r>=s)return(g(f,t,r-s)||{childNodes:[null]}).childNodes[0];t-=l,r-=s}return(c=i.getElementsByClassName("lpt-tableBlock")[0])&&(c=c.getElementsByTagName("table")[0])?((c.rows[r]||{cells:[]}).cells[t]||{childNodes:[null]}).childNodes[0]:null},PivotView.prototype.getTableSize=function(t){var r,n=0,i=0,c=this.tablesStack[this.tablesStack.length-1].element;return(r=c.getElementsByClassName("lpt-tableBlock")[0])&&(r=r.getElementsByTagName("table")[0])?([].slice.call(r.rows).forEach(function(s){i+=s.rowSpan||1}),[].slice.call((r.rows[0]||{cells:[]}).cells).forEach(function(s){n+=s.colSpan||1}),t?(r=c.getElementsByClassName("lpt-topHeader")[0])&&(r=r.getElementsByTagName("table")[0])&&([].slice.call(r.rows).forEach(function(s){i+=s.rowSpan||1}),r=c.getElementsByClassName("lpt-leftHeader")[0])&&(r=r.getElementsByTagName("table")[0])?((this.getCurrentTableData().element||{})._listing||[].slice.call((r.rows[0]||{cells:[]}).cells).forEach(function(s){n+=s.colSpan||1}),{width:n,height:i}):0:{width:n,height:i}):0},PivotView.prototype.displayLoading=function(){this.displayMessage(this.controller.CONFIG.loadingMessageHTML||'<div class="lpt-spinner"><div></div><div></div><div></div><div></div><div></div></div>')},PivotView.prototype.updateSizes=function(){for(var t in this.tablesStack)this.recalculateSizes(this.tablesStack[t].element)},PivotView.prototype._updateTablesPosition=function(t){for(var r=0;r<this.tablesStack.length;r++)this.tablesStack[r].element.style.left=100*(1+(t||0)+r-this.tablesStack.length)+"%"},PivotView.prototype.getCurrentTableData=function(){return this.tablesStack[this.tablesStack.length-1]},PivotView.prototype.pushTable=function(t){var n,r=this,i=document.createElement("div");i.className="tableContainer",this.tablesStack.length&&(this.tablesStack[this.tablesStack.length-1].FIXED_COLUMN_SIZES=this.FIXED_COLUMN_SIZES,this.tablesStack[this.tablesStack.length-1].savedSearch=this.savedSearch,this.tablesStack[this.tablesStack.length-1].selectedRows=this.selectedRows,this.savedSearch={restore:!1,value:"",columnIndex:0},i.style.left="100%"),this.tablesStack.push({element:i,opts:t||{},pagination:n={on:!1,rows:1/0,page:0,pages:0}}),this.FIXED_COLUMN_SIZES=[],this.selectedRows={},this.elements.base.appendChild(i),this.elements.tableContainer=i,this.pagination=n,setTimeout(function(){r._updateTablesPosition()},30)},PivotView.prototype.popTable=function(){var t;if(!(this.tablesStack.length<2)){this.FIXED_COLUMN_SIZES=[],this._updateTablesPosition(1);var r=this.tablesStack.pop();this.pagination=(t=this.tablesStack[this.tablesStack.length-1]).pagination,t.FIXED_COLUMN_SIZES&&(this.FIXED_COLUMN_SIZES=t.FIXED_COLUMN_SIZES),t.savedSearch&&(this.savedSearch=t.savedSearch),t.selectedRows&&(this.selectedRows=t.selectedRows),setTimeout(function(){r.element.parentNode.removeChild(r.element)},this.ANIMATION_TIMEOUT),this.elements.tableContainer=this.tablesStack[this.tablesStack.length-1].element}},PivotView.prototype.saveScrollPosition=function(){var t;this.elements.tableContainer&&(t=this.elements.tableContainer.getElementsByClassName("lpt-tableBlock"))&&(this.savedScroll.x=t[0].scrollLeft,this.savedScroll.y=t[0].scrollTop)},PivotView.prototype.restoreScrollPosition=function(){var t;this.elements.tableContainer&&(t=this.elements.tableContainer.getElementsByClassName("lpt-tableBlock"))&&(t[0].scrollLeft=this.savedScroll.x,t[0].scrollTop=this.savedScroll.y)},PivotView.prototype.dataChanged=function(t){var r=t.rawData.length-t.info.topHeaderRowsNumber;this.controller.CONFIG.pagination&&(this.pagination.on=!0),this.pagination.rows=this.controller.CONFIG.pagination||1/0,this.selectedRows={},this.pagination.page=0,this.pagination.pages=Math.ceil(r/this.pagination.rows),this.pagination.pages<2&&(this.pagination.on=!1),this.renderRawData(t)},PivotView.prototype._columnClickHandler=function(t){this.saveScrollPosition(),this.controller.dataController.sortByColumn(t),this.restoreScrollPosition()},PivotView.prototype._rowClickHandler=function(t,r){var n=!0;if("function"==typeof this.controller.CONFIG.triggers.rowClick){var i=this.controller.getRowsValues([t])[0].slice(this.controller.dataController.getData().info.leftHeaderColumnsNumber);n=this.controller.CONFIG.triggers.rowClick(t,i,r)}!1!==n&&this.controller.tryDrillDown(r.source.path)},PivotView.prototype._pageSwitcherHandler=function(t){this.pagination.page=t,this.saveScrollPosition(),this.renderRawData(this.controller.dataController.getData()),this.restoreScrollPosition()},PivotView.prototype._backClickHandler=function(t){t&&(t.cancelBubble=!0,t.stopPropagation()),this.removeMessage(),this.popTable(),this.controller.popDataSource(),"function"==typeof this.controller.CONFIG.triggers.back&&this.controller.CONFIG.triggers.back.call(this.controller,{level:this.controller.DRILL_LEVEL})},PivotView.prototype._drillThroughClickHandler=function(t){this.controller.tryDrillThrough(),t&&(t.cancelBubble=!0,t.stopPropagation())},PivotView.prototype._getSelectedText=function(){var t="";return typeof window.getSelection<"u"?t=window.getSelection().toString():typeof document.selection<"u"&&"Text"==document.selection.type&&(t=document.selection.createRange().text),t},PivotView.prototype._cellClickHandler=function(t,r,n,i,c){var f,g,s=this.controller.dataController.getData(),l=[],v=!0,E=this.controller.CONFIG.showSummary&&this.controller.CONFIG.attachTotals?1:0;if(!this._getSelectedText()&&("function"!=typeof this.controller.CONFIG.triggers.cellSelected||!1!==this.controller.CONFIG.triggers.cellSelected.call(this.controller,{x:r-s.info.leftHeaderColumnsNumber,y:n-s.info.topHeaderRowsNumber,leftHeaderColumnsNumber:s.info.leftHeaderColumnsNumber,topHeaderRowsNumber:s.info.topHeaderRowsNumber}))){try{f=s.rawData[n][s.info.leftHeaderColumnsNumber-1].source.path,g=s.rawData[s.info.topHeaderRowsNumber-1-E][r].source.path}catch{this.controller.CONFIG.logs&&console.warn("Unable to get filters for cell (%d, %d)",r,n)}f&&l.push(f),g&&l.push(g),this.controller.CONFIG.drillDownTarget?window.location=location.origin+location.pathname+"?DASHBOARD="+encodeURIComponent(this.controller.CONFIG.drillDownTarget)+"&SETTINGS=FILTER:"+encodeURIComponent(l.join("~"))+";":("function"==typeof this.controller.CONFIG.triggers.cellDrillThrough&&(v=this.controller.CONFIG.triggers.cellDrillThrough({event:i,filters:l,cellData:t,x:r,y:n},s)),"function"==typeof c&&(v=!(!1===c({event:i,filters:l,cellData:t,x:r,y:n},s)||!1===v)),!1!==v&&this.controller.tryDrillThrough(l))}},PivotView.prototype.copyToClipboard=function(t){var r=document.createElement("input");document.body.appendChild(r),r.setAttribute("value",t),document.body.appendChild(r),r.select();var n=!1;try{n=document.execCommand("copy")}catch(i){console.log("Copy error: "+i)}return document.body.removeChild(r),n},PivotView.prototype.listingClickHandler=function(t,r){if(0===r.info.leftHeaderColumnsNumber){var n=this.controller.CONFIG.triggerEvent||"click",i=this,c=function(x){return document.createElement(x)},s=c("div"),l=r.rawData[0].map(function(x){return x.value+(x.source&&x.source.title?"("+x.source.title+")":"")}),f=r.rawData[t.y].map(function(x){return x.value});s.className="lpt-hoverMessage",s.style.fontSize="12pt",s.style.opacity=0;for(var g,v,N,E,A,B=0;B<l.length;B++)g=c("div"),A=c("span"),v=c("div"),N=c("hr"),(E=c("div")).className="lpt-icon-copy",E.title="Copy",E.style.marginRight="6px",A.className="lpt-messageHead",A.textContent=l[B],v.className="lpt-messageBody",g.style.marginBottom=".3em",""!==f[B]?v.textContent=f[B]:v.innerHTML="&nbsp;",g.appendChild(E),g.appendChild(A),s.appendChild(g),s.appendChild(v),s.appendChild(N),E.addEventListener(n,function(x){return function(W){!1===i.copyToClipboard(x)&&alert("Your browser does not support dynamic content copying."),W.preventDefault(),W.cancelBubble=!0,W.preventBubble=!0}}(f[B]));return this.elements.base.appendChild(s),setTimeout(function(){s&&(s.style.opacity=1)},1),s.addEventListener(this.controller.CONFIG.triggerEvent||"click",function(){i._getSelectedText()||i.removeMessage()}),!1}console.warn("Listing handler called not for a listing!")},PivotView.prototype.displayMessage=function(t,r){this.removeMessage();var n=this,i=document.createElement("div"),c=document.createElement("div"),s=document.createElement("div");i.className="central lpt-hoverMessage",i.style.opacity=0,s.innerHTML=t,c.appendChild(s),i.appendChild(c),this.elements.base.appendChild(i),setTimeout(function(){i&&(i.style.opacity=1)},1),r&&i.addEventListener(this.controller.CONFIG.triggerEvent||"click",function(){n.removeMessage()})},PivotView.prototype.removeMessage=function(){var t,r;if((t=this.elements.base.getElementsByClassName("lpt-hoverMessage")).length)for(r in t)t[r].parentNode&&t[r].parentNode.removeChild(t[r])},PivotView.prototype._matchCondition=function(t,r,n){var i=parseFloat(t);switch(r){case"=":return i==n;case"<>":return i!=n;case">":return i>n;case">=":return i>=n;case"<":return i<n;case"<=":return i<=n;case"IN":return-1!==n.toString().indexOf(i);case"BETWEEN":return i>=n.split(",")[0]&&i<=n.split(",")[1];case"IS NULL":return!i;default:return console.error('Formatting error: unknown format operator "'+r+'"'),!1}},PivotView.prototype.applyConditionalFormatting=function(t,r,n,i){var s,l,f,g,v,N,c=t[""]||[];for(s in c=c.concat(t[r]||[]),2===(v=r.split(",")).length&&(c=c.concat(t[v[0]]||[],t[v[0]+","]||[],t[","+v[1]]||[])),c)if(f=c[s],this._matchCondition(n,f.operator,f.value)){if(f.style&&i.setAttribute("style",(i.getAttribute("style")||"")+f.style),f.icon){for(i.textContent="",g='<div style="overflow: hidden; height: 16px;">',N=parseInt(f.iconCount)||1,l=0;l<N;l++)g+='<img alt="*" style="padding-right:2px; height: 100%;" src="'+f.icon+'"/>';i.innerHTML=g+"</div>"}f.text&&(i.textContent=f.text)}},PivotView.prototype.colorNameToRGB=function(t){var r=function(n,i,c){return{r:n,g:i,b:c}};switch(t){case"red":return r(255,0,0);case"green":return r(0,255,0);case"blue":return r(0,0,255);case"purple":return r(102,0,153);case"salmon":return r(255,140,105);case"white":default:return r(255,255,255);case"black":return r(0,0,0);case"gray":return r(128,128,128)}},PivotView.prototype.selectRow=function(t,r){if(t?this.selectedRows[r]=1:delete this.selectedRows[r],"function"==typeof this.controller.CONFIG.triggers.rowSelect){var n=this.controller.getSelectedRows();this.controller.CONFIG.triggers.rowSelect(n,this.controller.getRowsValues(n))}},PivotView.prototype.recalculateSizes=function(t){var r=t.parentNode;try{var i=this,c=this.controller.CONFIG.triggerEvent||"click";if(!t.getElementsByClassName("lpt-headerValue")[0])return;var l=t.getElementsByClassName("lpt-header")[0],f=t.getElementsByClassName("lpt-topHeader")[0],g=t.getElementsByTagName("table")[0],v=g.offsetWidth,N=f.getElementsByTagName("thead")[0],E=t.getElementsByClassName("lpt-leftHeader")[0],A=E.getElementsByTagName("thead")[0],B=t.getElementsByClassName("lpt-tableBlock")[0],x=B.getElementsByTagName("table")[0],W=B.getElementsByTagName("tbody")[0],J=t.getElementsByClassName("lpt-searchInput")[0],X=J?t.offsetWidth-this.SEARCHBOX_LEFT_MARGIN:0,z=B.getElementsByTagName("tr")[0],te=t.getElementsByClassName("lpt-pageSwitcher")[0];N.childNodes[0]&&N.childNodes[0].lastChild._extraCell&&N.childNodes[0].removeChild(N.childNodes[0].lastChild),A.lastChild&&A.lastChild._extraTr&&A.removeChild(A.lastChild);var j=(te?this.PAGINATION_BLOCK_HEIGHT:0)+(this.SEARCH_ENABLED?this.PAGINATION_BLOCK_HEIGHT:0),Y=Math.max(E.offsetWidth,l.offsetWidth),h=f.offsetHeight;f.style.marginLeft=Y+"px";var u=t.offsetHeight,C=u-h-j,D=l.offsetWidth,I=0===A.offsetHeight,O=Math.max(A.offsetHeight,W.offsetHeight)>C&&this.SCROLLBAR_WIDTH>0,d=N.offsetWidth>f.offsetWidth-(O?this.SCROLLBAR_WIDTH:0);!O&&d&&(O=Math.max(A.offsetHeight,W.offsetHeight)>C-this.SCROLLBAR_WIDTH&&this.SCROLLBAR_WIDTH>0);var y,M,Q,R=O&&!I,K=[],re=[],q=[],U=!1,se=function(){!i.controller.CONFIG.stretchColumns&&O&&!d||(U=!0,(M=document.createElement("th")).className="lpt-extraCell",M.style.minWidth=i.SCROLLBAR_WIDTH+"px",M.style.width=i.SCROLLBAR_WIDTH+"px",M.rowSpan=N.childNodes.length,M._extraCell=!0,N.childNodes[0].appendChild(M))};if(O&&N.childNodes[0]&&se(),t._primaryColumns)for(Q in t._primaryColumns)K.push(t._primaryColumns[Q].offsetWidth);else console.warn("No _primaryColumns property in container, cell sizes won't be fixed.");if(t._primaryRows&&t._primaryCells){for(Q in t._primaryRows)re.push(t._primaryRows[Q].offsetHeight);for(Q in t._primaryCells)q.push(t._primaryCells[Q].offsetHeight)}else console.warn("No _primaryRows property in container, cell sizes won't be fixed.");var ae=[].slice.call(E.getElementsByTagName("th")).map(function(V){return{el:V.getElementsByTagName("div")[0],height:V.getElementsByTagName("div")[0].offsetHeight}});if(t.parentNode.removeChild(t),f.style.marginLeft=Y+"px",B.style.marginLeft=Y+"px",E.style.height=u-h-j+"px",E.style.width=Y+"px",D>Y&&(E.style.width=D+"px"),B.style.height=u-h-j-1+"px",l.style.height=h+"px",l.style.width=Y+"px",this.controller.CONFIG.stretchColumns||(g.style.width="auto",x.style.width=d?"100%":v+"px"),R&&((M=document.createElement("tr")).appendChild(y=document.createElement("th")),A.appendChild(M),y.__i=0,y.addEventListener(c,function(){y.__i++,y.style.background="#"+Math.max(18-3*y.__i,0).toString(16)+"FF7D7",y.__i>5&&i._()}),M._extraTr=!0,y.colSpan=A.childNodes.length,y.style.height=(this.SCROLLBAR_WIDTH?this.SCROLLBAR_WIDTH+1:0)+"px"),J&&(J.style.width=X+"px"),z)for(Q in z.childNodes)"TD"===z.childNodes[Q].tagName&&(z.childNodes[Q].style.width=K[Q]+"px");t._primaryRows.forEach(function(V,w){t._primaryCells[w].style.height=t._primaryRows[w].style.height=Math.max(re[w]||re[w-1]||22,q[w]||q[w-1]||22)+"px"}),ae.forEach(function(V){V.el.style.height=parseInt(V.height)+"px"}),r.appendChild(t),Math.max(A.offsetHeight,W.offsetHeight)>C&&this.SCROLLBAR_WIDTH>0&&!U&&se()}catch(V){console.error("Error when fixing sizes.","ERROR:",V)}},PivotView.prototype.getUnixDateFromCacheFormat=function(t){function n(N){var A=Date.parse(N);if(!isNaN(A))return A;if(2==N.split("-").length){var B=N.split("-"),x=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"].indexOf(B[0].toLowerCase());if(-1!=x)return Date.parse((x+1).toString()+"/01/"+B[1])}else if(2==N.split(" ").length){if(0===N.split(" ")[1].split(":").length&&(N+=":00"),A=Date.parse(N.replace(/-/g,"/")),!isNaN(A))return A}return 0}if(""===t&&void 0===t||null===t)return null;var i=t.toString();if(4==i.length||-1!=i.indexOf("-")||-1!=i.indexOf(" "))return n(t);if(6==i.length){var c=i.substr(0,4),s=i.substr(4,2);return Date.parse(new Date(parseInt(c),parseInt(s)-1,1))}if(5!=i.length||isNaN(parseInt(i)))return n(t);var l=new Date(1840,11,31),f=i.toString().split(","),g=parseInt(f[0]),v=null;return f.length>1&&(v=parseInt(f[1])),l=function r(N,E){var A=new Date(N);return A.setDate(N.getDate()+E),A}(l,parseInt(g)),v&&l.setSeconds(v),Date.parse(l)},PivotView.prototype.renderRawData=function(t){if(t.rawData&&t.rawData[0]&&t.rawData[0][0]){var V,w,b,H,m,S,T,$,F,r=this,n=t.rawData,i=t.info,c=t.columnProps,s=t.rowProps,l=t.conditionalFormatting?t.conditionalFormatting.colorScale:void 0,f=this.controller.CONFIG.triggerEvent||"click",g=i.SUMMARY_SHOWN&&this.controller.CONFIG.attachTotals?1:0,v=!!this.controller.CONFIG.columnResizing,N=0===i.leftHeaderColumnsNumber,E=N&&this.controller.CONFIG.enableSearch,A=this.controller.CONFIG.enableListingSelect,B=!!this.controller.CONFIG.columnResizeAnimation,x=this.elements.tableContainer,W=document.createElement("div"),J=document.createElement("div"),X=document.createElement("div"),z=document.createElement("div"),te=document.createElement("div"),j=document.createElement("div"),Y=document.createElement("div"),h=document.createElement("table"),u=document.createElement("thead"),C=document.createElement("table"),D=document.createElement("thead"),I=document.createElement("table"),O=document.createElement("tbody"),d=this.pagination.on||N&&this.controller.CONFIG.showListingRowsNumber,R=d?document.createElement("div"):null,y=d?[]:null,M=R?document.createElement("div"):null,K=E?document.createElement("div"):null,re=E?document.createElement("span"):null,q=E?document.createElement("select"):null,Q=E?document.createElement("span"):null,U=E?document.createElement("input"):null,se=E?function(){for(var L=[],_=i.leftHeaderColumnsNumber,G=i.topHeaderRowsNumber-1-g,P=_;P<n[G].length;P++)L.push({value:n[G][P].value,source:n[G][P].source,columnIndex:P});return L}():null,ae={},ne=null,o=[],a=[],p=[];this.SEARCH_ENABLED=E,this.numeral.setup(i.decimalSeparator||".",i.numericGroupSeparator||",",i.numericGroupSize||3);var Z=function(L,_,G){if("string"==typeof L)"%"===L[L.length-1]&&!isNaN(parseFloat(L))||(_.parentNode.className+=" formatLeft"),_.innerHTML=(L||"").replace(/(https?|ftp):\/\/[^\s]+/gi,function(le){return"<a href='"+le+"' target='"+(r.controller.CONFIG.linksTarget||"_blank")+"' onclick='var e=event||window.event;e.stopPropagation();e.cancelBubble=true;'>"+le+"</a>"});else if(N)_.textContent=L;else if("%date%"===G){var P=new Date(r.getUnixDateFromCacheFormat(L));if(isNaN(P.getTime()))return void(_.textContent=L);_.textContent=P.getHours()+P.getMinutes()+P.getSeconds()===0?P.toLocaleDateString():P.toLocaleString()}else _.textContent=G?L&&r.numeral(L).format(G):L?r.numeral(L).format(L%1==0?"#,###":"#,###.##"):L},k=function(L,_){var G=0,P=0,oe=function(ce){ce.cancelBubble=!0,ce.preventDefault(),L.style.width=L.style.minWidth=G-P+ce.pageX+"px",B&&(r.saveScrollPosition(),r.recalculateSizes(x),r.restoreScrollPosition())},le=function(ce){ce.cancelBubble=!0,ce.preventDefault(),L.style.width=L.style.minWidth=(r.FIXED_COLUMN_SIZES[_]=G-P+ce.pageX)+"px",r.saveScrollPosition(),r.recalculateSizes(x),r.restoreScrollPosition(),document.removeEventListener("mousemove",oe),document.removeEventListener("mouseup",le)};L.addEventListener("mousedown",function(ce){(ce.target||ce.srcElement)===L&&(ce.cancelBubble=!0,ce.preventDefault(),G=L.offsetWidth,P=ce.pageX,document.addEventListener("mousemove",oe),document.addEventListener("mouseup",le))})};for(this.removeMessage();x.firstChild;)x.removeChild(x.firstChild);var L,_,G,ie=function(L,_,G,P,oe){var ce,ge,fe,ee,ve,me,le=oe===D;function Ce(ue){for(var pe=ue.checked;ue=ue.parentNode;)if("TR"===ue.tagName){ue.classList[pe?"add":"remove"]("lpt-selectedRow"),r.elements.tableContainer.querySelector(".lpt-tableBlock table").rows[ue.rowIndex].classList[pe?"add":"remove"]("lpt-selectedRow");break}}if(L===_&&A)for(b=G;b<P;b++)fe=document.createElement("tr"),ee=document.createElement("td"),(me=document.createElement("input")).setAttribute("type","checkbox"),me.checked=!!r.selectedRows[b],me.checked&&function(ue){setTimeout(function(){Ce(ue)},1)}(me),ee.setAttribute("style","padding: 0 !important;"),me.addEventListener("click",function(ue){return function(pe){var ye=pe.srcElement||pe.target;pe.preventDefault(),pe.cancelBubble=!0,setTimeout(function(){ye.checked=!ye.checked,r.selectRow.call(r,ye.checked,ue),Ce(ye)},1)}}(b)),ee.appendChild(me),fe.appendChild(ee),a.push(ee),oe.appendChild(fe);else for(b=G;b<P;b++){for(w=L;w<_;w++)ge=!0,(ce=ae.hasOwnProperty(n[b][w].group))&&(w>0&&n[b][w-1].group===n[b][w].group&&(ge=!1,ae[n[b][w].group].element.colSpan=w-ae[n[b][w].group].x+1),b>0&&n[b-1][w].group===n[b][w].group&&(ge=!1,ae[n[b][w].group].element.rowSpan=b-ae[n[b][w].group].y+1),ee=ae[n[b][w].group].element),(!ce||ge)&&(fe||(fe=document.createElement("tr")),fe.appendChild(ee=document.createElement(n[b][w].isCaption?"th":"td")),n[b][w].source&&n[b][w].source.title&&ee.setAttribute("title",n[b][w].source.title),ve=document.createElement("div"),n[b][w].value?ve.textContent=n[b][w].value:ve.innerHTML="&nbsp;",ee.appendChild(ve),n[b][w].style&&ee.setAttribute("style",n[b][w].style),0===i.leftHeaderColumnsNumber&&r.controller.CONFIG.listingColumnMinWidth&&(ee.style.minWidth=r.controller.CONFIG.listingColumnMinWidth+"px"),i.leftHeaderColumnsNumber>0&&r.controller.CONFIG.maxHeaderWidth&&(ee.style.maxWidth=r.controller.CONFIG.maxHeaderWidth+"px",ee.style.whiteSpace="normal",ee.style.wordWrap="normal"),n[b][w].className&&(ee.className=n[b][w].className),n[b][w].group&&(ae[n[b][w].group]={x:w,y:b,element:ee}),n[b][w].isCaption||Z(n[b][w].value,ee,s[b].format||c[w].format)),le&&w===_-1&&(a.push(ee),ee.addEventListener(f,function(ue,pe){return function(){r._rowClickHandler.call(r,ue,pe)}}(b,n[b][w]))),!le&&b===P-1-g&&!ee._hasSortingListener&&(ee._hasSortingListener=!1,n[b][w].noClick||ee.addEventListener(f,function(ue){return function(){r._columnClickHandler.call(r,ue)}}(w-i.leftHeaderColumnsNumber)),ee.className=(ee.className||"")+" lpt-clickable"),!le&&b===P-1&&(r.FIXED_COLUMN_SIZES[w]&&(ee.style.minWidth=ee.style.width=r.FIXED_COLUMN_SIZES[w]+"px"),v&&(k(ee,w),ee.className+=" lpt-resizableColumn"),o.push(ee));fe&&oe.appendChild(fe),fe=null}};for(te.textContent="",n[0][0].style&&!N&&te.setAttribute("style",n[0][0].style),this.tablesStack.length>1&&!this.controller.CONFIG.hideButtons&&(te.className+="back ",te.addEventListener(f,function(L){r._backClickHandler.call(r,L)})),i.leftHeaderColumnsNumber>0&&r.controller.CONFIG.maxHeaderWidth&&(X.style.maxWidth=r.controller.CONFIG.maxHeaderWidth*i.leftHeaderColumnsNumber+"px",X.style.whiteSpace="normal",X.style.wordWrap="normal"),(this.controller.CONFIG.hideButtons||this.tablesStack.length<2)&&0===i.leftHeaderColumnsNumber&&(te.style.display="none"),ie(i.leftHeaderColumnsNumber,n[0].length,0,i.topHeaderRowsNumber,u),ie(0,i.leftHeaderColumnsNumber,T=i.topHeaderRowsNumber+(this.pagination.page*this.pagination.rows||0),$=this.pagination.on?Math.min(T+this.pagination.rows,n.length):n.length,D),b=T;b<$;b++){for(ne=document.createElement("tr"),w=i.leftHeaderColumnsNumber;w<n[0].length;w++)S=this.controller.getPivotProperty(["cellStyle"])||"",ne.appendChild(H=document.createElement("td")),H.appendChild(F=document.createElement("div")),w===i.leftHeaderColumnsNumber&&p.push(H),Z(n[b][w].value,F,s[b]&&s[b].format||c[w].format),l&&!(i.SUMMARY_SHOWN&&n.length-1===b)&&(m=(parseFloat(n[b][w].value)-l.min)/l.diff,S+="background:rgb("+ +Math.round((l.to.r-l.from.r)*m+l.from.r)+","+Math.round((l.to.g-l.from.g)*m+l.from.g)+","+Math.round((l.to.b-l.from.b)*m+l.from.b)+");"+(l.invert?"color: white;":"")),(c[w].style||s[b]&&s[b].style)&&(S+=(s[b]&&s[b].style||"")+(s[b]&&s[b].style?" ":"")+(c[w].style||"")),n[b][w].style&&(S+=n[b][w].style),this.controller.CONFIG.conditionalFormattingOn&&!(i.SUMMARY_SHOWN&&n.length-1===b)&&!this.getCurrentTableData().opts.disableConditionalFormatting&&this.applyConditionalFormatting(t.conditionalFormatting,b-i.topHeaderRowsNumber+1+","+(w-i.leftHeaderColumnsNumber+1),n[b][w].value,H),S&&H.setAttribute("style",(H.getAttribute("style")||"")+S),H.addEventListener(f,function(L,_,G){return function(P){r._cellClickHandler.call(r,G,L,_,P,i.drillThroughHandler)}}(w,b,n[b][w]));O.appendChild(ne)}if(Y.addEventListener("scroll",function(){Y._ISE?Y._ISE=!1:(z.scrollLeft=Y.scrollLeft,j.scrollTop=Y.scrollTop,z._ISE=!0,j._ISE=!0)}),j.className="lpt-leftHeader",z.className="lpt-topHeader",this.controller.CONFIG.enableHeadersScrolling&&(j.className=j.className+" lpt-scrollable-y",z.className=z.className+" lpt-scrollable-x",j.addEventListener("scroll",function(){j._ISE?j._ISE=!1:(Y.scrollTop=j.scrollTop,Y._ISE=!0)}),z.addEventListener("scroll",function(){z._ISE?z._ISE=!1:(Y.scrollLeft=z.scrollLeft,Y._ISE=!0)})),Y.className="lpt-tableBlock",X.className="lpt-header",W.className="lpt-topSection",J.className="lpt-bottomSection",te.className+="lpt-headerValue",I.appendChild(O),Y.appendChild(I),C.appendChild(D),j.appendChild(C),h.appendChild(u),z.appendChild(h),X.appendChild(te),W.appendChild(X),W.appendChild(z),J.appendChild(j),J.appendChild(Y),x.appendChild(W),x.appendChild(J),this.controller.CONFIG.stretchColumns||(h.style.width="auto"),R){for(V in R.className="lpt-pageSwitcher",y=function(_,G){for(var P=0,oe=[_];_>1;)_=Math.max(1,_-(P||1)),oe.unshift(_),P=P*P+1;for(P=0,_=oe[oe.length-1];_<G;)_=Math.min(G,_+(P||1)),oe.push(_),P=P*P+1;return oe}(this.pagination.page+1,this.pagination.pages),this.controller.CONFIG.showListingRowsNumber&&(H=document.createElement("div"),(ne=document.createElement("span")).className="lpt-icon-rows",H.className="lpt-bottomInfo",H.appendChild(ne),(ne=document.createElement("span")).textContent=t.rawData.length-(t.info.topHeaderRowsNumber||0)-(t.info.SUMMARY_SHOWN?1:0),H.appendChild(ne),M.appendChild(H)),y)V=parseInt(V),H=document.createElement("span"),y[V]===this.pagination.page+1&&(H.className="lpt-active"),H.textContent=y[V],function(L){H.addEventListener(f,function(){r._pageSwitcherHandler.call(r,L-1)})}(y[V]),M.appendChild(H),y[V+1]&&y[V]+1!==y[V+1]&&((H=document.createElement("span")).className="lpt-pageSpacer",M.appendChild(H));R.appendChild(M),x.appendChild(R)}if(E){for(V in re.className="lpt-searchIcon",Q.className="lpt-searchSelectOuter",K.className="lpt-searchBlock",U.className="lpt-searchInput",q.className="lpt-searchSelect",se)(H=document.createElement("option")).setAttribute("value",se[V].columnIndex.toString()),H.textContent=se[V].value,q.appendChild(H);U.addEventListener("input",function(){var L=parseInt(q.options[q.selectedIndex].value),_=U.value;r.saveScrollPosition(),r.savedSearch.value=_,r.savedSearch.columnIndex=L,r.savedSearch.restore=!0,r.controller.dataController.filterByValue(_,L),r.restoreScrollPosition()}),K.appendChild(re),Q.appendChild(q),K.appendChild(Q),K.appendChild(U),x.insertBefore(K,W),this.elements.searchInput=U,this.elements.searchSelect=q,this.savedSearch.restore&&(this.elements.searchInput.value=this.savedSearch.value,this.elements.searchSelect.value=this.savedSearch.columnIndex)}else this.elements.searchInput=void 0,this.elements.searchSelect=void 0;x._primaryColumns=o,x._primaryRows=a,x._primaryCells=p,x._listing=N,this.recalculateSizes(x),this.savedSearch.restore&&(this.elements.searchInput.focus(),L=this.elements.searchInput,_=this.savedSearch.value.length,L.createTextRange?((G=L.createTextRange()).move("character",_),G.select()):L.setSelectionRange(_,_)),"function"==typeof this.controller.CONFIG.triggers.contentRendered&&this.controller.CONFIG.triggers.contentRendered(this.controller)}else this.displayMessage("<h1>"+pivotLocale.get(1)+"</h1><p>"+JSON.stringify(t)+"</p>")},LightPivotTable}();