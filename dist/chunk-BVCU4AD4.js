import{a as st}from"./chunk-RU73HBGW.js";import{a as Pt}from"./chunk-23TAPEHU.js";import{a as We,c as Oe,d as Le,f as Be}from"./chunk-UGEHMGZQ.js";import{a as Re}from"./chunk-NHWJ6QQD.js";import{c as Ve,d as Ut,f as wt,h as qt}from"./chunk-GOV7BL6D.js";import{a as Et}from"./chunk-G3W4DD55.js";import{a as Ft}from"./chunk-MDOQS4TE.js";import{a as De}from"./chunk-G7BOERRR.js";import{a as it}from"./chunk-R3LMLSL5.js";import{a as pt,b as ze}from"./chunk-CF2VGD6U.js";import{c as Te,d as $e,e as ke,f as Me,g as Pe,h as Fe,j as Ee}from"./chunk-HYAUW6N4.js";import{D as $t,E as kt,F as J,G as Ie,H as Se,I as dt,J as ct,K as ft,L as Mt,d as jt,e as ve,k as ye,u as ht}from"./chunk-GDT23CSW.js";import{$b as _e,Aa as Lt,Bb as Ce,Ca as gt,Cb as b,Da as Bt,Db as Ht,Ea as q,Eb as G,F as he,Fb as R,Gb as V,Hb as h,Ib as m,Jb as y,Kc as U,Mb as be,Nb as x,R as de,Rb as f,S as Vt,Sb as d,Tb as At,Ub as Xt,Vb as j,X as St,Xb as Q,Y as ce,Ya as ge,Yb as K,Zb as Z,_b as xe,ab as a,ac as at,ba as D,bb as _,bc as C,cc as k,dc as Tt,ec as Nt,f as It,fa as L,fb as ot,fc as Yt,ga as pe,gc as Gt,ha as me,ib as ue,jb as fe,lb as we,lc as B,pa as mt,qa as c,qc as S,ra as p,rb as F,rc as T,s as oe,xb as $,y as le,yb as ut,z as ae,za as Y,zb as E}from"./chunk-ZEAAPN4P.js";import{a as et,b as Rt}from"./chunk-MG3ERZGY.js";var Xe=["*"];function ai(r,s){if(r&1&&y(0,"div",0),r&2){let t=s.$index,e=d();$("ngStyle",e.gridRenderer.getGridColumnStyle(t))}}function hi(r,s){if(r&1&&y(0,"div",1),r&2){let t=s.$index,e=d();$("ngStyle",e.gridRenderer.getGridRowStyle(t))}}function di(r,s){if(r&1){let t=x();h(0,"div",8),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}function ci(r,s){if(r&1){let t=x();h(0,"div",9),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}function pi(r,s){if(r&1){let t=x();h(0,"div",10),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}function mi(r,s){if(r&1){let t=x();h(0,"div",11),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}function gi(r,s){if(r&1){let t=x();h(0,"div",12),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}function ui(r,s){if(r&1){let t=x();h(0,"div",13),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}function fi(r,s){if(r&1){let t=x();h(0,"div",14),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}function wi(r,s){if(r&1){let t=x();h(0,"div",15),f("mousedown",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))})("touchstart",function(i){c(t);let n=d();return p(n.resize.dragStartDelay(i))}),m()}}var v=function(r){return r.Fit="fit",r.ScrollVertical="scrollVertical",r.ScrollHorizontal="scrollHorizontal",r.Fixed="fixed",r.VerticalFixed="verticalFixed",r.HorizontalFixed="horizontalFixed",r}(v||{}),zt=function(r){return r.Always="always",r.OnDragAndResize="onDrag&Resize",r.None="none",r}(zt||{}),M=function(r){return r.None="none",r.CompactUp="compactUp",r.CompactLeft="compactLeft",r.CompactUpAndLeft="compactUp&Left",r.CompactLeftAndUp="compactLeft&Up",r.CompactRight="compactRight",r.CompactUpAndRight="compactUp&Right",r.CompactRightAndUp="compactRight&Up",r.CompactDown="compactDown",r.CompactDownAndLeft="compactDown&Left",r.CompactLeftAndDown="compactLeft&Down",r.CompactDownAndRight="compactDown&Right",r.CompactRightAndDown="compactRight&Down",r}(M||{}),W=function(r){return r.LTR="ltr",r.RTL="rtl",r}(W||{}),Qt=class{constructor(s){this.gridster=s}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==M.None&&(this.gridster.$options.compactType===M.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===M.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===M.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===M.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===M.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===M.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===M.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===M.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===M.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===M.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===M.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===M.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(s){this.gridster.$options.compactType!==M.None&&(this.gridster.$options.compactType===M.CompactUp?this.moveTillCollision(s,"y",-1):this.gridster.$options.compactType===M.CompactLeft?this.moveTillCollision(s,"x",-1):this.gridster.$options.compactType===M.CompactUpAndLeft?(this.moveTillCollision(s,"y",-1),this.moveTillCollision(s,"x",-1)):this.gridster.$options.compactType===M.CompactLeftAndUp?(this.moveTillCollision(s,"x",-1),this.moveTillCollision(s,"y",-1)):this.gridster.$options.compactType===M.CompactUpAndRight?(this.moveTillCollision(s,"y",-1),this.moveTillCollision(s,"x",1)):this.gridster.$options.compactType===M.CompactDown?this.moveTillCollision(s,"y",1):this.gridster.$options.compactType===M.CompactDownAndLeft?(this.moveTillCollision(s,"y",1),this.moveTillCollision(s,"x",-1)):this.gridster.$options.compactType===M.CompactLeftAndDown?(this.moveTillCollision(s,"x",-1),this.moveTillCollision(s,"y",1)):this.gridster.$options.compactType===M.CompactDownAndRight?(this.moveTillCollision(s,"y",1),this.moveTillCollision(s,"x",1)):this.gridster.$options.compactType===M.CompactRightAndDown&&(this.moveTillCollision(s,"x",1),this.moveTillCollision(s,"y",1)))}checkCompactMovement(s,t){let e=!1;this.gridster.grid.forEach(i=>{i.$item.compactEnabled!==!1&&this.moveTillCollision(i.$item,s,t)&&(e=!0,i.item[s]=i.$item[s],i.itemChanged())}),e&&this.checkCompact()}moveTillCollision(s,t,e){return s[t]+=e,this.gridster.checkCollision(s)?(s[t]-=e,!1):(this.moveTillCollision(s,t,e),!0)}},Ci={gridType:v.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:M.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:zt.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:W.LTR},O=class r{static merge(s,t,e){for(let i in t)t[i]!==void 0&&e.hasOwnProperty(i)&&(typeof t[i]=="object"?(i in s||(s[i]={}),s[i]=r.merge(s[i],t[i],e[i])):s[i]=t[i]);return s}static checkTouchEvent(s){s.clientX===void 0&&s.touches&&(s.touches&&s.touches.length?(s.clientX=s.touches[0].clientX,s.clientY=s.touches[0].clientY):s.changedTouches&&s.changedTouches.length&&(s.clientX=s.changedTouches[0].clientX,s.clientY=s.changedTouches[0].clientY))}static checkContentClassForEvent(s,t){if(s.$options.draggable.ignoreContent){if(!r.checkDragHandleClass(t.target,t.currentTarget,s.$options.draggable.dragHandleClass,s.$options.draggable.ignoreContentClass))return!0}else if(r.checkContentClass(t.target,t.currentTarget,s.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(s,t){return r.checkContentClass(t.target,t.currentTarget,s.$options.draggable.ignoreContentClass)||r.checkContentClass(t.target,t.currentTarget,s.$options.draggable.dragHandleClass)}static checkDragHandleClass(s,t,e,i){if(!s||s===t)return!1;if(s.hasAttribute("class")){let n=s.getAttribute("class").split(" ");if(n.indexOf(e)>-1)return!0;if(n.indexOf(i)>-1)return!1}return r.checkDragHandleClass(s.parentNode,t,e,i)}static checkContentClass(s,t,e){return!s||s===t?!1:s.hasAttribute("class")&&s.getAttribute("class").split(" ").indexOf(e)>-1?!0:r.checkContentClass(s.parentNode,t,e)}static compareItems(s,t){return s.y>t.y?-1:s.y<t.y?1:s.x>t.x?-1:1}},Kt=class{constructor(s){this.gridster=s,this.emptyCellClickCb=t=>{if(!this.gridster||this.gridster.movingItem||O.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,e),this.gridster.cdRef.markForCheck())},this.emptyCellContextMenuCb=t=>{if(this.gridster.movingItem||O.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,e),this.gridster.cdRef.markForCheck())},this.emptyCellDragDrop=t=>{let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,e),this.gridster.cdRef.markForCheck())},this.emptyCellDragOver=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=e):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()},this.emptyCellMouseDown=t=>{if(O.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);!e||t.buttons!==1&&!(t instanceof TouchEvent)||(this.initialItem=e,this.gridster.movingItem=e,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))},this.emptyCellMouseMove=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e,this.gridster.previewStyle())},this.emptyCellMouseUp=t=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()}}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}getPixelsX(s,t){let e=this.gridster.options.scale;return e?(s.clientX-t.left)/e+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():s.clientX+this.gridster.el.scrollLeft-t.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(s,t){let e=this.gridster.options.scale;return e?(s.clientY-t.top)/e+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():s.clientY+this.gridster.el.scrollTop-t.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(s,t){s.preventDefault(),s.stopPropagation(),O.checkTouchEvent(s);let e=this.gridster.el.getBoundingClientRect(),i=this.getPixelsX(s,e),n=this.getPixelsY(s,e),o={x:this.gridster.pixelsToPositionX(i,Math.floor,!0),y:this.gridster.pixelsToPositionY(n,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(t&&(o.cols=Math.min(Math.abs(t.x-o.x)+1,this.gridster.$options.emptyCellDragMaxCols),o.rows=Math.min(Math.abs(t.y-o.y)+1,this.gridster.$options.emptyCellDragMaxRows),t.x<o.x?o.x=t.x:t.x-o.x>this.gridster.$options.emptyCellDragMaxCols-1&&(o.x=this.gridster.movingItem?this.gridster.movingItem.x:0),t.y<o.y?o.y=t.y:t.y-o.y>this.gridster.$options.emptyCellDragMaxRows-1&&(o.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),!(!this.gridster.$options.enableOccupiedCellDrop&&this.gridster.checkCollision(o)))return o}},Zt=class{constructor(s){this.gridster=s,this.lastGridColumnStyles={},this.lastGridRowStyles={}}destroy(){this.gridster=null}updateItem(s,t,e){if(this.gridster.mobile)this.clearCellPosition(e,s),this.gridster.$options.keepFixedHeightInMobile?e.setStyle(s,"height",(t.rows-1)*this.gridster.$options.margin+t.rows*this.gridster.$options.fixedRowHeight+"px"):e.setStyle(s,"height",t.rows*this.gridster.curWidth/t.cols+"px"),this.gridster.$options.keepFixedWidthInMobile?e.setStyle(s,"width",this.gridster.$options.fixedColWidth+"px"):e.setStyle(s,"width",""),e.setStyle(s,"margin-bottom",this.gridster.$options.margin+"px"),e.setStyle(s,W.LTR?"margin-right":"margin-left","");else{let i=Math.round(this.gridster.curColWidth*t.x),n=Math.round(this.gridster.curRowHeight*t.y),o=this.gridster.curColWidth*t.cols-this.gridster.$options.margin,l=this.gridster.curRowHeight*t.rows-this.gridster.$options.margin;this.setCellPosition(e,s,i,n),e.setStyle(s,"width",o+"px"),e.setStyle(s,"height",l+"px");let g=null,u=null;this.gridster.$options.outerMargin&&(this.gridster.rows===t.rows+t.y&&(this.gridster.$options.outerMarginBottom!==null?g=this.gridster.$options.outerMarginBottom+"px":g=this.gridster.$options.margin+"px"),this.gridster.columns===t.cols+t.x&&(this.gridster.$options.outerMarginBottom!==null?u=this.gridster.$options.outerMarginRight+"px":u=this.gridster.$options.margin+"px")),e.setStyle(s,"margin-bottom",g),e.setStyle(s,W.LTR?"margin-right":"margin-left",u)}}updateGridster(){let s="",t="",e="",i="";if(this.gridster.$options.gridType===v.Fit)s=v.Fit,t=v.ScrollVertical,e=v.ScrollHorizontal,i=v.Fixed;else if(this.gridster.$options.gridType===v.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,s=v.ScrollVertical,t=v.Fit,e=v.ScrollHorizontal,i=v.Fixed;else if(this.gridster.$options.gridType===v.ScrollHorizontal){let n=this.gridster.$options.rowHeightRatio,o=n>=1?n:n+1;this.gridster.curColWidth=this.gridster.curRowHeight*o,s=v.ScrollHorizontal,t=v.Fit,e=v.ScrollVertical,i=v.Fixed}else this.gridster.$options.gridType===v.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),s=v.Fixed,t=v.Fit,e=v.ScrollVertical,i=v.ScrollHorizontal):this.gridster.$options.gridType===v.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),s=v.ScrollVertical,t=v.Fit,e=v.ScrollHorizontal,i=v.Fixed):this.gridster.$options.gridType===v.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),s=v.ScrollHorizontal,t=v.Fit,e=v.ScrollVertical,i=v.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==v.Fit?this.gridster.renderer.removeClass(this.gridster.el,s):this.gridster.renderer.addClass(this.gridster.el,s),this.gridster.renderer.removeClass(this.gridster.el,t),this.gridster.renderer.removeClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,i)}getGridColumnStyle(s){let t={left:this.gridster.curColWidth*s,width:this.gridster.curColWidth-this.gridster.$options.margin,height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};t.style=Rt(et({},this.getLeftPosition(t.left)),{width:t.width+"px",height:t.height+"px"});let e=this.lastGridColumnStyles[s];return e&&e.left===t.left&&e.width===t.width&&e.height===t.height?e.style:(this.lastGridColumnStyles[s]=t,t.style)}getGridRowStyle(s){let t={top:this.gridster.curRowHeight*s,width:this.gridster.gridColumns.length*this.gridster.curColWidth+this.gridster.$options.margin,height:this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};t.style=Rt(et({},this.getTopPosition(t.top)),{width:t.width+"px",height:t.height+"px"});let e=this.lastGridRowStyles[s];return e&&e.top===t.top&&e.width===t.width&&e.height===t.height?e.style:(this.lastGridRowStyles[s]=t,t.style)}getLeftPosition(s){let t=this.gridster.$options.dirType===W.RTL?-s:s;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+t+"px)"}:{left:this.getLeftMargin()+t+"px"}}getTopPosition(s){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+s+"px)"}:{top:this.getTopMargin()+s+"px"}}clearCellPosition(s,t){this.gridster.$options.useTransformPositioning?s.setStyle(t,"transform",""):(s.setStyle(t,"top",""),s.setStyle(t,"left",""))}setCellPosition(s,t,e,i){let n=this.gridster.$options.dirType===W.RTL?-e:e;if(this.gridster.$options.useTransformPositioning){let o="translate3d("+n+"px, "+i+"px, 0)";s.setStyle(t,"transform",o)}else s.setStyle(t,"left",this.getLeftMargin()+n+"px"),s.setStyle(t,"top",this.getTopMargin()+i+"px")}getLeftMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginLeft!==null?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginTop!==null?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}},bi=(()=>{class r{constructor(t,e){this.renderer=e,this.el=t.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(t=>this.previewStyle(t))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}previewStyle(t){t?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,t,this.renderer)):this.renderer.setStyle(this.el,"display","")}static{this.\u0275fac=function(e){return new(e||r)(_(q),_(ot))}}static{this.\u0275cmp=L({type:r,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},standalone:!0,features:[B],decls:0,vars:0,template:function(e,i){},styles:[`gridster-preview{position:absolute;display:none;background:#00000026}
`],encapsulation:2})}}return r})(),se=(()=>{class r{constructor(t,e,i,n){this.renderer=e,this.cdRef=i,this.zone=n,this.columns=0,this.rows=0,this.gridColumns=[],this.gridRows=[],this.previewStyle$=new Y,this.calculateLayout$=new It,this.resize$=new It,this.destroy$=new It,this.optionsChanged=()=>{this.setOptions();let o=this.grid.length-1,l;for(;o>=0;o--)l=this.grid[o],l.updateOptions();this.calculateLayout()},this.onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())},this.getNextPossiblePosition=(o,l={})=>{o.cols===-1&&(o.cols=this.$options.defaultItemCols),o.rows===-1&&(o.rows=this.$options.defaultItemRows),this.setGridDimensions();let g=l.y||0,u;for(;g<this.rows;g++)for(o.y=g,u=l.x||0;u<this.columns;u++)if(o.x=u,!this.checkCollision(o))return!0;let w=this.$options.maxRows>=this.rows+o.rows,I=this.$options.maxCols>=this.columns+o.cols;return!(this.rows<=this.columns&&w)&&I?(o.x=this.columns,o.y=0,!0):w?(o.y=this.rows,o.x=0,!0):!1},this.getFirstPossiblePosition=o=>{let l=Object.assign({},o);return this.getNextPossiblePosition(l),l},this.getLastPossiblePosition=o=>{let l={y:0,x:0};l=this.grid.reduce((u,w)=>{let I={y:w.$item.y+w.$item.rows-1,x:w.$item.x+w.$item.cols-1};return O.compareItems(u,I)===1?I:u},l);let g=Object.assign({},o);return this.getNextPossiblePosition(g,l),g},this.el=t.nativeElement,this.$options=JSON.parse(JSON.stringify(Ci)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new Kt(this),this.compact=new Qt(this),this.gridRenderer=new Zt(this)}static checkCollisionTwoItemsForSwaping(t,e){let i=t.cols===1?0:1,n=e.cols===1?0:1,o=t.rows===1?0:1,l=e.rows===1?0:1;return t.x+i<e.x+e.cols&&t.x+t.cols>e.x+n&&t.y+o<e.y+e.rows&&t.y+t.rows>e.y+l}checkCollisionTwoItems(t,e){if(!(t.x<e.x+e.cols&&t.x+t.cols>e.x&&t.y<e.y+e.rows&&t.y+t.rows>e.y))return!1;if(!this.$options.allowMultiLayer)return!0;let n=this.$options.defaultLayerIndex,o=t.layerIndex===void 0?n:t.layerIndex,l=e.layerIndex===void 0?n:e.layerIndex;return o===l}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe(he(0),Vt(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe(de(()=>ae(100)),Vt(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(t){t.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:e=>this.getItemComponent(e)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let t,e;this.$options.gridType==="fit"&&!this.mobile?(e=this.el.offsetWidth,t=this.el.offsetHeight):(e=this.el.clientWidth,t=this.el.clientHeight),(e!==this.curWidth||t!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=O.merge(this.$options,this.options,this.$options),!this.$options.disableWindowResize&&!this.windowResize?this.windowResize=this.renderer.listen("window","resize",this.onResize):this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null),this.emptyCell.updateOptions()}ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}checkIfToResize(){let t=this.el.clientWidth,e=this.el.offsetWidth,i=this.el.scrollWidth,n=this.el.clientHeight,o=this.el.offsetHeight,l=this.el.scrollHeight,g=t<e&&l>o&&l-o<e-t,u=n<o&&i>e&&i-e<o-n;return g?!1:!u}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){let t=this.el,e,i;this.$options.setGridSize||this.$options.gridType===v.Fit&&!this.mobile?(e=t.offsetWidth,i=t.offsetHeight):(e=t.clientWidth,i=t.clientHeight),this.curWidth=e,this.curHeight=i}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let t=this.$options.minRows,e=this.$options.minCols,i=this.grid.length-1,n;for(;i>=0;i--)n=this.grid[i],n.notPlaced||(t=Math.max(t,n.$item.y+n.$item.rows),e=Math.max(e,n.$item.x+n.$item.cols));t+=this.$options.addEmptyRowsCount,(this.columns!==e||this.rows!==t)&&(this.columns=e,this.rows=t,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let i=-this.$options.margin;this.$options.outerMarginLeft!==null?(i+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(i+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),this.$options.outerMarginRight!==null?(i+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(i+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-i)/this.columns;let n=-this.$options.margin;this.$options.outerMarginTop!==null?(n+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),this.$options.outerMarginBottom!==null?(n+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-n)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let t=this.grid.length-1,e;for(;t>=0;t--)e=this.grid[t],e.setSize(),e.drag.toggle(),e.resize.toggle();this.resize$.next()}updateGrid(){this.$options.displayGrid==="always"&&!this.mobile?this.renderer.addClass(this.el,"display-grid"):this.$options.displayGrid==="onDrag&Resize"&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):(this.$options.displayGrid==="none"||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=r.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=r.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(t){t.$item.cols===void 0&&(t.$item.cols=this.$options.defaultItemCols,t.item.cols=t.$item.cols,t.itemChanged()),t.$item.rows===void 0&&(t.$item.rows=this.$options.defaultItemRows,t.item.rows=t.$item.rows,t.itemChanged()),t.$item.x===-1||t.$item.y===-1?this.autoPositionItem(t):this.checkCollision(t.$item)&&(this.$options.disableWarnings||(t.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(t.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?t.notPlaced=!0:this.autoPositionItem(t)),this.grid.push(t),this.calculateLayout$.next()}removeItem(t){this.grid.splice(this.grid.indexOf(t),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(t.item,t)}checkCollision(t){let e=!1;if(this.options.itemValidateCallback&&(e=!this.options.itemValidateCallback(t)),!e&&this.checkGridCollision(t)&&(e=!0),!e){let i=this.findItemWithItem(t);i&&(e=i)}return e}checkGridCollision(t){let e=t.y>-1&&t.x>-1,i=t.cols+t.x<=this.$options.maxCols,n=t.rows+t.y<=this.$options.maxRows,o=t.maxItemCols===void 0?this.$options.maxItemCols:t.maxItemCols,l=t.minItemCols===void 0?this.$options.minItemCols:t.minItemCols,g=t.maxItemRows===void 0?this.$options.maxItemRows:t.maxItemRows,u=t.minItemRows===void 0?this.$options.minItemRows:t.minItemRows,w=t.cols<=o&&t.cols>=l,I=t.rows<=g&&t.rows>=u,z=t.minItemArea===void 0?this.$options.minItemArea:t.minItemArea,A=t.maxItemArea===void 0?this.$options.maxItemArea:t.maxItemArea,P=t.cols*t.rows,N=z<=P,rt=A>=P;return!(e&&i&&n&&w&&I&&N&&rt)}findItemWithItem(t){let e=0,i;for(;e<this.grid.length;e++)if(i=this.grid[e],i.$item!==t&&this.checkCollisionTwoItems(i.$item,t))return i;return!1}findItemsWithItem(t){let e=[],i=0,n;for(;i<this.grid.length;i++)n=this.grid[i],n.$item!==t&&this.checkCollisionTwoItems(n.$item,t)&&e.push(n);return e}autoPositionItem(t){this.getNextPossiblePosition(t.$item)?(t.notPlaced=!1,t.item.x=t.$item.x,t.item.y=t.$item.y,t.itemChanged()):(t.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(t.item,["cols","rows","x","y"])))}pixelsToPositionX(t,e,i){let n=e(t/this.curColWidth);return i?n:Math.max(n,0)}pixelsToPositionY(t,e,i){let n=e(t/this.curRowHeight);return i?n:Math.max(n,0)}positionXToPixels(t){return t*this.curColWidth}positionYToPixels(t){return t*this.curRowHeight}getItemComponent(t){return this.grid.find(e=>e.item===t)}checkCollisionForSwaping(t){let e=!1;if(this.options.itemValidateCallback&&(e=!this.options.itemValidateCallback(t)),!e&&this.checkGridCollision(t)&&(e=!0),!e){let i=this.findItemWithItemForSwapping(t);i&&(e=i)}return e}findItemWithItemForSwapping(t){let e=this.grid.length-1,i;for(;e>-1;e--)if(i=this.grid[e],i.$item!==t&&r.checkCollisionTwoItemsForSwaping(i.$item,t))return i;return!1}previewStyle(t=!1){this.movingItem?(this.compact&&t&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(t,e,i){let n=Math.max(t,Math.floor(e/i));return n<0?0:Number.isFinite(n)?Math.floor(n):0}static{this.\u0275fac=function(e){return new(e||r)(_(q),_(ot),_(U),_(Lt))}}static{this.\u0275cmp=L({type:r,selectors:[["gridster"]],inputs:{options:"options"},standalone:!0,features:[mt,B],ngContentSelectors:Xe,decls:6,vars:2,consts:[[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"]],template:function(e,i){e&1&&(At(),R(0,ai,1,1,"div",0,Ht),R(2,hi,1,1,"div",1,Ht),Xt(4),y(5,"gridster-preview",2)),e&2&&(V(i.gridColumns),a(2),V(i.gridRows),a(3),$("gridRenderer",i.gridRenderer)("previewStyle$",i.previewStyle$))},dependencies:[ve,bi],styles:[`gridster{position:relative;box-sizing:border-box;background:gray;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}
`],encapsulation:2})}}return r})(),Dt=class{constructor(s){this.iteration=0,this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=s,this.gridster=s.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(s,t){if(this.gridster.$options.pushItems&&!t){this.pushedItemsOrder=[],this.iteration=0;let e=this.push(this.gridsterItem,s);return e||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],e}else return!1}restoreTempItems(){let s=this.pushedItemsTemp.length-1;for(;s>-1;s--)this.removeFromTempPushed(this.pushedItemsTemp[s])}restoreItems(){let s=0,t=this.pushedItems.length,e;for(;s<t;s++)e=this.pushedItems[s],e.$item.x=e.item.x||0,e.$item.y=e.item.y||0,e.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let s=0,t=this.pushedItems.length,e;for(;s<t;s++)e=this.pushedItems[s],e.checkItemChanges(e.$item,e.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let s=this.pushedItems.length-1,t=!1;for(;s>-1;s--)this.checkPushedItem(this.pushedItems[s],s)&&(t=!0);t&&this.checkPushBack()}push(s,t){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(s.$item)||t==="")return!1;let e=this.gridster.findItemsWithItem(s.$item),i=t===this.fromNorth||t===this.fromWest;e.sort((u,w)=>i?w.$item.y-u.$item.y||w.$item.x-u.$item.x:u.$item.y-w.$item.y||u.$item.x-w.$item.x);let n=0,o,l=!0,g=[];for(;n<e.length;n++){if(o=e[n],o===this.gridsterItem)continue;if(!o.canBeDragged()){l=!1;break}let u=this.pushedItemsTemp.indexOf(o);if(u>-1&&this.pushedItemsTempPath[u].length>10){l=!1;break}if(this.tryPattern[t][0].call(this,o,s))this.pushedItemsOrder.push(o),g.push(o);else if(this.tryPattern[t][1].call(this,o,s))this.pushedItemsOrder.push(o),g.push(o);else if(this.tryPattern[t][2].call(this,o,s))this.pushedItemsOrder.push(o),g.push(o);else if(this.tryPattern[t][3].call(this,o,s))this.pushedItemsOrder.push(o),g.push(o);else{l=!1;break}}if(!l&&(n=this.pushedItemsOrder.lastIndexOf(g[0]),n>-1)){let u=this.pushedItemsOrder.length-1;for(;u>=n;u--)o=this.pushedItemsOrder[u],this.pushedItemsOrder.pop(),this.removeFromTempPushed(o),this.removeFromPushedItem(o)}return this.iteration++,l}trySouth(s,t){return this.gridster.$options.pushDirections.south?(this.addToTempPushed(s),s.$item.y=t.$item.y+t.$item.rows,this.push(s,this.fromNorth)?(s.setSize(),this.addToPushed(s),!0):(this.removeFromTempPushed(s),!1)):!1}tryNorth(s,t){return this.gridster.$options.pushDirections.north?(this.addToTempPushed(s),s.$item.y=t.$item.y-s.$item.rows,this.push(s,this.fromSouth)?(s.setSize(),this.addToPushed(s),!0):(this.removeFromTempPushed(s),!1)):!1}tryEast(s,t){return this.gridster.$options.pushDirections.east?(this.addToTempPushed(s),s.$item.x=t.$item.x+t.$item.cols,this.push(s,this.fromWest)?(s.setSize(),this.addToPushed(s),!0):(this.removeFromTempPushed(s),!1)):!1}tryWest(s,t){return this.gridster.$options.pushDirections.west?(this.addToTempPushed(s),s.$item.x=t.$item.x-s.$item.cols,this.push(s,this.fromEast)?(s.setSize(),this.addToPushed(s),!0):(this.removeFromTempPushed(s),!1)):!1}addToTempPushed(s){let t=this.pushedItemsTemp.indexOf(s);t===-1&&(t=this.pushedItemsTemp.push(s)-1,this.pushedItemsTempPath[t]=[]),this.pushedItemsTempPath[t].push({x:s.$item.x,y:s.$item.y})}removeFromTempPushed(s){let t=this.pushedItemsTemp.indexOf(s),e=this.pushedItemsTempPath[t].pop();e&&(s.$item.x=e.x,s.$item.y=e.y,s.setSize(),this.pushedItemsTempPath[t].length||(this.pushedItemsTemp.splice(t,1),this.pushedItemsTempPath.splice(t,1)))}addToPushed(s){if(this.pushedItems.indexOf(s)<0)this.pushedItems.push(s),this.pushedItemsPath.push([{x:s.item.x||0,y:s.item.y||0},{x:s.$item.x,y:s.$item.y}]);else{let t=this.pushedItems.indexOf(s);this.pushedItemsPath[t].push({x:s.$item.x,y:s.$item.y})}}removeFromPushed(s){s>-1&&(this.pushedItems.splice(s,1),this.pushedItemsPath.splice(s,1))}removeFromPushedItem(s){let t=this.pushedItems.indexOf(s);t>-1&&(this.pushedItemsPath[t].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1)))}checkPushedItem(s,t){let e=this.pushedItemsPath[t],i=e.length-2,n,o,l,g=!1;for(;i>-1;i--)n=e[i],o=s.$item.x,l=s.$item.y,s.$item.x=n.x,s.$item.y=n.y,this.gridster.findItemWithItem(s.$item)?(s.$item.x=o,s.$item.y=l):(s.setSize(),e.splice(i+1,e.length-i-1),g=!0);return e.length<2&&this.removeFromPushed(t),g}},Ct,lt,Ne=50,X,bt,tt,xt,_t,vt,yt;function Ye(r,s,t,e,i,n,o,l,g,u){Ct=r.$options.scrollSensitivity,lt=r.$options.scrollSpeed,X=r.el,bt=g,tt=u;let w=X.offsetWidth,I=X.offsetHeight,z=X.scrollLeft,A=X.scrollTop,P=t-A,N=I+A-t-i,{clientX:rt,clientY:Ot}=n;if(!r.$options.disableScrollVertical)if(o.clientY<Ot&&N<Ct){if(Qe(),bt&&tt&&!tt.south||yt)return;yt=He(1,l,o)}else if(o.clientY>Ot&&A>0&&P<Ct){if(qe(),bt&&tt&&!tt.north||vt)return;vt=He(-1,l,o)}else o.clientY!==Ot&&re();let oi=z+w-s-e,li=s-z;if(!r.$options.disableScrollHorizontal)if(o.clientX<rt&&oi<=Ct){if(Ue(),bt&&tt&&!tt.east||xt)return;xt=Ae(1,l,o)}else if(o.clientX>rt&&z>0&&li<Ct){if(je(),bt&&tt&&!tt.west||_t)return;_t=Ae(-1,l,o)}else o.clientX!==rt&&ne()}function He(r,s,t){let e=t.clientY;return window.setInterval(()=>{(!X||r===-1&&X.scrollTop-lt<0)&&re(),X.scrollTop+=r*lt,e+=r*lt,s({clientX:t.clientX,clientY:e})},Ne)}function Ae(r,s,t){let e=t.clientX;return window.setInterval(()=>{(!X||r===-1&&X.scrollLeft-lt<0)&&ne(),X.scrollLeft+=r*lt,e+=r*lt,s({clientX:e,clientY:t.clientY})},Ne)}function Ge(){ne(),re(),X=null}function ne(){je(),Ue()}function re(){Qe(),qe()}function je(){xt&&(clearInterval(xt),xt=0)}function Ue(){_t&&(clearInterval(_t),_t=0)}function qe(){yt&&(clearInterval(yt),yt=0)}function Qe(){vt&&(clearInterval(vt),vt=0)}var Jt=class{constructor(s){this.gridsterItem=s,this.gridster=s.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){let s=this.swapedItem.$item.x,t=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=s,this.swapedItem.$item.y=t):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(s){let t;if(this.gridster.$options.swapWhileDragging?t=this.gridster.checkCollisionForSwaping(s.$item):t=this.gridster.checkCollision(s.$item),t&&t!==!0&&t.canBeDragged()){let e=t,i=e.$item.x,n=e.$item.y,o=s.$item.x,l=s.$item.y,g=o-i,u=l-n;e.$item.x=s.item.x-g,e.$item.y=s.item.y-u,s.$item.x=e.item.x+g,s.$item.y=e.item.y+u,this.gridster.checkCollision(e.$item)||this.gridster.checkCollision(s.$item)?(s.$item.x=o,s.$item.y=l,e.$item.x=i,e.$item.y=n):(e.setSize(),this.swapedItem=e,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}},xi="gridster-item-resizable-handler",H=function(r){return r.UP="UP",r.DOWN="DOWN",r.LEFT="LEFT",r.RIGHT="RIGHT",r}(H||{}),te=class{constructor(s,t,e){this.zone=e,this.collision=!1,this.dragMove=i=>{i.stopPropagation(),i.preventDefault(),O.checkTouchEvent(i);let n=this.getDirections(i);this.gridster.options.enableBoundaryControl&&(n.includes(H.UP)&&this.gridsterItem.el.getBoundingClientRect().top<this.gridster.el.getBoundingClientRect().top+(this.outerMarginTop??this.margin)&&(n=n.filter(o=>o!=H.UP),i=new MouseEvent(i.type,{clientX:i.clientX,clientY:this.lastMouse.clientY})),n.includes(H.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<this.gridster.el.getBoundingClientRect().left+(this.outerMarginLeft??this.margin)&&(n=n.filter(o=>o!=H.LEFT),i=new MouseEvent(i.type,{clientX:this.lastMouse.clientX,clientY:i.clientY})),n.includes(H.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>this.gridster.el.getBoundingClientRect().right-(this.outerMarginRight??this.margin)&&(n=n.filter(o=>o!=H.RIGHT),i=new MouseEvent(i.type,{clientX:this.lastMouse.clientX,clientY:i.clientY})),n.includes(H.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>this.gridster.el.getBoundingClientRect().bottom-(this.outerMarginBottom??this.margin)&&(n=n.filter(o=>o!=H.DOWN),i=new MouseEvent(i.type,{clientX:i.clientX,clientY:this.lastMouse.clientY}))),n.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,Ye(this.gridster,this.left,this.top,this.width,this.height,i,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(i))},this.calculateItemPositionFromMousePosition=i=>{this.gridster.options.scale?this.calculateItemPositionWithScale(i,this.gridster.options.scale):this.calculateItemPositionWithoutScale(i),this.calculateItemPosition(),this.lastMouse.clientX=i.clientX,this.lastMouse.clientY=i.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=i=>{i.stopPropagation(),i.preventDefault(),Ge(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,i)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})},this.cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&this.collision!==!0&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.dragStartDelay=i=>{if(i.target.classList.contains(xi)||O.checkContentClassForEvent(this.gridster,i))return;if(O.checkTouchEvent(i),!this.gridster.$options.draggable.delayStart){this.dragStart(i);return}let o=setTimeout(()=>{this.dragStart(i),P()},this.gridster.$options.draggable.delayStart),l=this.gridsterItem.renderer.listen("document","mouseup",P),g=this.gridsterItem.renderer.listen("document","mouseleave",P),u=this.gridsterItem.renderer.listen("window","blur",P),w=this.gridsterItem.renderer.listen("document","touchmove",A),I=this.gridsterItem.renderer.listen("document","touchend",P),z=this.gridsterItem.renderer.listen("document","touchcancel",P);function A(N){O.checkTouchEvent(N),(Math.abs(N.clientX-i.clientX)>9||Math.abs(N.clientY-i.clientY)>9)&&P()}function P(){clearTimeout(o),u(),l(),g(),w(),I(),z()}},this.gridsterItem=s,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(s){s.which&&s.which!==1||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,s),s.stopPropagation(),s.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=s.clientX,this.originalClientY=s.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.gridster.$options.dirType===W.RTL?this.diffLeft=s.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:this.diffLeft=s.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=s.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new Dt(this.gridsterItem),this.swap=new Jt(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}calculateItemPositionWithScale(s,t){this.gridster.$options.dirType===W.RTL?this.left=this.gridster.el.scrollWidth-this.originalClientX+(s.clientX-this.originalClientX)/t+this.diffLeft:this.left=this.originalClientX+(s.clientX-this.originalClientX)/t+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(s.clientY-this.originalClientY)/t+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(s){this.gridster.$options.dirType===W.RTL?this.left=this.gridster.el.scrollWidth-s.clientX+this.diffLeft:this.left=s.clientX+this.offsetLeft-this.diffLeft,this.top=s.clientY+this.offsetTop-this.diffTop}calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){let s=this.path[this.path.length-1],t="";s.x<this.gridsterItem.$item.x?t=this.push.fromWest:s.x>this.gridsterItem.$item.x?t=this.push.fromEast:s.y<this.gridsterItem.$item.y?t=this.push.fromNorth:s.y>this.gridsterItem.$item.y&&(t=this.push.fromSouth),this.push.pushItems(t,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&this.collision!==!0&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}else this.collision=!1;this.gridster.previewStyle(!0)}toggle(){let s=this.gridsterItem.canBeDragged();!this.enabled&&s?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!s&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}getDirections(s){let t=[];return this.lastMouse.clientX===0&&this.lastMouse.clientY===0&&(this.lastMouse.clientY=s.clientY,this.lastMouse.clientX=s.clientX),this.lastMouse.clientY>s.clientY&&t.push(H.UP),this.lastMouse.clientY<s.clientY&&t.push(H.DOWN),this.lastMouse.clientX<s.clientX&&t.push(H.RIGHT),this.lastMouse.clientX>s.clientX&&t.push(H.LEFT),t}},ee=class{constructor(s){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=s,this.gridster=s.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(s){return this.gridster.$options.pushResizeItems?this.push(this.gridsterItem,s):!1}restoreItems(){let s=0,t=this.pushedItems.length,e;for(;s<t;s++)e=this.pushedItems[s],e.$item.x=e.item.x||0,e.$item.y=e.item.y||0,e.$item.cols=e.item.cols||1,e.$item.row=e.item.row||1,e.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let s=0,t=this.pushedItems.length,e;for(;s<t;s++)e=this.pushedItems[s],e.checkItemChanges(e.$item,e.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let s=this.pushedItems.length-1,t=!1;for(;s>-1;s--)this.checkPushedItem(this.pushedItems[s],s)&&(t=!0);t&&this.checkPushBack()}push(s,t){let e=this.gridster.checkCollision(s.$item);if(e&&e!==!0&&e!==this.gridsterItem&&e.canBeResized()){if(this.tryPattern[t].call(this,e,s,t))return!0}else if(e===!1)return!0;return!1}trySouth(s,t,e){let i=s.$item.y,n=s.$item.rows;return s.$item.y=t.$item.y+t.$item.rows,s.$item.rows=n+i-s.$item.y,!this.gridster.checkCollisionTwoItems(s.$item,t.$item)&&!this.gridster.checkGridCollision(s.$item)?(s.setSize(),this.addToPushed(s),this.push(t,e),!0):(s.$item.y=i,s.$item.rows=n,!1)}tryNorth(s,t,e){let i=s.$item.rows;return s.$item.rows=t.$item.y-s.$item.y,!this.gridster.checkCollisionTwoItems(s.$item,t.$item)&&!this.gridster.checkGridCollision(s.$item)?(s.setSize(),this.addToPushed(s),this.push(t,e),!0):(s.$item.rows=i,!1)}tryEast(s,t,e){let i=s.$item.x,n=s.$item.cols;return s.$item.x=t.$item.x+t.$item.cols,s.$item.cols=n+i-s.$item.x,!this.gridster.checkCollisionTwoItems(s.$item,t.$item)&&!this.gridster.checkGridCollision(s.$item)?(s.setSize(),this.addToPushed(s),this.push(t,e),!0):(s.$item.x=i,s.$item.cols=n,!1)}tryWest(s,t,e){let i=s.$item.cols;return s.$item.cols=t.$item.x-s.$item.x,!this.gridster.checkCollisionTwoItems(s.$item,t.$item)&&!this.gridster.checkGridCollision(s.$item)?(s.setSize(),this.addToPushed(s),this.push(t,e),!0):(s.$item.cols=i,!1)}addToPushed(s){if(this.pushedItems.indexOf(s)<0)this.pushedItems.push(s),this.pushedItemsPath.push([{x:s.item.x||0,y:s.item.y||0,cols:s.item.cols||0,rows:s.item.rows||0},{x:s.$item.x,y:s.$item.y,cols:s.$item.cols,rows:s.$item.rows}]);else{let t=this.pushedItems.indexOf(s);this.pushedItemsPath[t].push({x:s.$item.x,y:s.$item.y,cols:s.$item.cols,rows:s.$item.rows})}}removeFromPushed(s){s>-1&&(this.pushedItems.splice(s,1),this.pushedItemsPath.splice(s,1))}checkPushedItem(s,t){let e=this.pushedItemsPath[t],i=e.length-2,n,o,l,g,u;for(;i>-1;i--)n=e[i],o=s.$item.x,l=s.$item.y,g=s.$item.cols,u=s.$item.rows,s.$item.x=n.x,s.$item.y=n.y,s.$item.cols=n.cols,s.$item.rows=n.rows,this.gridster.findItemWithItem(s.$item)?(s.$item.x=o,s.$item.y=l,s.$item.cols=g,s.$item.rows=u):(s.setSize(),e.splice(i+1,e.length-1-i));return e.length<2?(this.removeFromPushed(t),!0):!1}},ie=class{constructor(s,t,e){this.zone=e,this.directionFunction=null,this.dragMove=i=>{if(this.directionFunction===null)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");i.stopPropagation(),i.preventDefault(),O.checkTouchEvent(i),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,Ye(this.gridster,this.left,this.top,this.width,this.height,i,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);let n=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(i.clientX-this.originalClientX)/n,clientY:this.originalClientY+(i.clientY-this.originalClientY)/n}),this.lastMouse.clientX=i.clientX,this.lastMouse.clientY=i.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=i=>{i.stopPropagation(),i.preventDefault(),Ge(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,i)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})},this.cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.handleNorth=i=>{this.top=i.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height?(this.height=this.minHeight,this.top=this.bottom-this.minHeight):this.gridster.options.enableBoundaryControl&&(this.top=Math.max(0,this.top),this.height=this.bottom-this.top);let n=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionY(this.top+n,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.top=this.gridster.positionYToPixels(this.gridsterItem.$item.y),this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)},this.handleWest=i=>{let n=this.gridster.$options.dirType===W.RTL?this.originalClientX+(this.originalClientX-i.clientX):i.clientX;this.left=n+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width?(this.width=this.minWidth,this.left=this.right-this.minWidth):this.gridster.options.enableBoundaryControl&&(this.left=Math.max(0,this.left),this.width=this.right-this.left);let o=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionX(this.left+o,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.left=this.gridster.positionXToPixels(this.gridsterItem.$item.x),this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)},this.handleSouth=i=>{if(this.height=i.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.gridster.options.enableBoundaryControl){let o=this.outerMarginBottom??this.margin,l=this.gridster.el.getBoundingClientRect();this.bottom=Math.min(this.bottom,l.bottom-l.top-2*o),this.height=this.bottom-this.top}let n=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionY(this.bottom+n,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.rows=this.itemBackup[3],this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)},this.handleEast=i=>{let n=this.gridster.$options.dirType===W.RTL?this.originalClientX+(this.originalClientX-i.clientX):i.clientX;if(this.width=n+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.gridster.options.enableBoundaryControl){let l=this.outerMarginRight??this.margin,g=this.gridster.el.getBoundingClientRect();this.right=Math.min(this.right,g.right-g.left-2*l),this.width=this.right-this.left}let o=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionX(this.right+o,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.cols=this.itemBackup[2],this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)},this.handleNorthWest=i=>{this.handleNorth(i),this.handleWest(i)},this.handleNorthEast=i=>{this.handleNorth(i),this.handleEast(i)},this.handleSouthWest=i=>{this.handleSouth(i),this.handleWest(i)},this.handleSouthEast=i=>{this.handleSouth(i),this.handleEast(i)},this.gridsterItem=s,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){this.gridster?.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(s){if(s.which&&s.which!==1)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,s),s.stopPropagation(),s.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=s.clientX,this.lastMouse.clientY=s.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=s.clientX,this.originalClientY=s.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=s.clientX+this.offsetLeft-this.left,this.diffRight=s.clientX+this.offsetLeft-this.right,this.diffTop=s.clientY+this.offsetTop-this.top,this.diffBottom=s.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new Dt(this.gridsterItem),this.pushResize=new ee(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();let{classList:t}=s.target;t.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):t.contains("handle-w")?this.gridster.$options.dirType===W.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):t.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):t.contains("handle-e")?this.gridster.$options.dirType===W.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):t.contains("handle-nw")?this.gridster.$options.dirType===W.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):t.contains("handle-ne")?this.gridster.$options.dirType===W.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):t.contains("handle-sw")?this.gridster.$options.dirType===W.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):t.contains("handle-se")&&(this.gridster.$options.dirType===W.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}toggle(){this.resizeEnabled=this.gridsterItem.canBeResized(),this.resizableHandles=this.gridsterItem.getResizableHandles()}dragStartDelay(s){if(O.checkTouchEvent(s),!this.gridster.$options.resizable.delayStart){this.dragStart(s);return}let t=setTimeout(()=>{this.dragStart(s),w()},this.gridster.$options.resizable.delayStart),{cancelMouse:e,cancelMouseLeave:i,cancelOnBlur:n,cancelTouchMove:o,cancelTouchEnd:l,cancelTouchCancel:g}=this.zone.runOutsideAngular(()=>{let I=this.gridsterItem.renderer.listen("document","mouseup",w),z=this.gridsterItem.renderer.listen("document","mouseleave",w),A=this.gridsterItem.renderer.listen("window","blur",w),P=this.gridsterItem.renderer.listen("document","touchmove",u),N=this.gridsterItem.renderer.listen("document","touchend",w),rt=this.gridsterItem.renderer.listen("document","touchcancel",w);return{cancelMouse:I,cancelMouseLeave:z,cancelOnBlur:A,cancelTouchMove:P,cancelTouchEnd:N,cancelTouchCancel:rt}});function u(I){O.checkTouchEvent(I),(Math.abs(I.clientX-s.clientX)>9||Math.abs(I.clientY-s.clientY)>9)&&w()}function w(){clearTimeout(t),n(),e(),i(),o(),l(),g()}}setItemTop(s){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,s)}setItemLeft(s){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,s,this.top)}setItemHeight(s){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",s+"px")}setItemWidth(s){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",s+"px")}},Ke=(()=>{class r{get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}constructor(t,e,i,n){this.renderer=i,this.zone=n,this.itemInit=new Y,this.itemChange=new Y,this.itemResize=new Y,this.el=t.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=e,this.drag=new te(this,e,this.zone),this.resize=new ie(this,e,this.zone)}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(t){t.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),t.item&&t.item.previousValue&&this.setSize()}updateOptions(){this.$item=O.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0,resizableHandles:{s:void 0,e:void 0,n:void 0,w:void 0,se:void 0,ne:void 0,sw:void 0,nw:void 0}})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){let t=this.$item.y*this.gridster.curRowHeight,e=this.$item.x*this.gridster.curColWidth,i=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,n=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=t,this.left=e,!this.init&&i>0&&n>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(i!==this.width||n!==this.height)&&(this.width=i,this.height=n,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(t,e){t.rows===e.rows&&t.cols===e.cols&&t.x===e.x&&t.y===e.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=e.x||0,this.$item.y=e.y||0,this.$item.cols=e.cols||1,this.$item.rows=e.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){let t=this.gridster.$options.draggable.enabled,e=this.$item.dragEnabled===void 0?t:this.$item.dragEnabled;return!this.gridster.mobile&&t&&e}canBeResized(){let t=this.gridster.$options.resizable.enabled,e=this.$item.resizeEnabled===void 0?t:this.$item.resizeEnabled;return!this.gridster.mobile&&t&&e}getResizableHandles(){let t=this.gridster.$options.resizable.handles,e=this.$item.resizableHandles;return e===void 0?t:et(et({},t),e)}bringToFront(t){if(t&&t<=0)return;let e=this.getLayerIndex(),i=this.gridster.$options.maxLayerIndex;if(e<i){let n=t?e+t:i;this.item.layerIndex=this.$item.layerIndex=n>i?i:n}}sendToBack(t){if(t&&t<=0)return;let e=this.getLayerIndex();if(e>0){let i=t?e-t:0;this.item.layerIndex=this.$item.layerIndex=i<0?0:i}}getLayerIndex(){return this.item.layerIndex!==void 0?this.item.layerIndex:this.gridster.$options.defaultLayerIndex!==void 0?this.gridster.$options.defaultLayerIndex:0}static{this.\u0275fac=function(e){return new(e||r)(_(q),_(se),_(ot),_(Lt))}}static{this.\u0275cmp=L({type:r,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(e,i){e&2&&ut("z-index",i.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},standalone:!0,features:[mt,B],ngContentSelectors:Xe,decls:9,vars:8,consts:[[1,"gridster-item-resizable-handler","handle-s"],[1,"gridster-item-resizable-handler","handle-e"],[1,"gridster-item-resizable-handler","handle-n"],[1,"gridster-item-resizable-handler","handle-w"],[1,"gridster-item-resizable-handler","handle-se"],[1,"gridster-item-resizable-handler","handle-ne"],[1,"gridster-item-resizable-handler","handle-sw"],[1,"gridster-item-resizable-handler","handle-nw"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(e,i){e&1&&(At(),Xt(0),F(1,di,1,0,"div",0)(2,ci,1,0,"div",1)(3,pi,1,0,"div",2)(4,mi,1,0,"div",3)(5,gi,1,0,"div",4)(6,ui,1,0,"div",5)(7,fi,1,0,"div",6)(8,wi,1,0,"div",7)),e&2&&(a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.s&&i.resize.resizeEnabled?1:-1),a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.e&&i.resize.resizeEnabled?2:-1),a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.n&&i.resize.resizeEnabled?3:-1),a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.w&&i.resize.resizeEnabled?4:-1),a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.se&&i.resize.resizeEnabled?5:-1),a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.ne&&i.resize.resizeEnabled?6:-1),a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.sw&&i.resize.resizeEnabled?7:-1),a(),b(i.resize.resizableHandles!=null&&i.resize.resizableHandles.nw&&i.resize.resizeEnabled?8:-1))},styles:[`gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:#fff;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}
`],encapsulation:2})}}return r})();var Os=(()=>{class r{static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275mod=pe({type:r})}static{this.\u0275inj=ce({})}}return r})();var Wt=(()=>{class r{constructor(){this.items=[],this.widgets=[]}init(t){if(this.items=[],this.widgets=[],!!t.widgets)for(let e=0;e<t.widgets.length;e++){let i=t.widgets[e];this.widgets.push(i);for(let n=0;n<i.controls.length;n++)i.controls[n].action.toLowerCase()==="applyvariable"&&this.items.push(i.controls[n])}}clear(){this.items=[]}isExists(){return this.items.length!==0}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=St({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var vi=["gridster"],yi=["widgets"],Ze=(()=>{class r{constructor(){this.list=[],this.dbs=D(ze),this.cd=D(U),this.eds=D(Et),this.route=D(ht),this.ss=D(ct),this.ns=D(Mt),this.ds=D(Se),this.sbs=D(De),this.fs=D(it),this.bs=D(pt),this.ms=D(Re),this.r2=D(ot),this.us=D(dt),this.hs=D(Pt),this.vs=D(Wt),this.i18n=D(kt),this.es=D(Ie),this.subOnEditedWidgetChanged=this.eds.onEditedWidgetChanged.pipe(st()),this.subOnNewWidget=this.eds.onNewWidget.pipe(st()),this.subOnSaveWidget=this.eds.onSave.pipe(st()),this.subCancelEditing=this.eds.onCancelEditing.pipe(st()),this.subOnDeleteWidget=this.eds.onDeleteWidget.pipe(st())}ngOnDestroy(){clearTimeout(this.scrollToNewWidgetTimeout)}getWidgetByInfo(t){if(t)return this.widgets.find(e=>e.widget===t)}subscribeForEditing(){this.subOnEditedWidgetChanged.subscribe(t=>this.updateEditedWidget(t)),this.subOnNewWidget.subscribe(t=>this.newWidget(t)),this.subOnSaveWidget.subscribe(()=>this.onSaveWidget()),this.subCancelEditing.subscribe(()=>this.cancelEditing()),this.subOnDeleteWidget.subscribe(t=>this.deleteWidget(t))}updateEditedWidget(t){this.editedWidget||(this.editedWidget=t.widget);let e=this.getWidgetByInfo(this.editedWidget);e&&(e.header?.cd.detectChanges(),e.cd.detectChanges(),t.refreshData&&e.requestData()),this.detectChanges()}newWidget(t){let e=this.dbs.getWidgetsWithoutEmpty().pop();e&&(t.cols=e.cols,t.rows=e.rows),this.editedWidget=t,this.list.push(this.editedWidget);let i=this.gridster.getFirstPossiblePosition(this.editedWidget);this.editedWidget.x=i.x,this.editedWidget.y=i.y,this.editedWidget.cols=i.cols,this.editedWidget.rows=i.rows,this.detectChanges(),this.scrollNewWidgetIntoView()}onSaveWidget(){this.editedWidget&&(this.editedWidget.edKey=""),this.editedWidget=void 0,this.detectChanges()}cancelEditing(){if(!this.editedWidget)return;let t=this.list.indexOf(this.editedWidget);if(this.editedWidget?.oldWidget){this.editedWidget=this.editedWidget.oldWidget,this.editedWidget.edKey="ed"+new Date().getTime(),this.list[t]=this.editedWidget,this.cd.detectChanges(),this.editedWidget.edKey="",this.editedWidget=void 0,this.detectChanges();return}else t!==-1&&this.list.splice(t,1);this.editedWidget=void 0,this.detectChanges()}scrollNewWidgetIntoView(){clearTimeout(this.scrollToNewWidgetTimeout),this.scrollToNewWidgetTimeout=setTimeout(()=>{let t=document.getElementById("edited-widget");t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})},300)}detectChanges(){let t=this.gridster.el.scrollLeft,e=this.gridster.el.scrollTop;this.cd.detectChanges(),this.gridster.onResize(),this.gridster.el.scrollLeft=t,this.gridster.el.scrollTop=e}deleteWidget(t){this.editedWidget=void 0;let e=this.list.indexOf(t);e!==-1&&this.list.splice(e,1),this.list=[...this.list],this.cd.detectChanges()}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=L({type:r,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&(Q(vi,5),Q(yi,5)),e&2){let n;K(n=Z())&&(i.gridster=n.first),K(n=Z())&&(i.widgets=n)}},standalone:!0,features:[B],decls:0,vars:0,template:function(e,i){},encapsulation:2})}}return r})();var Je=(()=>{class r{constructor(t){this.el=t,this.tooltip="",this.tooltipEl=null,this.onHover=e=>this.showTooltip(e),this.onOut=e=>this.removeTooltip()}ngAfterViewInit(){this.el.nativeElement.addEventListener("mouseover",this.onHover),this.el.nativeElement.addEventListener("mouseout",this.onOut)}ngOnDestroy(){this.el.nativeElement.removeEventListener("mouseover",this.onHover),this.el.nativeElement.removeEventListener("mouseout",this.onOut),this.removeTooltip()}showTooltip(t){if(this.tooltipEl||(this.createTooltip(),!this.tooltipEl))return;let e=t.clientX,i=t.clientY,n=this.tooltipEl.offsetWidth,o=this.tooltipEl.offsetHeight,l=window.innerWidth,g=window.innerHeight,u=e,w=i;e+n>l&&(u=e-n),i+o>g&&(w=i-o),this.tooltipEl&&(this.tooltipEl.style.left=u+"px",this.tooltipEl.style.top=w+"px")}removeTooltip(){this.tooltipEl&&(this.tooltipEl.parentNode?.removeChild(this.tooltipEl),this.tooltipEl=null)}createTooltip(){this.removeTooltip(),this.tooltipEl=document.createElement("div"),this.tooltipEl.classList.add("dsw-tooltip"),this.tooltipEl.innerHTML=this.tooltip,document.body.appendChild(this.tooltipEl)}static{this.\u0275fac=function(e){return new(e||r)(_(q))}}static{this.\u0275dir=me({type:r,selectors:[["","tooltip",""]],inputs:{tooltip:"tooltip"},standalone:!0})}}return r})();var ti=(()=>{class r{constructor(){this.onToggleHeaderButton=new Y}toggleButton(t){this.onToggleHeaderButton.emit(t)}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=St({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function ki(r,s){if(r&1&&y(0,"img",1),r&2){let t=d();$("tooltip",t.filtersTooltip)}}function Mi(r,s){if(r&1){let t=x();h(0,"button",6),f("click",function(){c(t);let i=d();return p(i.onBackClick())}),y(1,"img",7),h(2,"label"),C(3),S(4,"i18n"),m()()}r&2&&(a(3),k(T(4,1,"back")))}function Pi(r,s){if(r&1){let t=x();h(0,"button",6),f("click",function(){c(t);let i=d();return p(i.onResetClickFilterHandler())}),y(1,"img",8),h(2,"label"),C(3),S(4,"i18n"),m()()}r&2&&(a(3),k(T(4,1,"resetClickFilter")))}function Fi(r,s){if(r&1){let t=x();h(0,"button",9),S(1,"i18n"),f("click",function(){c(t);let i=d();return p(i.onClick("by6columns"))}),y(2,"img",10),m(),h(3,"button",9),S(4,"i18n"),f("click",function(){c(t);let i=d();return p(i.onClick("by5columns"))}),y(5,"img",11),m(),h(6,"button",9),S(7,"i18n"),f("click",function(){c(t);let i=d();return p(i.onClick("by4columns"))}),y(8,"img",12),m(),h(9,"button",9),S(10,"i18n"),f("click",function(){c(t);let i=d();return p(i.onClick("by3columns"))}),y(11,"img",13),m(),h(12,"button",9),S(13,"i18n"),f("click",function(){c(t);let i=d();return p(i.onClick("by2columns"))}),y(14,"img",14),m(),h(15,"button",9),S(16,"i18n"),f("click",function(){c(t);let i=d();return p(i.onClick("byRows"))}),y(17,"img",15),m(),h(18,"button",16),S(19,"i18n"),f("click",function(){c(t);let i=d();return p(i.onClick("setDefault"))}),y(20,"img",17),h(21,"label"),C(22),S(23,"i18n"),m()(),h(24,"button",18),f("click",function(){c(t);let i=d();return p(i.closeMobileFilter())}),y(25,"img",8),h(26,"label"),C(27),S(28,"i18n"),m()()}if(r&2){let t=d();E("active",t.widget.viewSize===5),$("title",T(1,21,"by6columns")),a(3),E("active",t.widget.viewSize===4),$("title",T(4,23,"by5columns")),a(3),E("active",t.widget.viewSize===3),$("title",T(7,25,"by4columns")),a(3),E("active",t.widget.viewSize===2),$("title",T(10,27,"by3columns")),a(3),E("active",t.widget.viewSize===1),$("title",T(13,29,"by2columns")),a(3),E("active",t.widget.viewSize===0),$("title",T(16,31,"byRows")),a(3),$("title",T(19,33,"setDefault")),a(4),k(T(23,35,"refresh")),a(5),k(T(28,37,"close"))}}function Ei(r,s){if(r&1){let t=x();h(0,"button",19),f("click",function(){c(t);let i=d();return p(i.deleteWidgetClick())}),y(1,"img",20),h(2,"label"),C(3,"Delete widget"),m()()}}function Di(r,s){if(r&1){let t=x();h(0,"button",16),f("click",function(){let i=c(t).$implicit,n=d(2);return p(n.onClick(i.id))}),y(1,"img",24),h(2,"label"),C(3),m()()}if(r&2){let t=s.$implicit,e=d(2);E("active",e.widget[t.id]),$("title",t.tooltip),a(),$("src",t.icon,ge),a(2),k(t.text)}}function zi(r,s){if(r&1){let t=x();h(0,"button",16),S(1,"i18n"),f("click",function(){c(t);let i=d(2);return p(i.onClick("isLegend"))}),y(2,"img",25),h(3,"label"),C(4,"Legend"),m()()}if(r&2){let t=d(2);E("active",t.widget.isLegend),j("title",T(1,3,"showLegend"))}}function Wi(r,s){if(r&1){let t=x();h(0,"button",16),S(1,"i18n"),f("click",function(){c(t);let i=d(2);return p(i.onClick("showValues"))}),y(2,"img",26),h(3,"label"),C(4,"Values"),m()()}if(r&2){let t=d(2);E("active",t.widget.showValues),j("title",T(1,3,"showValues"))}}function Oi(r,s){if(r&1){let t=x();h(0,"button",16),S(1,"i18n"),f("click",function(){c(t);let i=d(2);return p(i.onClick("isTop"))}),y(2,"img",27),h(3,"label"),C(4,"Top"),m()()}if(r&2){let t=d(2);E("active",t.widget.isTop),j("title",T(1,3,"showTop"))}}function Ri(r,s){if(r&1){let t=x();h(0,"button",16),S(1,"i18n"),f("click",function(){c(t);let i=d(2);return p(i.onClick("showZero"))}),y(2,"img",28),h(3,"label"),C(4,"Zero"),m()()}if(r&2){let t=d(2);E("active",t.widget.showZero),j("title",T(1,3,"showZero"))}}function Vi(r,s){if(r&1){let t=x();h(0,"button",16),S(1,"i18n"),f("click",function(){c(t);let i=d(2);return p(i.onClick("displayAsPivot"))}),y(2,"img",29),h(3,"label"),C(4,"Pivot"),m()()}if(r&2){let t=d(2);E("active",t.widget.type==="pivot"),j("title",T(1,3,"showPivot"))}}function Li(r,s){if(r&1){let t=x();h(0,"button",16),S(1,"i18n"),f("click",function(){c(t);let i=d(2);return p(i.onClick("chartConfig"))}),y(2,"img",30),h(3,"label"),C(4,"Colors"),m()()}r&2&&j("title",T(1,1,"changeColors"))}function Bi(r,s){if(r&1){let t=x();h(0,"button",31),S(1,"i18n"),f("click",function(){c(t);let i=d(2);return p(i.onClick("expand"))}),y(2,"img",32),m()}if(r&2){let t=d(2);E("active",t.widget.isExpanded),$("title",T(1,4,"fullscreen"))("hidden",t.isEmptyWidget()||!t.widget.isSupported)}}function Hi(r,s){if(r&1&&(R(0,Di,4,5,"button",21,G),F(2,zi,5,5,"button",21)(3,Wi,5,5,"button",21)(4,Oi,5,5,"button",21)(5,Ri,5,5,"button",21)(6,Vi,5,5,"button",21)(7,Li,5,3,"button",22)(8,Bi,3,6,"button",23)),r&2){let t=d();V(t.typeDesc==null?null:t.typeDesc.headerButtons),a(2),b(!(t.typeDesc!=null&&t.typeDesc.disableLegend)&&t.widget.isChart&&!t.widget.noToggleLegend?2:-1),a(),b(t.widget.isBtnValues?3:-1),a(),b(t.widget.isChart?4:-1),a(),b(t.widget.isBtnZero?5:-1),a(),b(t.widget.isChart||t.widget.isMap||t.widget.type==="regular"||t.widget.oldType==="regular"?6:-1),a(),b(t.widget.isChart||t.widget.type==="regular"?7:-1),a(),b(t.widget.shared?-1:8)}}var ii=(()=>{class r{constructor(t,e,i,n,o,l,g,u,w){this.ss=t,this.us=e,this.ws=i,this.cd=n,this.ns=o,this.fs=l,this.hs=g,this.eds=u,this.route=w,this.onButtonClick=new Y,this.onBack=new Y,this.onResetClickFilter=new Y,this.hasFilters=!1,this.filtersTooltip="",this.noDrag=!1,this.noDrag=this.route.snapshot.queryParamMap.get("nodrag")==="1"}ngOnInit(){this.subFiltersChanged=this.fs.onFiltersChanged.subscribe(()=>{this.updateActiveFiltersInfo(),this.cd.detectChanges()}),this.updateActiveFiltersInfo()}updateActiveFiltersInfo(){if(!this.widget||this.widget.type===J.const.emptyWidgetClass)return;let t=this.fs.getWidgetFilters(this.widget?.name).filter(e=>e.value!==""||e.isInterval);this.hasFilters=!!t.length,this.filtersTooltip=t.map(e=>e.label+': <span style="opacity: 0.7">'+e.valueDisplay+"</span>").join(`
`)}onClick(t){this.widget[t]=!this.widget[t];let e=this.ss.getWidgetsSettings(this.widget.dashboard);e[this.widget.name]||(e[this.widget.name]={}),e[this.widget.name][t]=this.widget[t],this.ss.setWidgetsSettings(e,this.widget.dashboard),this.onButtonClick.emit({widget:this.widget,name:t,state:this.widget[t]})}loadToolbarButton(t,e,i){if(this.us.isEmbedded()){let n=this.route.snapshot.queryParamMap.get(e);if(n){let o=!1;n.toLowerCase()==="true"?o=!0:n.toLowerCase()==="false"&&(o=!1),this.widget[e]=o;return}}t[this.widget.name]&&(t[this.widget.name][e]!==void 0?this.widget[e]=this.widgetsSettings[this.widget.name][e]:i!==void 0&&(this.widget[e]=i))}onBackClick(){this.onBack.emit()}onResetClickFilterHandler(){this.onResetClickFilter.emit()}isEmptyWidget(){if(!this.widget)return!1;let t=this.widget.type;return t===We||t==="horizontalControls"||t==="verticalControls"}closeMobileFilter(){this.hs.toggleMobileFilterDialog()}ngOnChanges(t){t.widget?.currentValue&&t.widget.currentValue!==t.widget.previousValue&&this.loadButtons()}ngOnDestroy(){this.subFiltersChanged?.unsubscribe()}onHeaderDoubleClick(){this.isEmptyWidget()||!this.widget.isSupported||this.onClick("expand")}deleteWidgetClick(){this.eds.deleteWidget(this.widget)}loadButtons(){this.widgetsSettings=this.ss.getWidgetsSettings(this.widget.dashboard)||{},this.loadToolbarButton(this.widgetsSettings,"isLegend"),this.loadToolbarButton(this.widgetsSettings,"isTop"),this.loadToolbarButton(this.widgetsSettings,"showZero"),this.loadToolbarButton(this.widgetsSettings,"showValues");let t=this.typeDesc?.headerButtons;if(t)for(let e=0;e<t.length;e++)this.loadToolbarButton(this.widgetsSettings,t[e].id,t[e].defValue)}static{this.\u0275fac=function(e){return new(e||r)(_(ct),_(dt),_(ti),_(U),_(Mt),_(it),_(Pt),_(Et),_(ht))}}static{this.\u0275cmp=L({type:r,selectors:[["dsw-widget-header"]],inputs:{typeDesc:"typeDesc",widget:"widget"},outputs:{onButtonClick:"onButtonClick",onBack:"onBack",onResetClickFilter:"onResetClickFilter"},standalone:!0,features:[mt,B],decls:10,vars:11,consts:[[1,"title-text"],["src","assets/img/icons/icon-filter.svg",1,"btn-filters",3,"tooltip"],[1,"btn-with-text"],[1,"divider"],[1,"drag-handle",3,"dblclick"],["title","Delete widget"],[1,"btn-with-text",3,"click"],["src","assets/img/icons/chevron_left-black-18dp.svg"],["src","assets/img/icons/close-black-18dp.svg"],[1,"only-desktop",3,"click","title"],["src","assets/img/icons/view-6columns.svg"],["src","assets/img/icons/view-5columns.svg"],["src","assets/img/icons/view-4columns.svg"],["src","assets/img/icons/view-3columns.svg"],["src","assets/img/icons/view-2columns.svg"],["src","assets/img/icons/view-list.svg"],[3,"click","title"],["src","assets/img/icons/reset.svg"],[1,"only-sm",3,"click"],["title","Delete widget",3,"click"],["src","assets/img/icons/icon-close.svg"],[3,"active","title"],[3,"title"],[1,"only-desktop",3,"active","title","hidden"],[3,"src"],["src","assets/img/icons/legend-toggle.svg"],["src","assets/img/icons/format-list-numbered.svg"],["src","assets/img/icons/top-records.svg"],["src","assets/img/icons/exposure-zero.svg"],["src","assets/img/icons/table.svg"],["src","assets/img/icons/palette-icon.svg"],[1,"only-desktop",3,"click","title","hidden"],["src","assets/img/icons/full-screen.svg"]],template:function(e,i){e&1&&(h(0,"span",0),C(1),F(2,ki,1,1,"img",1),m(),F(3,Mi,5,3,"button",2)(4,Pi,5,3,"button",2),y(5,"div",3),h(6,"div",4),f("dblclick",function(){return i.onHeaderDoubleClick()}),m(),F(7,Fi,29,39)(8,Ei,4,0,"button",5)(9,Hi,9,7)),e&2&&(a(),Tt(" ",i.widget.title," "),a(),b(i.hasFilters?2:-1),a(),b(i.widget.backButton?3:-1),a(),b(i.widget.clickFilterActive?4:-1),a(2),E("no-drag",i.noDrag)("expanded",i.widget.isExpanded),a(),b(i.isEmptyWidget()?7:-1),a(),b(i.widget.edKey||i.widget.oldWidget?8:-1),a(),b(!i.widget.edKey&&!i.widget.oldWidget?9:-1))},dependencies:[Je,$t],styles:["[_ngcontent-%COMP%]:root{--cl-bg: #F5F5F5;--cl-accent: #1A73E8;--cl-btn-hover: #76abf1;--cl-hover: #E8F0FE;--cl-txt: #555555;--input-border-radius: 13px;--cl-btn-main: #5cb85c;--cl-btn-main-txt: #fff;--cl-btn-main-border: #4cae4c;--cl-btn-main-hover: #6eca6e;--cl-btn-secondary: #e6e6e6;--cl-btn-secondary-txt: #cccccc;--cl-btn-secondary-border: #b4b2b2;--cl-btn-secondary-hover: #dbdbdb;--icon-filter: none;--cl1: #b6e6ff;--cl2: #f7bfb7;--cl3: #bceca8;--cl4: #fff9a8;--cl5: #ffc593;--cl6: #f9b1ab;--cl7: #9de7fb;--cl8: #a8b8f9;--cl9: #9df1ae;--cl-header-bg: #FFFFFF;--cl-header-border: #F5F5F5;--cl-header-txt: #606367;--cl-header-ico: var(--cl-header-txt);--cl-header-btn-active: var(--cl-header-bg);--cl-header-btn-hover: var(--cl-bg);--cl-header-btn-hover-darken: var(--cl-hover);--header-height: 64px;--menu-item-icon-filter: none;--cl-sidebar-bg: #F5F5F5;--cl-sidebar-txt: #606367;--tile-border: none;--tile-border-radius: 10px;--tile-header-height: 28px;--cl-modal-bg: white;--fc0: #606367;--fc1: black;--fc2: red;--fc3: white;--fc4: green;--fc5: blue;--cl-widget-bg: white;--cl-widget-header-btn-active: #A9FFA1;--cl-widget-header-border: none;--cl-text-widget-font: #6b6464;--cl-widget-header-bg: var(--cl-header-bg);--cl-widget-header-txt: var(--cl-header-txt);--cl-widget-filter-txt: #606367;--cl-widget-filter-bg: var(--cl-header-bg);--widget-header-btn-opacity: 1;--widget-header-btn-filter: none;--widget-header-btn-active-filter: contrast(.7) sepia(1) brightness(1) hue-rotate(-898deg) contrast(9);--cl-input-bg: white;--cl-input-border: #EBEBEA;--cl-check-border: #606367;--cl-input-placeholder: rgba(96, 99, 103, .6);--cl-input-text: #606367;--cl-input-height: 26px;--cl-pivot-cell-border: rgb(208, 208, 208);--cl-pivot-cell-hover: #FFF7D7;--pivot-row-hover: inset 0 0 30px #fff5b9;--sidebar-width: 322px;--cl-scrollbar: #606367}[_nghost-%COMP%]{position:relative;display:flex;z-index:11;flex:0 0 auto;justify-content:space-between;font-family:Oxygen;background:var(--cl-widget-header-bg);height:var(--tile-header-height);padding:0;font-size:8pt;text-align:center;color:var(--cl-widget-header-txt);white-space:nowrap;text-overflow:ellipsis;border-bottom:var(--cl-widget-header-border)}[_nghost-%COMP%] > .drag-handle[_ngcontent-%COMP%]{position:absolute;inset:-20px -20px 0}[_nghost-%COMP%]   button[_ngcontent-%COMP%]{z-index:1;flex:0 0 auto;cursor:pointer;background-color:transparent;border:none;padding-left:4px;padding-right:4px;margin:-3px 0 0;height:22px;display:flex;align-items:center;justify-content:center;transition:background-color .3s line-height;outline:none}[_nghost-%COMP%]   button[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{opacity:var(--widget-header-btn-opacity);filter:var(--widget-header-btn-filter)}[_nghost-%COMP%]   button[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{opacity:var(--widget-header-btn-opacity);filter:var(--widget-header-btn-filter)}[_nghost-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--cl-header-btn-hover-darken)}[_nghost-%COMP%]   button.active[_ngcontent-%COMP%] > img[_ngcontent-%COMP%], [_nghost-%COMP%]   button.active[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{opacity:1;filter:var(--widget-header-btn-active-filter)}[_nghost-%COMP%]   button[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:none}@media (max-width: 576px){[_nghost-%COMP%]   button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:0;flex:1 1 100%}[_nghost-%COMP%]   button[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:inline-block;font-size:13px;opacity:var(--widget-header-btn-opacity);filter:var(--widget-header-btn-filter)}[_nghost-%COMP%]   button[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:calc(var(--header-height) * .5)}}@media (max-width: 576px){[_nghost-%COMP%]{order:3;height:var(--header-height);border-bottom:none;border-top:1px solid var(--cl-header-border)}}.drag-handle[_ngcontent-%COMP%]{cursor:move;flex:1 1 100%;display:flex;justify-content:center;align-items:center}.drag-handle.no-drag[_ngcontent-%COMP%], .drag-handle.expanded[_ngcontent-%COMP%]{cursor:default}button.btn-with-text[_ngcontent-%COMP%]{cursor:pointer;color:var(--cl-widget-header-txt);display:flex;align-items:center}button.btn-with-text[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:100%}button.btn-with-text[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:block;cursor:pointer}@media (max-width: 576px){button.btn-with-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:0;flex:1 1 100%}button.btn-with-text[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:inline-block;font-size:13px;opacity:var(--widget-header-btn-opacity);filter:var(--widget-header-btn-filter)}button.btn-with-text[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:calc(var(--header-height) * .5)}}.title-text[_ngcontent-%COMP%]{pointer-events:none;margin-left:0;margin-right:4px;font-size:14px;font-weight:700;z-index:2}@media (max-width: 576px){.title-text[_ngcontent-%COMP%]{display:none!important}}.divider[_ngcontent-%COMP%]{margin-left:auto}.btn-filters[_ngcontent-%COMP%]{pointer-events:auto;vertical-align:top}"],changeDetection:0})}}return r})();var Ni=["filterPopup"];function Yi(r,s){if(r&1){let t=x();h(0,"span",1)(1,"label"),C(2),m(),h(3,"input",3),Gt("ngModelChange",function(i){let n=c(t).$implicit;return Yt(n.value,i)||(n.value=i),p(i)}),f("keydown.enter",function(){let i=c(t).$implicit,n=d();return p(n.emitVarChange(i))}),m()()}if(r&2){let t=s.$implicit;a(2),k(t.label),a(),Nt("ngModel",t.value)}}function Gi(r,s){if(r&1&&(h(0,"option",7),C(1),m()),r&2){let t=s.$implicit;$("ngValue",t),a(),k(t)}}function ji(r,s){if(r&1){let t=x();h(0,"select",6),Gt("ngModelChange",function(i){c(t);let n=d().$implicit;return Yt(n.dsSelected,i)||(n.dsSelected=i),p(i)}),f("change",function(){c(t);let i=d().$implicit,n=d();return p(n.onDataSourceChangeHandler(i))}),R(1,Gi,2,2,"option",7,G),m()}if(r&2){let t=d().$implicit;Nt("ngModel",t.dsSelected),a(),V(t.labels)}}function Ui(r,s){if(r&1){let t=x();h(0,"input",8,0),f("keydown.enter",function(){c(t);let i=at(1);return p(i.blur())})("change",function(){c(t);let i=at(1),n=d().$implicit,o=d();return p(o.setControlValue(n,i.value,i))}),m()}if(r&2){let t=d().$implicit;$("type",t.type)("value",t._value)}}function qi(r,s){if(r&1&&(h(0,"span",1)(1,"label"),C(2),m(),F(3,ji,3,1,"select",4)(4,Ui,2,2,"input",5),m()),r&2){let t=s.$implicit;a(2),k(t.label),a(),b(t.field==="select"?3:-1),a(),b(t.field==="input"?4:-1)}}function Qi(r,s){if(r&1){let t=x();h(0,"span",1)(1,"button",9),f("click",function(){let i=c(t).$implicit,n=d();return p(n.performAction(i))}),C(2),m()()}if(r&2){let t=s.$implicit;a(2),k(t.label||t.action)}}function Ki(r,s){if(r&1){let t=x();h(0,"span",1)(1,"label"),C(2),m(),h(3,"input",10),f("click",function(i){let n=c(t).$implicit,o=d();return n.isOpen=!0,p(o.toggleFilter(n.idx,i))}),m()()}if(r&2){let t=s.$implicit,e=d();E("active",e.openedFilter()===t.idx),a(2),k(t.label),a(),j("value",t.text),j("title",t.text)}}var si=(()=>{class r{constructor(t,e,i,n,o,l){this.fs=t,this.ms=e,this.el=i,this.us=n,this.bs=o,this.cd=l,this.widget=Bt.required(),this.filters=Bt([]),this.onVariable=gt(),this.onDataSource=gt(),this.onAction=gt(),this.onFilter=gt(),this.openedFilter=ue(-1),this.filterPopup=fe("filterPopup")}emitVarChange(t){this.onVariable.emit(t)}onDataSourceChangeHandler(t){this.onDataSource.emit(t)}performAction(t){this.onAction.emit(t)}toggleFilter(t,e){let i=this.fs.getFilter(t);if(!i)return;this.openedFilter.set(t);let o=e.target.getBoundingClientRect(),l=o.x-4,g=o.y+o.height+4,u=i.isDate?420:340;l+u>window.innerWidth&&(l=o.x+o.width-u);let w=this.us.isMobile(),I=0;if(w){let z=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--header-height"),10);I=window.document.body.offsetHeight-z-this.el.nativeElement.offsetHeight}this.ms.show({component:import("./chunk-7UG364TP.js"),hideBackdrop:!0,closeByEsc:!0,closeByBackdropClick:!0,buttons:[],noPadding:!0,componentStyles:{position:"absolute",left:l+"px",top:g+"px",height:w?`${I}px`:"auto"},onComponentInit:z=>{z.initialize(this.widget(),i,this.widget().dataSource)},onClose:()=>{this.openedFilter.set(-1),this.cd.detectChanges()}})}setControlValue(t,e,i){let n=parseInt(e,10);isNaN(n)||n===0?(delete t._value,i.value=""):t._value=e,this.bs.broadcast("refresh:"+this.widget().name)}detectChanges(){this.cd.detectChanges()}static{this.\u0275fac=function(e){return new(e||r)(_(it),_(Ft),_(q),_(dt),_(pt),_(U))}}static{this.\u0275cmp=L({type:r,selectors:[["dsw-widget-filter"]],viewQuery:function(e,i){e&1&&xe(i.filterPopup,Ni,5),e&2&&_e()},hostVars:14,hostBindings:function(e,i){e&2&&E("horizontal",i.widget().type==="horizontalControls")("col-1",i.widget().viewSize===0)("col-2",i.widget().viewSize===1)("col-3",i.widget().viewSize===2)("col-4",i.widget().viewSize===3)("col-5",i.widget().viewSize===4)("col-6",i.widget().viewSize===5)},inputs:{widget:[1,"widget"],filters:[1,"filters"]},outputs:{onVariable:"onVariable",onDataSource:"onDataSource",onAction:"onAction",onFilter:"onFilter"},standalone:!0,features:[B],decls:8,vars:0,consts:[["inp",""],[1,"flt-holder"],[1,"flt-holder",3,"active"],[3,"ngModelChange","keydown.enter","ngModel"],[3,"ngModel"],[3,"type","value"],[3,"ngModelChange","change","ngModel"],[3,"ngValue"],[3,"keydown.enter","change","type","value"],[1,"btn-round",3,"click"],["readonly","","type","text",3,"click","value","title"]],template:function(e,i){e&1&&(R(0,Yi,4,2,"span",1,G),R(2,qi,5,3,"span",1,G),R(4,Qi,3,1,"span",1,G),R(6,Ki,4,5,"span",2,G)),e&2&&(V(i.widget().pvItems),a(2),V(i.widget().dsItems),a(2),V(i.widget().acItems),a(2),V(i.filters()))},dependencies:[Ee,Pe,Fe,Te,Me,$e,ke],styles:["[_ngcontent-%COMP%]:root{--cl-bg: #F5F5F5;--cl-accent: #1A73E8;--cl-btn-hover: #76abf1;--cl-hover: #E8F0FE;--cl-txt: #555555;--input-border-radius: 13px;--cl-btn-main: #5cb85c;--cl-btn-main-txt: #fff;--cl-btn-main-border: #4cae4c;--cl-btn-main-hover: #6eca6e;--cl-btn-secondary: #e6e6e6;--cl-btn-secondary-txt: #cccccc;--cl-btn-secondary-border: #b4b2b2;--cl-btn-secondary-hover: #dbdbdb;--icon-filter: none;--cl1: #b6e6ff;--cl2: #f7bfb7;--cl3: #bceca8;--cl4: #fff9a8;--cl5: #ffc593;--cl6: #f9b1ab;--cl7: #9de7fb;--cl8: #a8b8f9;--cl9: #9df1ae;--cl-header-bg: #FFFFFF;--cl-header-border: #F5F5F5;--cl-header-txt: #606367;--cl-header-ico: var(--cl-header-txt);--cl-header-btn-active: var(--cl-header-bg);--cl-header-btn-hover: var(--cl-bg);--cl-header-btn-hover-darken: var(--cl-hover);--header-height: 64px;--menu-item-icon-filter: none;--cl-sidebar-bg: #F5F5F5;--cl-sidebar-txt: #606367;--tile-border: none;--tile-border-radius: 10px;--tile-header-height: 28px;--cl-modal-bg: white;--fc0: #606367;--fc1: black;--fc2: red;--fc3: white;--fc4: green;--fc5: blue;--cl-widget-bg: white;--cl-widget-header-btn-active: #A9FFA1;--cl-widget-header-border: none;--cl-text-widget-font: #6b6464;--cl-widget-header-bg: var(--cl-header-bg);--cl-widget-header-txt: var(--cl-header-txt);--cl-widget-filter-txt: #606367;--cl-widget-filter-bg: var(--cl-header-bg);--widget-header-btn-opacity: 1;--widget-header-btn-filter: none;--widget-header-btn-active-filter: contrast(.7) sepia(1) brightness(1) hue-rotate(-898deg) contrast(9);--cl-input-bg: white;--cl-input-border: #EBEBEA;--cl-check-border: #606367;--cl-input-placeholder: rgba(96, 99, 103, .6);--cl-input-text: #606367;--cl-input-height: 26px;--cl-pivot-cell-border: rgb(208, 208, 208);--cl-pivot-cell-hover: #FFF7D7;--pivot-row-hover: inset 0 0 30px #fff5b9;--sidebar-width: 322px;--cl-scrollbar: #606367}[_nghost-%COMP%]{position:relative;display:flex;flex-shrink:0;background:var(--cl-widget-filter-bg);height:auto;flex-wrap:wrap;margin-bottom:5px}.col-1[_nghost-%COMP%], .col-2[_nghost-%COMP%], .col-3[_nghost-%COMP%], .col-4[_nghost-%COMP%], .col-5[_nghost-%COMP%], .col-6[_nghost-%COMP%]{display:grid;gap:10px}.col-1[_nghost-%COMP%] > span[_ngcontent-%COMP%], .col-2[_nghost-%COMP%] > span[_ngcontent-%COMP%], .col-3[_nghost-%COMP%] > span[_ngcontent-%COMP%], .col-4[_nghost-%COMP%] > span[_ngcontent-%COMP%], .col-5[_nghost-%COMP%] > span[_ngcontent-%COMP%], .col-6[_nghost-%COMP%] > span[_ngcontent-%COMP%]{width:100%;padding:0}.col-1[_nghost-%COMP%]{grid-template-columns:1fr}.col-2[_nghost-%COMP%]{grid-template-columns:1fr 1fr}.col-3[_nghost-%COMP%]{grid-template-columns:1fr 1fr 1fr}.col-4[_nghost-%COMP%]{grid-template-columns:1fr 1fr 1fr 1fr}.col-5[_nghost-%COMP%]{grid-template-columns:1fr 1fr 1fr 1fr 1fr}.col-6[_nghost-%COMP%]{grid-template-columns:1fr 1fr 1fr 1fr 1fr 1fr}.flt-holder[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:hidden;padding:2px 4px}.flt-holder[_ngcontent-%COMP%]:first-child{padding-left:0}.flt-holder[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{font-size:12px;color:var(--cl-widget-filter-txt);margin-bottom:4px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.flt-holder[_ngcontent-%COMP%] > input[_ngcontent-%COMP%], .flt-holder[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]{cursor:pointer;height:26px;padding:0 10px;border:1px solid #EBEBEA;border-radius:13px;box-shadow:none}.flt-holder[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]:focus, .flt-holder[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]:focus{outline:none;outline-offset:-1px}@media (max-width: 576px){.flt-holder[_ngcontent-%COMP%] > input[_ngcontent-%COMP%], .flt-holder[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]{height:34px}}.flt-holder.active[_ngcontent-%COMP%]{background-color:var(--cl-widget-filter-bg)}.flt-holder.active[_ngcontent-%COMP%] > input[_ngcontent-%COMP%], .flt-holder.active[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]{border-color:var(--cl-accent)}@media (max-width: 576px){.flt-holder[_ngcontent-%COMP%]{width:auto!important;flex:1 1 25%!important}}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:row}"],changeDetection:0})}}return r})();var Zi=["header"],Ji=["filters"];function ts(r,s){r&1&&be(0)}function es(r,s){if(r&1&&F(0,ts,1,0,"ng-container",6),r&2){let t=d();$("ngComponentOutlet",t.widgetType.class)("ngComponentOutletInputs",t.widgetInputs)}}function is(r,s){if(r&1&&(h(0,"div",4),C(1),m()),r&2){let t=d();a(),k(t.model.error)}}function ss(r,s){r&1&&(h(0,"div",5),y(1,"img",7),m()),r&2&&$("@fade-in-out",void 0)}var ni=(()=>{class r{constructor(t,e,i,n,o,l,g,u,w){this.fs=t,this.ss=e,this.vs=i,this.i18n=n,this.wts=o,this.bs=l,this.ms=g,this.cd=u,this.route=w,this.widget={},this.model={error:""},this.hasDatasourceChooser=!1,this.hasActions=!1,this.isHeader=!0,this.isHeader=this.route.snapshot.queryParamMap.get("noheader")!=="1"}ngOnInit(){this.widgetInputs={widget:this.widget,model:this.model,parent:this},this.updateComponent(),this.initFilters(),this.setupPivotVariables(),this.checkToolbarVisibility(),this.subscribeFilters(),this.subscribeActions()}ngAfterViewInit(){this.component=this.ngComponentOutlet?._componentRef?.instance,this.initDataSourceFromParams(),this.initDrillsForSharedWidget()}onHeaderButton(t){if(t.name==="displayAsPivot"){this.component?.displayAsPivot();return}this.component?.onHeaderButton(t),this.header?.cd.detectChanges()}setupPivotVariables(){this.widget.pvItems=[];let t=this.widget.type==="mdx2json.emptyportlet",e=[];this.vs.isExists()&&(e=this.vs.items.filter(i=>t?i.location==="dashboard":i.location!=="dashboard"&&(i.location==="*"||i.location===this.widget.name)),this.widget.pvItems=e,this.showToolbar())}showLoading(){this.widget.isLoading=!0}hideLoading(){this.widget.isLoading=!1}ngOnDestroy(){this.subCopyMdx?.unsubscribe(),this.subRefresh?.unsubscribe(),this.subFilter?.unsubscribe(),this.subUpdateFilterText?.unsubscribe(),this.subFilterAll?.unsubscribe(),this.subShare?.unsubscribe(),this.subChangeType?.unsubscribe()}clearError(){this.model.error=""}showError(t){this.model.error=t}updateFiltersText(){if(this.widget.type==="mdx2json.emptyportlet")for(let t=0;t<this.model.filters.length;t++){let e=this.getFilter(t);e&&!e.valueDisplay&&e.value&&(e.valueDisplay=e.value.toString().replace("&[","").replace("]",""))}for(let t=0;t<this.model.filters.length;t++){let e=this.getFilter(t);if(e){if(e.isDate){this.model.filters[t].text=e.valueDisplay;continue}if(e.isInterval){this.model.filters[t].text=e.values[e.fromIdx].name+":"+e.values[e.toIdx].name;continue}this.model.filters&&(this.model.filters[t].text=e?.valueDisplay||"")}}this.cd.detectChanges()}getFilter(t){return this.fs.getFilter(this.model.filters?.[t].idx)}copyMDX(){if(!this.component)return;let t=this.component.getMDX(),e={title:"",component:import("./chunk-OSUJKZGD.js"),inputs:{title:"Copy MDX",shareUrl:t,btnTitle:"Copy",hideOptions:!0},closeByEsc:!0,buttons:[],class:"modal-no-border",componentStyles:{padding:"0"},onComponentInit:i=>{i.onCopy=()=>{this.ms.close(e)}}};this.ms.show(e)}appendShareState(t,e){let i=this.widget[e];return i&&(t+="&"+e+"="+i),t}share(){let t=this.component?.chart,e=this.fs.getFiltersShareUrl(),i=e.split("#")[1],n=(this.widget.name||this.widget.idx).toString();if(i&&i.indexOf("?")===-1?e+="?widget="+n:e+="&widget="+n,e=this.appendShareState(e,"isLegend"),e=this.appendShareState(e,"isTop"),e=this.appendShareState(e,"showZero"),e=this.appendShareState(e,"showValues"),t&&t.series){let u=t.series.map((w,I)=>({v:w.visible,i:I})).filter(w=>!w.v);u.length&&(e+="&hiddenSeries="+u.map(w=>w.i).join(","))}let o=this.component?.getDrillsAsParameter();o&&(e+="&drilldown="+o);let l='<iframe style="border: none" src="'+e+'" ';l+="></iframe>";let g={title:"",component:import("./chunk-OSUJKZGD.js"),inputs:{title:"Share widget",shareUrl:l,btnTitle:"Copy",hideOptions:!0},closeByEsc:!0,buttons:[],class:"modal-no-border",componentStyles:{padding:"0"},onComponentInit:u=>{u.onCopy=()=>{this.ms.close(g)}}};this.ms.show(g)}requestData(){this.component?.requestData()}applyFilter(t){this.updateFiltersText(),this.requestData()}changeStyle(t,e,i){}showToolbar(){this.widget.toolbar=!0}hideToolbar(){this.widget.toolbar=!1}onHeaderButtonBack(){this.component?.doDrillUp()}onResetClickFilter(){this.component?.resetClickFilter()}onFilterVariable(t){this.component?.onVariableChange(t)}onFilterDatasource(t){this.component?.onDataSourceChange(t)}onFilterAction(t){this.component?.performAction(t)}onFilter(t){}updateComponent(){this.widgetType=this.wts.getDesc(this.widget.type),this.widgetType?.class?(this.widget.isSupported=!0,this.cd.detectChanges()):(this.widget.isSupported=!1,this.showError(this.i18n.get("errWidgetNotSupported")+": "+this.widget.type),this.cd.detectChanges())}initDrillsForSharedWidget(){let t=this.route.snapshot.queryParamMap.get("drilldown")||"";t&&this.component&&this.widget&&(this.component.drills=decodeURIComponent(t).split("~").map(e=>({path:e,name:e})),this.widget.backButton=!!this.component?.drills.length,this.widget.title=this.component.getDrillTitle(this.component.drills[this.component.drills.length-1]),this.header?.cd.detectChanges())}initDataSourceFromParams(){if(!this.widget.shared)return;let t=this.route.snapshot.queryParamMap.get("datasource");t&&this.component&&(this.component.customDataSource=t)}updateFilterText(t){this.updateFiltersText()}initFilters(){this.model.filters=this.fs.getWidgetModelFilters(this.widget.name),this.updateFiltersText()}checkToolbarVisibility(){this.model.filters.length===0&&!this.hasDatasourceChooser&&!this.hasActions&&!this.widget.pvItems.length&&this.hideToolbar()}subscribeFilters(){this.subFilter=this.bs.subscribe("filter"+this.widget.name,t=>this.applyFilter(t)),this.subUpdateFilterText=this.bs.subscribe("updateFilterText"+this.widget.name,t=>this.updateFilterText(t)),this.subFilterAll=this.bs.subscribe("filterAll",t=>this.applyFilter(t))}subscribeActions(){this.subRefresh=this.bs.subscribe("refresh:"+this.widget.name,()=>this.requestData()),this.subCopyMdx=this.bs.subscribe(`copyMDX:${this.widget.name}`,()=>this.copyMDX()),this.subShare=this.bs.subscribe(`share:${this.widget.name}`,()=>this.share())}static{this.\u0275fac=function(e){return new(e||r)(_(it),_(ct),_(Wt),_(kt),_(Be),_(pt),_(Ft),_(U),_(ht))}}static{this.\u0275cmp=L({type:r,selectors:[["dsw-widget"]],viewQuery:function(e,i){if(e&1&&(Q(jt,5),Q(Zi,7),Q(Ji,7)),e&2){let n;K(n=Z())&&(i.ngComponentOutlet=n.first),K(n=Z())&&(i.header=n.first),K(n=Z())&&(i.filters=n.first)}},inputs:{widget:"widget"},standalone:!0,features:[B],decls:7,vars:9,consts:[["header",""],["filters",""],[3,"onButtonClick","onBack","onResetClickFilter","typeDesc","widget","hidden"],[3,"onVariable","onDataSource","onAction","hidden","widget","filters"],[1,"error"],[1,"spinner"],[4,"ngComponentOutlet","ngComponentOutletInputs"],["ngSrc","assets/img/spinner.svg","height","100","width","100","priority",""]],template:function(e,i){if(e&1){let n=x();h(0,"dsw-widget-header",2,0),f("onButtonClick",function(l){return c(n),p(i.onHeaderButton(l))})("onBack",function(){return c(n),p(i.onHeaderButtonBack())})("onResetClickFilter",function(){return c(n),p(i.onResetClickFilter())}),m(),h(2,"dsw-widget-filter",3,1),f("onVariable",function(l){return c(n),p(i.onFilterVariable(l))})("onDataSource",function(l){return c(n),p(i.onFilterDatasource(l))})("onAction",function(l){return c(n),p(i.onFilterAction(l))}),m(),F(4,es,1,2,"ng-container")(5,is,2,1,"div",4)(6,ss,2,1,"div",5)}e&2&&($("typeDesc",i.widgetType)("widget",i.widget)("hidden",i.widget.tile||!i.isHeader),a(2),$("hidden",i.widget.tile||!i.isHeader)("widget",i.widget)("filters",i.model.filters),a(2),b(i.widgetType&&i.widgetType.class?4:-1),a(),b(i.model.error?5:-1),a(),b(i.component!=null&&i.component.isSpinner&&!i.model.error?6:-1))},dependencies:[ii,si,jt,ye],styles:["[_ngcontent-%COMP%]:root{--cl-bg: #F5F5F5;--cl-accent: #1A73E8;--cl-btn-hover: #76abf1;--cl-hover: #E8F0FE;--cl-txt: #555555;--input-border-radius: 13px;--cl-btn-main: #5cb85c;--cl-btn-main-txt: #fff;--cl-btn-main-border: #4cae4c;--cl-btn-main-hover: #6eca6e;--cl-btn-secondary: #e6e6e6;--cl-btn-secondary-txt: #cccccc;--cl-btn-secondary-border: #b4b2b2;--cl-btn-secondary-hover: #dbdbdb;--icon-filter: none;--cl1: #b6e6ff;--cl2: #f7bfb7;--cl3: #bceca8;--cl4: #fff9a8;--cl5: #ffc593;--cl6: #f9b1ab;--cl7: #9de7fb;--cl8: #a8b8f9;--cl9: #9df1ae;--cl-header-bg: #FFFFFF;--cl-header-border: #F5F5F5;--cl-header-txt: #606367;--cl-header-ico: var(--cl-header-txt);--cl-header-btn-active: var(--cl-header-bg);--cl-header-btn-hover: var(--cl-bg);--cl-header-btn-hover-darken: var(--cl-hover);--header-height: 64px;--menu-item-icon-filter: none;--cl-sidebar-bg: #F5F5F5;--cl-sidebar-txt: #606367;--tile-border: none;--tile-border-radius: 10px;--tile-header-height: 28px;--cl-modal-bg: white;--fc0: #606367;--fc1: black;--fc2: red;--fc3: white;--fc4: green;--fc5: blue;--cl-widget-bg: white;--cl-widget-header-btn-active: #A9FFA1;--cl-widget-header-border: none;--cl-text-widget-font: #6b6464;--cl-widget-header-bg: var(--cl-header-bg);--cl-widget-header-txt: var(--cl-header-txt);--cl-widget-filter-txt: #606367;--cl-widget-filter-bg: var(--cl-header-bg);--widget-header-btn-opacity: 1;--widget-header-btn-filter: none;--widget-header-btn-active-filter: contrast(.7) sepia(1) brightness(1) hue-rotate(-898deg) contrast(9);--cl-input-bg: white;--cl-input-border: #EBEBEA;--cl-check-border: #606367;--cl-input-placeholder: rgba(96, 99, 103, .6);--cl-input-text: #606367;--cl-input-height: 26px;--cl-pivot-cell-border: rgb(208, 208, 208);--cl-pivot-cell-hover: #FFF7D7;--pivot-row-hover: inset 0 0 30px #fff5b9;--sidebar-width: 322px;--cl-scrollbar: #606367}[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;min-height:0;overflow:hidden;background-color:var(--cl-widget-bg);padding:20px}.error[_ngcontent-%COMP%]{font-family:Oxygen;position:absolute;inset:0;color:#d7070294;background-color:transparent;text-align:center;background:var(--cl-widget-bg);display:flex;align-items:center;justify-content:center;padding:20px;z-index:10}.spinner[_ngcontent-%COMP%]{position:absolute;inset:44px 0 0;z-index:3;display:flex;justify-content:center;align-items:center;background-color:#ffffffe6;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);height:auto}dsw-widget-filter[_ngcontent-%COMP%]{z-index:4}"],data:{animation:[Ve("fade-in-out",[qt(":enter",[wt({opacity:0}),Ut("100ms",wt({opacity:1}))]),qt(":leave",[wt({opacity:1}),Ut("100ms",wt({opacity:0}))])])]},changeDetection:0})}}return r})();var ns=["ctxMenu"];function rs(r,s){if(r&1){let t=x();h(0,"gridster-item",18,3),f("transitionend",function(i){let n=c(t).$implicit,o=d(2);return p(o.onWidgetSizeChanged(n,i))})("contextmenu",function(i){let n=c(t).$implicit,o=d(2);return p(o.showContextMenu(n,i))}),y(2,"dsw-widget",19,4),m()}if(r&2){let t=s.$implicit,e=d(2);E("editing",t===e.editedWidget)("no-anim",e.isLoading||e.editedWidget)("expanded",t.isExpanded),$("id",t===e.editedWidget?"edited-widget":void 0)("item",t),a(2),$("widget",t)}}function os(r,s){if(r&1&&(h(0,"gridster",6,2),R(2,rs,4,9,"gridster-item",17,Ce().trackByName,!0),m()),r&2){let t=d();$("options",t.tilesOptions),a(2),V(t.list)}}function ls(r,s){if(r&1&&(h(0,"div",21),y(1,"dsw-widget",19,4),m()),r&2){let t=s.$implicit;a(),$("widget",t)}}function as(r,s){if(r&1&&(h(0,"div",23),y(1,"dsw-widget",19),m()),r&2){let t=d(2);ut("transform","translateX(calc(-100vw * "+-t.page+"))"),a(),$("widget",t.mobileFilter)}}function hs(r,s){if(r&1&&(h(0,"div",20),R(1,ls,3,1,"div",21,G),F(3,as,2,3,"div",22),m()),r&2){let t=d();ut("transform","translateX(calc(100vw * "+-t.page+"))"),a(),V(t.list),a(2),b(t.isMobileFilterVisible?3:-1)}}function ds(r,s){if(r&1&&y(0,"span"),r&2){let t=s.$index,e=d();E("active",t===e.page)}}function cs(r,s){r&1&&(h(0,"div",10),y(1,"img",24),m())}function ps(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.ctxDrill())}),C(1,"Drilldown"),m()}}function ms(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.ctxDrillthrough())}),C(1,"Drillthrough"),m()}}function gs(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.printItem())}),C(1),S(2,"i18n"),m()}r&2&&(a(),k(T(2,1,"print")))}function us(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.gotoKPIPage(i.ctxItem))}),C(1),S(2,"i18n"),m()}r&2&&(a(),k(T(2,1,"showKPI")))}function fs(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.gotoAnalyzer(i.ctxItem))}),C(1),S(2,"i18n"),m()}r&2&&(a(),k(T(2,1,"openAnalyzer")))}function ws(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.exportWidget("svg"))}),C(1),S(2,"i18n"),m()}r&2&&(a(),k(T(2,1,"svgImage")))}function Cs(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.exportWidget("png"))}),C(1),S(2,"i18n"),m()}r&2&&(a(),k(T(2,1,"pngImage")))}function bs(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.exportWidget("jpg"))}),C(1),S(2,"i18n"),m()}r&2&&(a(),k(T(2,1,"jpgImage")))}function xs(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.exportWidget("pdf"))}),C(1),S(2,"i18n"),m()}r&2&&(a(),k(T(2,1,"pdfDoc")))}function _s(r,s){if(r&1){let t=x();h(0,"div",14),f("mouseover",function(i){c(t);let n=at(4),o=d();return p(o.showSubmenu(n,i))}),C(1),S(2,"i18n"),h(3,"div",15,5)(5,"div",12),f("click",function(){c(t);let i=d();return p(i.setType("areaChart"))}),C(6,"Area chart"),m(),h(7,"div",12),f("click",function(){c(t);let i=d();return p(i.setType("barChart"))}),C(8,"Bar chart"),m(),h(9,"div",12),f("click",function(){c(t);let i=d();return p(i.setType("barChartStacked"))}),C(10,"Stacked bar chart"),m(),h(11,"div",12),f("click",function(){c(t);let i=d();return p(i.setType("columnChart"))}),C(12,"Column chart"),m(),h(13,"div",12),f("click",function(){c(t);let i=d();return p(i.setType("columnChartStacked"))}),C(14,"Stacked column chart"),m(),h(15,"div",12),f("click",function(){c(t);let i=d();return p(i.setType("lineChart"))}),C(16,"Line chart"),m(),h(17,"div",12),f("click",function(){c(t);let i=d();return p(i.setType("pieChart"))}),C(18,"Pie chart"),m()()()}r&2&&(a(),Tt(" ",T(2,1,"viewAs")," "))}function vs(r,s){if(r&1){let t=x();h(0,"div",12),f("click",function(){c(t);let i=d();return p(i.ctxEdit())}),C(1,"Edit widget"),m()}}var ys=200,Is=100,Ss=50,ri=12,Gn=(()=>{class r extends Ze{constructor(){super(),this.page=0,this.model={items:[]},this.contextMenuData={canDrill:!1,canDrillthrough:!1},this.tilesOptions={disablePushOnResize:!1,displayGrid:zt.None,disableScrollHorizontal:!0,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushItems:!0,useTransformPositioning:!0,margin:20,gridType:v.VerticalFixed,draggable:{ignoreContent:!0,dragHandleClass:"drag-handle",enabled:!0},resizable:{enabled:!0}},this.isMobile=!1,this.isLoading=!0,this.itemsInitialized=0,this.isMobileFilterVisible=!1,this.sharedWidget="",this.path="",this.sidebarAnimEnd$=this.sbs.onAnimEnd.pipe(st()),this.trackByName=(t,e)=>{let i=this.path+"-"+e.name.toString();return e===this.editedWidget&&this.editedWidget.edKey||i},this.subscribeForSidebarAnim(),this.checkRestrictions(),this.hs.resetSearch(),this.hs.hideMobileFilterButton(),this.sharedWidget=this.route.snapshot.queryParamMap.get("widget")??"",this.subscribeForGridsterEvents(),this.loadSettings(),this.subscribeForSettingsChanged(),this.subscribeForEditing(),this.setupSharedWidget(),this.isMobile=this.us.isMobile(),this.subReset=this.bs.subscribe("refresh-dashboard",()=>{this.requestData()}),this.subMobileFilterDialog=this.hs.mobileFilterDialogToggle.subscribe(()=>{this.isMobileFilterVisible=!this.isMobileFilterVisible,this.cd.detectChanges()}),this.subContextMenu=this.bs.subscribe("contextmenu",t=>{this.showContextMenu(t.widget,t.event,t.ctxData),this.cd.detectChanges()})}get canEdit(){return location.port==="4007"}ngOnInit(){this.subscribeForParamsChange()}ngAfterViewInit(){}ngOnDestroy(){super.ngOnDestroy(),clearTimeout(this.onLoadingTimeout),window.onafterprint=null,this.subParamsChange?.unsubscribe(),this.subContextMenu.unsubscribe(),this.subMobileFilterDialog.unsubscribe(),this.subCtxClose&&this.subCtxClose.unsubscribe(),this.subReset&&this.subReset.unsubscribe()}setType(t){this.ctxItem&&(this.bs.broadcast("setWidgetType:"+this.ctxItem.name,t),this.hideContextMenu())}hideContextMenu(){this.ctxItem=void 0,this.r2.setStyle(this.ctxMenu.nativeElement,"visibility","hidden")}shareItem(){this.ctxItem&&(this.bs.broadcast("share:"+this.ctxItem.name),this.hideContextMenu())}copyMDX(){this.ctxItem&&(this.bs.broadcast("copyMDX:"+this.ctxItem.name),this.hideContextMenu())}printItem(){this.ctxItem&&(this.bs.broadcast("print:"+this.ctxItem.name),this.hideContextMenu())}refreshItem(){this.ctxItem&&(this.bs.broadcast("refresh:"+this.ctxItem.name),this.hideContextMenu())}prepareData(t){let e;if(this.itemsInitialized=0,!t)return;if(t.Error){this.es.show(t.Error);return}if(!t.widgets){this.es.show(this.i18n.get("errNoWidgets"));return}if(t.displayInfo&&t.displayInfo.gridRows&&!this.settings.widgetHeight&&!this.sharedWidget){let o=t.displayInfo.gridRows,l=20,g=window.innerHeight;g<800&&(g=800),this.tilesOptions.fixedRowHeight=Math.floor((g-(63+l*(o+1)))/o)-1,this.gridster&&this.gridster.optionsChanged()}this.vs.init(t),t.filters&&this.fs.init(t.filters,this.path);let i=!1;if((this.fs.isFiltersOnToolbarExists||this.vs.isExists())&&!this.sharedWidget){for(e=0;e<t.widgets.length;e++)t.widgets[e].type.toLowerCase()===J.const.emptyWidgetClass&&(i=!0);i||(t.widgets.push({dashboard:this.path,autocreated:!0,name:"emptyWidget",type:J.const.emptyWidgetClass,key:"emptyWidgetFor"+this.path}),i=!0)}for(J.mobile,t.info,this.list=[],this.dbs.setWidgets(this.list),this.dbs.setAllWidgets(t.widgets),e=0;e<t.widgets.length;e++){if(t.widgets[e].dashboard=this.path,this.sharedWidget){let o=parseInt(this.sharedWidget,10);if(!isNaN(o)&&o!==e||t.widgets[e].name!==this.sharedWidget)continue}let n={idx:e,cols:2,rows:t.widgets[e].type?.toLowerCase()===J.const.emptyWidgetClass?void 0:2,x:e*2%(this.tilesOptions.maxCols||1),y:Math.floor(e/6)*2,title:t.widgets[e].title,toolbar:!0,backButton:!1,menuDisabled:!1};if(t.widgets[e].displayInfo){let o=1,l=1;t.displayInfo&&(o=Math.floor(12/t.displayInfo.gridCols),o<1&&(o=1),l<1&&(l=1)),n.x=t.widgets[e].displayInfo.topCol*o,n.y=t.widgets[e].displayInfo.leftRow*l,n.cols=(t.widgets[e].displayInfo.colWidth||1)*o,n.rows=t.widgets[e].displayInfo.rowHeight||2,this.tilesOptions.maxCols!==void 0&&n.cols>this.tilesOptions.maxCols&&(n.cols=this.tilesOptions.maxCols)}if(t.widgets[e].autocreated&&(delete n.x,delete n.y),t.widgets[e].name&&this.setWidgetSizeAndPos(n,t.widgets[e].name.toString()),this.sharedWidget&&(n.x=0,n.y=0,n.idx=0,n.cols=1,n.rows=1,n.menuDisabled=!0,n.shared=!0),n=et(et({},JSON.parse(JSON.stringify(t.widgets[e]))),JSON.parse(JSON.stringify(n))),this.sharedWidget||this.fillDependentWidgets(n,t.widgets),this.isMobile&&n.type===J.const.emptyWidgetClass){this.mobileFilter=n,this.hs.showMobileFilterButton();continue}this.list.push(n)}this.sharedWidget||setTimeout(()=>this.broadcastDependents(),0),this.fitEmptyWidget(),this.dbs.setWidgets(this.list),this.ms.onSetTitle.emit(this.dbs.getWidgets()[this.page]?.title),setTimeout(()=>{})}broadcastDependents(){let t=[];for(let e=0;e<this.list.length;e++)if(this.list[e].dependents.length!==0){let i=this.list[e];if(t.indexOf(i.name)!==-1)continue;t.push(i.name),this.bs.broadcast("widget:"+i.name+":refreshDependents")}}fillDependentWidgets(t,e){t.dependents=[];for(let i=0;i<e.length;i++)if(e[i]!==t){if(!e[i].dataLink)continue;e[i].dataLink===t.name&&t.dependents.push(e[i].name)}}setWidgetSizeAndPos(t,e){let n=this.ss.getWidgetsSettings(this.path)[e];n&&(n.sizeX!==void 0&&(t.cols=n.sizeX),n.sizeY!==void 0&&(t.rows=n.sizeY),n.col!==void 0&&(t.x=n.col),n.row!==void 0&&(t.y=n.row))}getDesc(t){if(this.list[t])return this.list[t]}onWidgetSizeChanged(t,e){if(e&&e.propertyName!=="width"&&e.propertyName!=="height")return;let i=this.getWidgetByInfo(t);i&&i.component&&i.component.onResize()}showContextMenu(t,e,i){if(t===this.editedWidget)return;this.contextMenuData=i;let n=this.ctxMenu.nativeElement;this.r2.setStyle(n,"visibility","hidden");let o=!1,l=t.dataProperties?.find(w=>w.name==="disableContextMenu");if(l&&(o=l.dataValue===1),t.type===J.const.emptyWidgetClass||o||this.us.isPreventContextMenu())return;e.preventDefault(),this.ctxItem=t;let g=e.clientY,u=e.clientX;setTimeout(()=>{g+n.offsetHeight>window.innerHeight&&(g-=n.offsetHeight),u+n.offsetWidth>window.innerWidth&&(u-=n.offsetWidth),this.r2.setStyle(n,"left",u+"px"),this.r2.setStyle(n,"top",g+"px"),this.subCtxClose&&this.subCtxClose.unsubscribe(),this.subCtxClose=le(document,"mousedown").subscribe(w=>{this.subCtxClose?.unsubscribe(),!w.target.parentElement?.classList.contains("ctx-menu")&&(this.hideContextMenu(),this.cd.detectChanges())}),this.r2.setStyle(n,"visibility","visible")})}exportWidget(t){let e=this.getWidgetByInfo(this.ctxItem)?.component,i={sourceWidth:Math.floor(window.screen.width/2),sourceHeight:Math.floor(window.screen.height/2),filename:this.ctxItem?.tile||"chart",type:"image/svg+xml"};switch(t){case"png":i.type="image/png";break;case"svg":i.type="image/svg+xml";break;case"jpg":i.type="image/jpeg";break;case"pdf":i.type="application/pdf";break;case"xls":{let n=e?.getMDX();if(!n){console.warn(`Can't get MDX for widget: ${this.ctxItem}`);return}if(e?.lpt){let g=e.lpt;n=g._dataSourcesStack[g._dataSourcesStack.length-1].BASIC_MDX+g.dataSource.FILTERS}let l=(this.ss.serverSettings.DefaultApp||"/csp/"+ft)+"/_DeepSee.UI.MDXExcel.zen?MDX="+encodeURIComponent(n||"");window.open(l,"_blank"),this.hideContextMenu();return}case"csv":{this.exportToCsv(),this.hideContextMenu();return}}this.ctxItem?.isChart&&e?.chart?.exportChart(i,{}),this.hideContextMenu()}showSubmenu(t,e){e.target.classList.contains("ctx-sub")&&(this.r2.removeStyle(t,"transform"),this.r2.setStyle(t,"visibility","hidden"),setTimeout(()=>{let i=t.getBoundingClientRect(),n=0,o=0;i.top+i.height>window.innerHeight&&(o=i.top+i.height-window.innerHeight+10),i.left+i.width>window.innerWidth&&(n=i.width+(t.parentElement?.getBoundingClientRect()?.width||0)+2),this.r2.setStyle(t,"transform",`translateX(${-n}px) translateY(${-o}px)`),this.r2.setStyle(t,"visibility","visible")}))}onTouchStart(t){this.touchInfo={startTime:performance.now(),endTime:0,sx:t.changedTouches[0].screenX,sy:t.changedTouches[0].screenY,ex:0,ey:0}}onTouchEnd(t){if(this.isMobileFilterVisible)return;let e=this.touchInfo;if(!e||(e.endTime=performance.now(),e.ex=t.changedTouches[0].screenX,e.ey=t.changedTouches[0].screenY,e.endTime-e.startTime>ys)||Math.abs(e.ey-e.sy)>Is||Math.abs(e.ex-e.sx)<Ss)return;let i=e.ex>e.sx?-1:1;this.page+=i;let n=this.dbs.getWidgets().length;this.page<0&&(this.page=0),this.page>n-1&&(this.page=n-1),this.ms.onSetTitle.emit(this.dbs.getWidgets()[this.page].title);let o=this.widgets.toArray()[this.page].component;if(o instanceof Oe){o.adjustSize();return}if(o instanceof Le&&o.chartConfig.chart?.type!=="treemap"){o.updateChart(!0,!1);return}}ctxDrill(){this.contextMenuData&&(this.bs.broadcast("drilldown:"+(this.ctxItem?.name||""),{path:this.contextMenuData.drillPath,title:this.contextMenuData.drillTitle}),this.hideContextMenu())}ctxDrillthrough(){this.contextMenuData&&(this.bs.broadcast("drillthrough:"+(this.ctxItem?.name||""),{path:this.contextMenuData.drillPath,title:this.contextMenuData.drillTitle}),this.hideContextMenu())}gotoKPIPage(t){if(!t?.kpiclass)return;let i=(this.ss.serverSettings.DefaultApp||"/csp/"+ft)+"/"+t.kpiclass+".cls";window.open(i,"_blank")}gotoAnalyzer(t){if(!t?.dataSource)return;let e=this.ss.serverSettings.DefaultApp||"/csp/"+ft,i=this.fs.getFiltersUrlString(t.name,!1,"	",`
`),n=e+"/_DeepSee.UI.Dialog.Analyzer.zen?&PIVOT="+encodeURIComponent(t.dataSource);i&&(n+="&FILTERSTATE="+i),window.open(n,"_blank")}ctxEdit(){this.ctxItem?.isExpanded&&this.getWidgetByInfo(this.ctxItem)?.header?.onClick("expand"),this.sbs.showComponent({component:import("./chunk-3S2XLZ4S.js"),single:!0,inputs:{widget:this.ctxItem}}),this.hideContextMenu()}exportToCsv(){let t=this.getWidgetByInfo(this.ctxItem)?.component,e=t?._currentData;if(!t||!t.lpt||!e)return;let i,n,o;t.lpt?(n=t.lpt.dataController.getData().dimensions[0],i=t.lpt.dataController.getData().dimensions[1],o=t.lpt.dataController.getData().dataArray):(i=e.Cols[1].tuples,n=e.Cols[0].tuples,o=e.Data);let l=`\r
`,g="|",u='"sep='+g+'"'+l,w,I;for(i[0]&&i[0].dimension&&(u+=i[0].dimension+g),I=0;I<n.length;I++)u+=n[I].caption,I!==n.length-1&&(u+=g);for(u+=l,w=0;w<(i.length||o.length/n.length);w++){for(i[w]&&i[w].caption&&(u+=i[w].caption+g),I=0;I<n.length;I++)u+=o[w*n.length+I]||"0",I!==n.length-1&&(u+=g);u+=l}let z=(this.ctxItem?.title||"data")+".csv",A=new Blob([u],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(A,z);else{let P=document.createElement("a");if(P.download!==void 0){let N=URL.createObjectURL(A);P.setAttribute("href",N),P.setAttribute("download",z),P.style.visibility="hidden",document.body.appendChild(P),setTimeout(()=>{P.click(),document.body.removeChild(P)},10)}}}fitEmptyWidget(){let t,e=0,i=0;this.list.forEach(n=>{if(n.name==="emptyWidget"){t=n;return}let o=(n.x||0)+(n.cols||0),l=(n.y||0)+(n.rows||0);o>e&&(e=o),l>i&&(i=l)}),!(!t||t.rows)&&(t.rows=i||2)}requestData(){this.list=[],this.path.indexOf(".dashboard")!==-1&&(this.isLoading=!0,this.cd.detectChanges(),this.ds.getWidgets(this.path||"").then(t=>{this.dbs.dashboard.next(t),this.prepareData(t)}).finally(()=>{this.onDataLoaded()}))}subscribeForParamsChange(){this.subParamsChange=oe([this.route.url,this.route.params]).subscribe(([t,e])=>{this.switchNamespaceAndPath(t,e),this.requestData()})}switchNamespaceAndPath(t,e){e.ns&&e.ns.toLowerCase()!==ft.toLowerCase()&&this.ns.setCurrent(e.ns),this.path=[e.name,...t.map(i=>i.path)].join("/").slice(1),this.dbs.current.next(this.path)}onDataLoaded(){this.cd.detectChanges(),this.gridster.onResize(),clearTimeout(this.onLoadingTimeout),this.onLoadingTimeout=setTimeout(()=>{this.isLoading=!1,this.cd.detectChanges()},1)}subscribeForSettingsChanged(){this.subSettingsChanged=this.ss.onSettingsChanged.subscribe(t=>{this.tilesOptions.maxCols=t.colCount||ri,this.tilesOptions.minCols=this.tilesOptions.maxCols,this.tilesOptions.pushItems=!t.isTilePushDisabled,this.tilesOptions.disablePushOnResize=!!t.isTilePushDisabled,this.gridster&&(this.gridster.optionsChanged(),setTimeout(()=>{this.gridster.onResize()},1e3))})}subscribeForGridsterEvents(){this.tilesOptions.itemResizeCallback=t=>{this.onWidgetSizeChanged(t)},this.tilesOptions.draggable&&(this.tilesOptions.draggable.start=()=>{this.cd.detach()},this.tilesOptions.draggable.stop=()=>{this.cd.reattach()}),this.tilesOptions.itemChangeCallback=(t,e)=>{this.isLoading||this.dbs.saveWidgetPositionAndSize(t)}}loadSettings(){this.settings=this.ss.getAppSettings(),this.tilesOptions.pushItems=!this.settings.isTilePushDisabled,this.tilesOptions.disablePushOnResize=!!this.settings.isTilePushDisabled,this.tilesOptions.maxCols=parseInt(this.settings.colCount,10)||ri,this.tilesOptions.minCols=this.tilesOptions.maxCols,this.tilesOptions.fixedRowHeight=parseInt(this.settings.widgetHeight,10)||Math.floor((window.innerHeight-158)/10)-1}setupSharedWidget(){if(!this.sharedWidget)return;this.tilesOptions.maxCols=1,this.tilesOptions.minCols=1,this.tilesOptions.maxRows=1,this.tilesOptions.minRows=1,this.tilesOptions.gridType="fit";let e=this.route.snapshot.queryParamMap.get("height");e&&(this.tilesOptions.rowHeight=parseInt(e,10)),this.tilesOptions.draggable={enabled:!1,dragHandleClass:""},this.tilesOptions.resizable={enabled:!1}}checkRestrictions(){this.route.snapshot.queryParamMap.get("nodrag")==="1"&&this.tilesOptions?.draggable&&(this.tilesOptions.draggable.enabled=!1),this.route.snapshot.queryParamMap.get("noresize")==="1"&&this.tilesOptions?.resizable&&(this.tilesOptions.resizable.enabled=!1)}subscribeForSidebarAnim(){this.sidebarAnimEnd$.subscribe(()=>{this.gridster.onResize()})}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=L({type:r,selectors:[["dsw-dashboard-screen"]],viewQuery:function(e,i){if(e&1&&Q(ns,5),e&2){let n;K(n=Z())&&(i.ctxMenu=n.first)}},hostBindings:function(e,i){e&1&&f("touchstart",function(o){return i.onTouchStart(o)})("touchend",function(o){return i.onTouchEnd(o)})},standalone:!0,features:[we,B],decls:40,vars:30,consts:[["ctxMenu",""],["sub1",""],["gridster",""],["list",""],["widgets",""],["sub2",""],[3,"options"],[1,"mobile-widgets",3,"transform"],[1,"pager",3,"hidden"],[3,"active"],[1,"dsw-spinner"],[1,"ctx-menu",2,"visibility","hidden"],[3,"click"],[1,"divider"],[1,"ctx-sub",3,"mouseover"],[1,"ctx-menu"],[1,"ctx-sub"],[1,"tile",3,"id","editing","no-anim","expanded","item"],[1,"tile",3,"transitionend","contextmenu","id","item"],[3,"widget"],[1,"mobile-widgets"],[1,"tile"],[1,"tile","mobile-filter",3,"transform"],[1,"tile","mobile-filter"],["src","assets/img/spinner.svg"]],template:function(e,i){if(e&1){let n=x();F(0,os,4,1,"gridster",6)(1,hs,4,3,"div",7),h(2,"div",8)(3,"div"),R(4,ds,1,2,"span",9,G),m()(),F(6,cs,2,0,"div",10),h(7,"div",11,0),F(9,ps,2,0,"div")(10,ms,2,0,"div"),h(11,"div",12),f("click",function(){return c(n),p(i.refreshItem())}),C(12),S(13,"i18n"),m(),F(14,gs,3,3,"div"),h(15,"div",12),f("click",function(){return c(n),p(i.shareItem())}),C(16),S(17,"i18n"),m(),h(18,"div",12),f("click",function(){return c(n),p(i.copyMDX())}),C(19),S(20,"i18n"),m(),F(21,us,3,3,"div")(22,fs,3,3,"div"),y(23,"div",13),h(24,"div",14),f("mouseover",function(l){c(n);let g=at(27);return p(i.showSubmenu(g,l))}),C(25," Export "),h(26,"div",15,1),F(28,ws,3,3,"div")(29,Cs,3,3,"div")(30,bs,3,3,"div")(31,xs,3,3,"div"),h(32,"div",12),f("click",function(){return c(n),p(i.exportWidget("xls"))}),C(33),S(34,"i18n"),m(),h(35,"div",12),f("click",function(){return c(n),p(i.exportWidget("csv"))}),C(36),S(37,"i18n"),m()()(),F(38,_s,19,3,"div",16)(39,vs,2,0,"div"),m()}e&2&&(b(i.isMobile?-1:0),a(),b(i.isMobile?1:-1),a(),$("hidden",i.isMobileFilterVisible||i.us.isEmbedded()),a(2),V(i.dbs.getWidgets()),a(2),b(i.isLoading?6:-1),a(3),b(i.contextMenuData!=null&&i.contextMenuData.canDrill?9:-1),a(),b(i.contextMenuData!=null&&i.contextMenuData.canDrillthrough?10:-1),a(2),k(T(13,20,"refresh")),a(2),b(i.ctxItem!=null&&i.ctxItem.isChart?14:-1),a(2),k(T(17,22,"share")),a(3),k(T(20,24,"copyMDX")),a(2),b(i.ctxItem!=null&&i.ctxItem.kpitype?21:-1),a(),b(i.ctxItem!=null&&i.ctxItem.dataSource?22:-1),a(6),b(i.ctxItem!=null&&i.ctxItem.isChart?28:-1),a(),b(i.ctxItem!=null&&i.ctxItem.isChart?29:-1),a(),b(i.ctxItem!=null&&i.ctxItem.isChart?30:-1),a(),b(i.ctxItem!=null&&i.ctxItem.isChart?31:-1),a(2),k(T(34,26,"xlsDoc")),a(3),k(T(37,28,"csvDoc")),a(2),b(i.ctxItem!=null&&i.ctxItem.isChart?38:-1),a(),b(i.ctxItem&&i.canEdit?39:-1))},dependencies:[se,Ke,ni,$t],styles:['[_ngcontent-%COMP%]:root{--cl-bg: #F5F5F5;--cl-accent: #1A73E8;--cl-btn-hover: #76abf1;--cl-hover: #E8F0FE;--cl-txt: #555555;--input-border-radius: 13px;--cl-btn-main: #5cb85c;--cl-btn-main-txt: #fff;--cl-btn-main-border: #4cae4c;--cl-btn-main-hover: #6eca6e;--cl-btn-secondary: #e6e6e6;--cl-btn-secondary-txt: #cccccc;--cl-btn-secondary-border: #b4b2b2;--cl-btn-secondary-hover: #dbdbdb;--icon-filter: none;--cl1: #b6e6ff;--cl2: #f7bfb7;--cl3: #bceca8;--cl4: #fff9a8;--cl5: #ffc593;--cl6: #f9b1ab;--cl7: #9de7fb;--cl8: #a8b8f9;--cl9: #9df1ae;--cl-header-bg: #FFFFFF;--cl-header-border: #F5F5F5;--cl-header-txt: #606367;--cl-header-ico: var(--cl-header-txt);--cl-header-btn-active: var(--cl-header-bg);--cl-header-btn-hover: var(--cl-bg);--cl-header-btn-hover-darken: var(--cl-hover);--header-height: 64px;--menu-item-icon-filter: none;--cl-sidebar-bg: #F5F5F5;--cl-sidebar-txt: #606367;--tile-border: none;--tile-border-radius: 10px;--tile-header-height: 28px;--cl-modal-bg: white;--fc0: #606367;--fc1: black;--fc2: red;--fc3: white;--fc4: green;--fc5: blue;--cl-widget-bg: white;--cl-widget-header-btn-active: #A9FFA1;--cl-widget-header-border: none;--cl-text-widget-font: #6b6464;--cl-widget-header-bg: var(--cl-header-bg);--cl-widget-header-txt: var(--cl-header-txt);--cl-widget-filter-txt: #606367;--cl-widget-filter-bg: var(--cl-header-bg);--widget-header-btn-opacity: 1;--widget-header-btn-filter: none;--widget-header-btn-active-filter: contrast(.7) sepia(1) brightness(1) hue-rotate(-898deg) contrast(9);--cl-input-bg: white;--cl-input-border: #EBEBEA;--cl-check-border: #606367;--cl-input-placeholder: rgba(96, 99, 103, .6);--cl-input-text: #606367;--cl-input-height: 26px;--cl-pivot-cell-border: rgb(208, 208, 208);--cl-pivot-cell-hover: #FFF7D7;--pivot-row-hover: inset 0 0 30px #fff5b9;--sidebar-width: 322px;--cl-scrollbar: #606367}[_nghost-%COMP%]{display:block;width:100%;height:100%;padding-bottom:20px}gridster[_ngcontent-%COMP%]{background:var(--cl-bg)}.mobile-widgets[_ngcontent-%COMP%]{display:flex;width:fit-content;transition:transform .2s linear;white-space:nowrap;height:100%}.tile[_ngcontent-%COMP%]{content-visibility:auto;overflow:visible;display:flex!important;flex-direction:column;position:absolute;border-radius:var(--tile-border-radius);border:1px solid var(--cl-header-border);user-select:none;-webkit-user-select:none}.tile.expanded[_ngcontent-%COMP%]{position:fixed;z-index:3!important;left:15px!important;top:calc(var(--header-height) + 15px)!important;right:15px!important;bottom:15px!important;width:auto!important;height:auto!important;transform:none!important;transition:none!important;margin:0!important;box-shadow:0 0 10px #0000001a;border:1px solid darkgray}.tile.expanded[_ngcontent-%COMP%]  .gridster-item-resizable-handler.handle-se{display:none!important;pointer-events:none!important}@media (max-width: 576px){.tile[_ngcontent-%COMP%]{position:static;margin-bottom:0!important;width:100vw;display:inline-flex!important;border:none}}.ctx-menu[_ngcontent-%COMP%]{font-family:Oxygen;position:absolute;top:0;left:0;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;border:1px solid var(--cl-header-border);border-radius:4px;z-index:4;background-color:#fff;white-space:nowrap;box-shadow:0 0 5px #0000001f;min-width:140px}.ctx-menu[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;padding:10px 20px;cursor:pointer;-webkit-user-select:none;user-select:none}.ctx-menu[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:hover{background-color:#0000000d}.ctx-menu[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:0;margin:0;padding:0;border-bottom:1px solid var(--cl-header-border)}.ctx-sub[_ngcontent-%COMP%]{position:relative}.ctx-sub[_ngcontent-%COMP%]:after{content:"";background-image:url(./assets/img/icons/next.svg);position:absolute;right:6px;display:block;z-index:1;top:14px;width:12px;height:12px;opacity:.4;transform:scaleX(.6)}.ctx-sub[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:none;position:absolute;left:calc(100% + 1px);top:0}.ctx-sub[_ngcontent-%COMP%]:hover > div[_ngcontent-%COMP%]{display:block}.pager[_ngcontent-%COMP%]{display:none;position:absolute;left:0;width:100vw;bottom:calc(var(--header-height) - 10px);z-index:1;align-items:center;justify-content:center}.pager[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:2px;background-color:var(--cl-widget-bg);border-radius:20px;border:1px solid var(--cl-header-border);height:20px}.pager[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{width:9px;height:9px;border-radius:20px;background-color:var(--cl-header-bg);border:1px solid var(--cl-header-border);margin-left:4px;margin-right:4px}.pager[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > span.active[_ngcontent-%COMP%]{width:14px;height:14px;position:relative}@media (max-width: 576px){.pager[_ngcontent-%COMP%]{display:flex}}.mobile-filter[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;z-index:10}.editing[_ngcontent-%COMP%]{border:2px solid var(--cl-accent)}gridster-item[_ngcontent-%COMP%]:not([style]){display:none}.dsw-spinner[_ngcontent-%COMP%]{top:var(--header-height)}'],changeDetection:0})}}return r})();export{zt as a,Ci as b,se as c,Ke as d,Os as e,Wt as f,ni as g,ri as h,Gn as i};
